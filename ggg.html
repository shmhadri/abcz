<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ŸÖŸÜÿµÿ© ÿ£ŸÑÿπÿßÿ® ÿßŸÑÿ≠ÿ±ŸàŸÅ ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿäÿ© - Phonics Game Lab</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --primary-dark: #3a0ca3;
            --secondary: #f72585;
            --accent: #4cc9f0;
            --success: #4ade80;
            --warning: #f59e0b;
            --error: #ef4444;
            --background: #ffffff;
            --surface: #ffffff;
            --surface-light: #f8fafc;
            --text: #1e293b;
            --text-secondary: #475569;
            --border: #e2e8f0;
            --radius-lg: 20px;
            --radius-md: 12px;
            --radius-sm: 8px;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.05);
            --gradient-primary: linear-gradient(135deg, var(--primary), var(--primary-light));
            --gradient-accent: linear-gradient(135deg, var(--accent), var(--primary-light));
            --gradient-success: linear-gradient(135deg, var(--success), #22c55e);
            --gradient-surface: linear-gradient(135deg, #ffffff, #f8fafc);
            
            --night-bg: #0f172a;
            --night-surface: #1e293b;
            --night-text: #f1f5f9;
            --night-text-secondary: #cbd5e1;
            --night-border: #475569;
            --night-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .night-mode {
            --background: var(--night-bg);
            --surface: var(--night-surface);
            --surface-light: #334155;
            --text: var(--night-text);
            --text-secondary: var(--night-text-secondary);
            --border: var(--night-border);
            --shadow: var(--night-shadow);
            --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.2);
            --gradient-surface: linear-gradient(135deg, var(--surface), #1e293b);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            touch-action: manipulation;
        }

        body {
            min-height: 100vh;
            background: var(--background);
            font-family: 'Segoe UI', 'Tajawal', Tahoma, Geneva, Verdana, sans-serif;
            color: var(--text);
            line-height: 1.6;
            padding: 20px 15px;
            background-image: 
                radial-gradient(circle at 15% 50%, rgba(67, 97, 238, 0.08) 0%, transparent 40%),
                radial-gradient(circle at 85% 30%, rgba(244, 114, 182, 0.05) 0%, transparent 40%);
            transition: all 0.3s ease;
            font-weight: 600;
            -webkit-tap-highlight-color: transparent;
        }

        .night-mode body {
            background-image: 
                radial-gradient(circle at 15% 50%, rgba(67, 97, 238, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 85% 30%, rgba(244, 114, 182, 0.1) 0%, transparent 40%);
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--surface);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            position: relative;
            transition: all 0.3s ease;
        }

        .app-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
            z-index: 10;
        }

        /* Header Styles */
        .app-header {
            padding: 20px 25px;
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
            position: relative;
            backdrop-filter: blur(10px);
        }

        .night-mode .app-header {
            background: rgba(30, 41, 59, 0.95);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            box-shadow: var(--shadow);
        }

        .logo-text h1 {
            font-size: 22px;
            margin-bottom: 5px;
            background: linear-gradient(90deg, var(--primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        .logo-text p {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .student-info {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .student-name {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(248, 250, 252, 0.9);
            padding: 8px 15px;
            border-radius: 50px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .night-mode .student-name {
            background: rgba(30, 41, 59, 0.9);
        }

        .student-name input {
            background: transparent;
            border: none;
            color: var(--text);
            font-size: 14px;
            width: 150px;
            outline: none;
            font-weight: 600;
        }

        .progress-chip {
            background: rgba(248, 250, 252, 0.9);
            padding: 8px 15px;
            border-radius: 50px;
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .night-mode .progress-chip {
            background: rgba(30, 41, 59, 0.9);
        }

        .progress-chip .progress-value {
            color: var(--primary);
            font-weight: 700;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            left: 25px;
            background: rgba(248, 250, 252, 0.9);
            border: 1px solid var(--border);
            border-radius: 50px;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text);
            font-weight: 600;
        }

        .night-mode .theme-toggle {
            background: rgba(30, 41, 59, 0.9);
        }

        .theme-toggle:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        /* Mobile Menu */
        .mobile-menu {
            display: none;
            position: relative;
        }

        .hamburger {
            font-size: 24px;
            cursor: pointer;
            padding: 10px;
            color: var(--text);
        }

        .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: rgba(255, 255, 255, 0.98);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow);
            z-index: 100;
            min-width: 200px;
            backdrop-filter: blur(10px);
        }

        .night-mode .dropdown-content {
            background: rgba(30, 41, 59, 0.98);
        }

        .dropdown-content.show {
            display: block;
        }

        .dropdown-content a {
            display: block;
            padding: 12px 16px;
            text-decoration: none;
            color: var(--text);
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        .dropdown-content a:hover {
            background: var(--primary);
            color: white;
        }

        /* Letters Navigation */
        .letters-nav {
            padding: 15px 20px;
            background: rgba(248, 250, 252, 0.9);
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
            display: flex;
            gap: 10px;
            transition: all 0.3s ease;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-light) transparent;
        }

        .letters-nav::-webkit-scrollbar {
            height: 6px;
        }

        .letters-nav::-webkit-scrollbar-track {
            background: transparent;
        }

        .letters-nav::-webkit-scrollbar-thumb {
            background-color: var(--primary-light);
            border-radius: 3px;
        }

        .night-mode .letters-nav {
            background: rgba(30, 41, 59, 0.9);
        }

        .letter-tab {
            min-width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            font-weight: 700;
            flex-shrink: 0;
        }

        .night-mode .letter-tab {
            background: rgba(30, 41, 59, 0.9);
        }

        .letter-tab.active {
            background: var(--gradient-primary);
            border-color: var(--primary-light);
            color: white;
            transform: scale(1.1);
            box-shadow: var(--shadow-light);
        }

        .letter-tab.completed::after {
            content: '‚úì';
            position: absolute;
            top: -5px;
            left: -5px;
            background: var(--success);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
        }

        .letter-tab.locked {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(248, 250, 252, 0.9);
        }

        .night-mode .letter-tab.locked {
            background: rgba(30, 41, 59, 0.9);
        }

        .letter-tab.locked::before {
            content: 'üîí';
            position: absolute;
            font-size: 12px;
            top: -5px;
            right: -5px;
        }

        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 25px;
        }

        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: var(--radius-lg);
            padding: 20px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .night-mode .panel {
            background: rgba(30, 41, 59, 0.95);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .panel-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
        }

        .panel-badge {
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary);
            padding: 5px 12px;
            border-radius: 50px;
            font-size: 12px;
            border: 1px solid rgba(67, 97, 238, 0.2);
            font-weight: 600;
        }

        .night-mode .panel-badge {
            background: rgba(67, 97, 238, 0.2);
        }

        /* Letter Display */
        .letter-display {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
        }

        .letter-visual {
            width: 100px;
            height: 100px;
            border-radius: var(--radius-lg);
            background: var(--gradient-primary);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .letter-visual::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            animation: shimmer 3s infinite linear;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .letter-uppercase {
            font-size: 42px;
            line-height: 1;
        }

        .letter-lowercase {
            font-size: 32px;
            line-height: 1;
            opacity: 0.9;
        }

        .letter-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .btn {
            padding: 10px 18px;
            border-radius: 50px;
            border: none;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            font-size: 14px;
            user-select: none;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-light);
        }

        .btn-secondary {
            background: rgba(15, 23, 42, 0.05);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .night-mode .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .btn:active {
            transform: translateY(0);
        }

        /* Words Grid */
        .words-section {
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 700;
        }

        .words-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
        }

        .word-card {
            background: rgba(248, 250, 252, 0.9);
            border-radius: var(--radius-md);
            padding: 15px;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            position: relative;
        }

        .night-mode .word-card {
            background: rgba(30, 41, 59, 0.9);
        }

        .word-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-light);
            border-color: var(--primary-light);
        }

        .word-emoji {
            font-size: 32px;
        }

        .word-text {
            font-size: 16px;
            font-weight: 700;
            direction: ltr;
            text-align: center;
            color: var(--text);
        }

        .word-ar {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .word-actions {
            display: flex;
            gap: 8px;
            margin-top: 5px;
        }

        .icon-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(15, 23, 42, 0.05);
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text);
            user-select: none;
        }

        .night-mode .icon-btn {
            background: rgba(255, 255, 255, 0.1);
        }

        .icon-btn:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
        }

        .icon-btn.mic-active {
            background: var(--secondary);
            color: white;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(247, 37, 133, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(247, 37, 133, 0); }
            100% { box-shadow: 0 0 0 0 rgba(247, 37, 133, 0); }
        }

        /* Writing Section */
        .writing-section {
            margin-bottom: 25px;
        }

        .writing-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .writing-label {
            min-width: 120px;
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .writing-boxes {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .writing-box {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: rgba(248, 250, 252, 0.9);
            color: var(--text);
            text-align: center;
            font-size: 18px;
            font-weight: 700;
            direction: ltr;
            transition: all 0.3s ease;
        }

        .night-mode .writing-box {
            background: rgba(30, 41, 59, 0.9);
        }

        .writing-box:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 2px rgba(67, 97, 238, 0.3);
        }

        .writing-box.correct {
            border-color: var(--success);
            background: rgba(74, 222, 128, 0.1);
        }

        .writing-box.incorrect {
            border-color: var(--error);
            background: rgba(239, 68, 68, 0.1);
        }

        /* Word Writing */
        .word-writing-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .word-writing-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(248, 250, 252, 0.9);
            padding: 12px 15px;
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .night-mode .word-writing-item {
            background: rgba(30, 41, 59, 0.9);
        }

        .word-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .word-input-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .word-input {
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: rgba(248, 250, 252, 0.9);
            color: var(--text);
            direction: ltr;
            min-width: 150px;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .night-mode .word-input {
            background: rgba(30, 41, 59, 0.9);
        }

        .word-input:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 2px rgba(67, 97, 238, 0.3);
        }

        .word-input.correct {
            border-color: var(--success);
            background: rgba(74, 222, 128, 0.1);
        }

        .word-input.incorrect {
            border-color: var(--error);
            background: rgba(239, 68, 68, 0.1);
        }

        /* Quiz Section */
        .quiz-container {
            background: rgba(248, 250, 252, 0.9);
            border-radius: var(--radius-md);
            padding: 15px;
            border: 1px solid var(--border);
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .night-mode .quiz-container {
            background: rgba(30, 41, 59, 0.9);
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .quiz-question {
            font-size: 16px;
            margin-bottom: 15px;
            direction: ltr;
            font-weight: 600;
        }

        .quiz-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .quiz-option {
            padding: 10px 15px;
            border-radius: 50px;
            border: 1px solid var(--border);
            background: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
            user-select: none;
            flex: 1;
            min-width: 120px;
            text-align: center;
        }

        .night-mode .quiz-option {
            background: rgba(30, 41, 59, 0.9);
        }

        .quiz-option:hover {
            background: rgba(67, 97, 238, 0.1);
            border-color: var(--primary-light);
        }

        .quiz-option.correct {
            background: rgba(74, 222, 128, 0.1);
            border-color: var(--success);
            color: var(--success);
        }

        .quiz-option.incorrect {
            background: rgba(239, 68, 68, 0.1);
            border-color: var(--error);
            color: var(--error);
        }

        .quiz-option.disabled {
            pointer-events: none;
            opacity: 0.7;
        }

        /* Quiz Navigation */
        .quiz-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--border);
        }

        .quiz-next-btn {
            padding: 10px 20px;
            border-radius: 50px;
            border: none;
            background: var(--gradient-primary);
            color: white;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .quiz-next-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .quiz-next-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        /* Score Panel */
        .score-panel {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .score-card {
            background: rgba(248, 250, 252, 0.9);
            border-radius: var(--radius-md);
            padding: 15px;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            gap: 5px;
            transition: all 0.3s ease;
        }

        .night-mode .score-card {
            background: rgba(30, 41, 59, 0.9);
        }

        .score-label {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .score-value {
            font-size: 20px;
            font-weight: 700;
        }

        .score-value.high {
            color: var(--success);
        }

        .score-value.medium {
            color: var(--warning);
        }

        .score-value.low {
            color: var(--error);
        }

        /* Footer Actions */
        .footer-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
            overflow-y: auto;
            padding: 20px;
        }

        .night-mode .modal {
            background: rgba(15, 23, 42, 0.95);
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.98);
            border-radius: var(--radius-lg);
            padding: 25px;
            max-width: 500px;
            width: 90%;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            position: relative;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            max-height: 90vh;
            overflow-y: auto;
        }

        .night-mode .modal-content {
            background: rgba(30, 41, 59, 0.98);
        }

        .modal-close {
            position: absolute;
            top: 15px;
            left: 15px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 20px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 1;
        }

        .modal-close:hover {
            background: rgba(15, 23, 42, 0.05);
            color: var(--text);
        }

        .night-mode .modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .modal-badge {
            display: inline-block;
            background: var(--gradient-primary);
            color: white;
            padding: 5px 15px;
            border-radius: 50px;
            font-size: 14px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .modal-title {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--primary);
            font-weight: 700;
        }

        .modal-subtitle {
            color: var(--text-secondary);
            margin-bottom: 20px;
            font-weight: 600;
        }

        .modal-quote {
            background: rgba(248, 250, 252, 0.9);
            padding: 15px;
            border-radius: var(--radius-md);
            border-left: 4px solid var(--accent);
            margin-bottom: 20px;
            font-style: italic;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .night-mode .modal-quote {
            background: rgba(30, 41, 59, 0.9);
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .modal-btn {
            padding: 12px 20px;
            border-radius: 50px;
            border: none;
            font-weight: 700;
            cursor: pointer;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
            min-width: 140px;
            user-select: none;
        }

        .modal-btn.game {
            background: var(--gradient-accent);
            color: white;
        }

        .modal-btn.next {
            background: var(--gradient-success);
            color: white;
        }

        /* Game Modal */
        .game-modal {
            max-width: 600px;
            padding: 20px;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .game-title {
            font-size: 18px;
            font-weight: 700;
        }

        .game-score {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(248, 250, 252, 0.9);
            padding: 8px 15px;
            border-radius: 50px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            font-weight: 600;
            flex-wrap: wrap;
        }

        .night-mode .game-score {
            background: rgba(30, 41, 59, 0.9);
        }

        .game-area {
            background: rgba(248, 250, 252, 0.9);
            border-radius: var(--radius-md);
            height: 400px;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            touch-action: none;
        }

        .night-mode .game-area {
            background: rgba(30, 41, 59, 0.9);
        }

        .game-canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        /* New Game Styles */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .game-card {
            background: rgba(248, 250, 252, 0.9);
            border-radius: var(--radius-md);
            padding: 20px;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
            user-select: none;
        }

        .night-mode .game-card {
            background: rgba(30, 41, 59, 0.9);
        }

        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-light);
            border-color: var(--primary-light);
        }

        .game-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .game-icon {
            font-size: 40px;
        }

        .game-name {
            font-size: 16px;
            font-weight: 700;
            text-align: center;
        }

        /* Certificate Styles */
        .certificate-container {
            background: white;
            color: #1e293b;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 90%;
            text-align: center;
            position: relative;
            border: 10px solid #3a0ca3;
        }

        .certificate-container::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            border: 2px solid #4361ee;
            pointer-events: none;
        }

        .certificate-header {
            margin-bottom: 30px;
        }

        .certificate-title {
            font-size: 36px;
            color: #3a0ca3;
            margin-bottom: 10px;
            font-weight: 800;
        }

        .certificate-subtitle {
            font-size: 18px;
            color: #4361ee;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .certificate-body {
            margin: 30px 0;
        }

        .certificate-student-name {
            font-size: 32px;
            color: #f72585;
            margin: 20px 0;
            padding: 10px;
            border-bottom: 2px solid #4cc9f0;
            display: inline-block;
            font-weight: 700;
        }

        .certificate-message {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 30px;
            font-weight: 600;
        }

        .certificate-date {
            font-size: 16px;
            margin-top: 30px;
            font-weight: 600;
        }

        .certificate-stamp {
            position: absolute;
            bottom: 40px;
            left: 40px;
            width: 120px;
            height: 120px;
            border: 2px solid #f72585;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 700;
            color: #f72585;
            transform: rotate(-15deg);
        }

        /* Completion Animation */
        .completion-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 999;
            pointer-events: none;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--accent);
            opacity: 0.8;
            animation: fall linear forwards;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            height: 8px;
            background: rgba(248, 250, 252, 0.9);
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }

        .night-mode .progress-container {
            background: rgba(30, 41, 59, 0.9);
        }

        .progress-bar {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* Achievement Badges */
        .achievements-container {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .achievement-badge {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--gradient-primary);
            color: white;
            font-size: 24px;
            position: relative;
            box-shadow: var(--shadow-light);
            font-weight: 600;
        }

        .achievement-badge.locked {
            background: rgba(248, 250, 252, 0.9);
            color: var(--text-secondary);
        }

        .night-mode .achievement-badge.locked {
            background: rgba(30, 41, 59, 0.9);
        }

        .achievement-badge .tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.98);
            color: var(--text);
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            border: 1px solid var(--border);
            box-shadow: var(--shadow-light);
            font-weight: 600;
        }

        .night-mode .achievement-badge .tooltip {
            background: rgba(30, 41, 59, 0.98);
        }

        .achievement-badge:hover .tooltip {
            opacity: 1;
        }

        /* Microphone Permission Status */
        .mic-status {
            position: fixed;
            bottom: 80px;
            left: 20px;
            background: var(--gradient-primary);
            color: white;
            padding: 10px 15px;
            border-radius: 50px;
            font-size: 14px;
            display: none;
            align-items: center;
            gap: 8px;
            z-index: 100;
            box-shadow: var(--shadow);
            font-weight: 600;
        }

        .mic-status.show {
            display: flex;
        }

        .mic-status.error {
            background: var(--gradient-accent);
        }

        /* Game Controls */
        .game-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            border: none;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            user-select: none;
        }

        .control-btn:active {
            transform: scale(0.95);
        }

        /* Touch Controls for Mobile */
        .touch-controls {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            pointer-events: none;
            z-index: 10;
        }

        .touch-controls .control-btn {
            pointer-events: auto;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        /* Game Instructions */
        .game-instructions {
            background: rgba(248, 250, 252, 0.9);
            border-radius: var(--radius-md);
            padding: 15px;
            margin-top: 15px;
            border: 1px solid var(--border);
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .night-mode .game-instructions {
            background: rgba(30, 41, 59, 0.9);
        }

        /* Letter Jump Menu */
        .letter-jump-menu {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            background: var(--surface);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            z-index: 100;
            display: none;
            flex-direction: column;
            max-height: 300px;
            overflow-y: auto;
        }

        .letter-jump-menu.show {
            display: flex;
        }

        .letter-jump-item {
            padding: 10px 15px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
        }

        .letter-jump-item:hover {
            background: var(--primary);
            color: white;
        }

        /* Game Win Modal */
        .win-modal .modal-content {
            max-width: 400px;
        }

        .win-animation {
            font-size: 60px;
            text-align: center;
            margin: 20px 0;
            animation: bounce 1s infinite alternate;
        }

        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-20px); }
        }

        /* Scroll to Top Button */
        .scroll-top {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            border: none;
            font-size: 20px;
            cursor: pointer;
            box-shadow: var(--shadow);
            display: none;
            z-index: 99;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .scroll-top.visible {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .scroll-top:hover {
            transform: translateY(-5px);
        }

        /* Difficulty Indicator */
        .difficulty-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-left: 10px;
        }

        .difficulty-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--border);
        }

        .difficulty-dot.active {
            background: var(--primary);
        }

        /* Game Stats */
        .game-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 10px;
            padding: 10px;
            background: rgba(248, 250, 252, 0.9);
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
        }

        .night-mode .game-stats {
            background: rgba(30, 41, 59, 0.9);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--gradient-primary);
            color: white;
            padding: 12px 24px;
            border-radius: 50px;
            box-shadow: var(--shadow);
            z-index: 1001;
            font-weight: 600;
            text-align: center;
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
            min-width: 250px;
            max-width: 90%;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        /* Quiz Completion Effect */
        .quiz-completed {
            border-color: var(--success) !important;
            box-shadow: 0 0 15px rgba(74, 222, 128, 0.4) !important;
            animation: pulse 2s infinite;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .app-header {
                flex-direction: column;
                align-items: flex-start;
                padding: 15px;
            }
            
            .student-info {
                width: 100%;
                justify-content: space-between;
            }
            
            .main-content {
                padding: 15px;
                gap: 15px;
            }
            
            .letter-display {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .footer-actions {
                flex-direction: column;
                gap: 15px;
            }
            
            .modal-actions {
                flex-direction: column;
            }
            
            .writing-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .writing-label {
                min-width: auto;
            }
            
            .word-writing-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .word-input-container {
                width: 100%;
                justify-content: space-between;
            }
            
            .word-input {
                flex: 1;
                min-width: auto;
            }
            
            .certificate-container {
                padding: 20px;
            }
            
            .certificate-title {
                font-size: 28px;
            }
            
            .certificate-student-name {
                font-size: 24px;
            }

            .theme-toggle {
                position: relative;
                top: auto;
                left: auto;
                margin-top: 10px;
                order: 3;
                width: 100%;
                justify-content: center;
            }

            .mobile-menu {
                display: block;
                position: absolute;
                top: 20px;
                left: 25px;
            }
            
            .theme-toggle {
                top: 20px;
                right: 25px;
                left: auto;
                width: auto;
            }

            .mic-status {
                bottom: 100px;
                left: 10px;
                right: 10px;
                justify-content: center;
            }

            .game-area {
                height: 300px;
            }

            .control-btn {
                width: 60px;
                height: 60px;
                font-size: 24px;
            }

            .modal-content {
                padding: 20px;
            }

            .games-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .letter-jump-menu {
                right: 10px;
                max-height: 200px;
            }

            .quiz-option {
                min-width: 100px;
                font-size: 13px;
                padding: 8px 12px;
            }

            .quiz-navigation {
                flex-direction: column;
                gap: 10px;
            }

            .quiz-next-btn {
                width: 100%;
                justify-content: center;
            }

            .toast {
                bottom: 120px;
                min-width: 200px;
            }
        }

        @media (max-width: 480px) {
            .app-header {
                padding: 15px;
            }
            
            .logo-section {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .logo-text h1 {
                font-size: 18px;
            }
            
            .student-info {
                flex-direction: column;
                align-items: flex-start;
                width: 100%;
                gap: 10px;
            }
            
            .student-name {
                width: 100%;
            }
            
            .student-name input {
                width: 100%;
            }
            
            .progress-chip {
                width: 100%;
                justify-content: center;
            }
            
            .letter-tab {
                min-width: 40px;
                height: 40px;
                font-size: 14px;
            }
            
            .words-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
            
            .writing-box {
                width: 35px;
                height: 35px;
                font-size: 16px;
            }
            
            .score-panel {
                grid-template-columns: 1fr;
            }
            
            .games-grid {
                grid-template-columns: 1fr;
            }

            .game-modal .modal-content {
                padding: 15px;
            }

            .game-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .game-score {
                width: 100%;
                justify-content: center;
            }

            .control-btn {
                width: 50px;
                height: 50px;
            }

            .quiz-option {
                min-width: 80px;
                font-size: 12px;
                padding: 6px 10px;
            }

            .toast {
                bottom: 150px;
                min-width: 180px;
                font-size: 14px;
                padding: 10px 16px;
            }
        }

        @media (max-width: 360px) {
            .letter-tab {
                min-width: 35px;
                height: 35px;
                font-size: 12px;
            }

            .words-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .writing-box {
                width: 30px;
                height: 30px;
                font-size: 14px;
            }

            .game-area {
                height: 250px;
            }

            .quiz-option {
                min-width: 70px;
                font-size: 11px;
            }
        }

        /* Landscape orientation for mobile */
        @media (max-height: 600px) and (orientation: landscape) {
            .game-area {
                height: 250px;
            }

            .modal-content {
                max-height: 80vh;
                padding: 15px;
            }
        }

        /* Prevent text selection on game elements */
        .no-select {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        /* Game button active state */
        .game-card:active {
            transform: translateY(-2px);
        }

        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <!-- Mobile Menu -->
            <div class="mobile-menu">
                <div class="hamburger">‚ò∞</div>
                <div class="dropdown-content">
                    <a id="resetProgress">üîÑ ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™ŸÇÿØŸÖ</a>
                    <a id="viewAllLetters">üî§ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ÿ±ŸàŸÅ</a>
                    <a id="jumpToLetter">‚ÜóÔ∏è ÿßŸÜÿ™ŸÇÿßŸÑ ŸÑŸÑÿ≠ÿ±ŸÅ</a>
                    <a id="viewCertificate">üìú ÿßŸÑÿ¥ŸáÿßÿØÿ©</a>
                    <a id="toggleSound">üîä ÿ•ŸäŸÇÿßŸÅ ÿßŸÑÿµŸàÿ™</a>
                    <a id="testMicrophone">üé§ ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑŸÖÿßŸäŸÉ</a>
                </div>
            </div>
            
            <div class="theme-toggle" id="themeToggle">
                <i class="fas fa-sun"></i>
                <span>ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÜŸáÿßÿ±Ÿä</span>
            </div>
            
            <div class="logo-section">
                <div class="logo">PGL</div>
                <div class="logo-text">
                    <h1>ŸÖŸÜÿµÿ© ÿ£ŸÑÿπÿßÿ® ÿßŸÑÿ≠ÿ±ŸàŸÅ ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿäÿ©</h1>
                    <p>Phonics Game Lab - ÿ™ÿπŸÑŸÖ ÿßŸÑÿ≠ÿ±ŸàŸÅ ÿ®ÿ∑ÿ±ŸäŸÇÿ© ÿ™ŸÅÿßÿπŸÑŸäÿ©</p>
                </div>
            </div>
            
            <div class="student-info">
                <div class="student-name">
                    <span>üë§</span>
                    <input type="text" id="studentName" placeholder="ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖŸÉ">
                </div>
                <div class="progress-chip">
                    <span>ÿßŸÑÿ™ŸÇÿØŸÖ:</span>
                    <span class="progress-value" id="progressValue">ÿßŸÑÿ≠ÿ±ŸÅ A</span>
                </div>
            </div>
        </header>

        <!-- Letters Navigation -->
        <div class="letters-nav" id="lettersNav">
            <!-- Letters will be generated here by JavaScript -->
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar" style="width: 0%"></div>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Left Panel -->
            <section class="panel">
                <div class="panel-header">
                    <h2 class="panel-title">ÿ™ÿπŸÑŸÖ ÿßŸÑÿ≠ÿ±ŸÅ <span id="currentLetter">A</span></h2>
                    <span class="panel-badge">ÿßŸÑÿÆÿ∑Ÿàÿ© 1-2: ÿßÿ≥ÿ™ŸÖÿπÿå ÿßŸÜÿ∑ŸÇÿå ÿßŸÉÿ™ÿ®</span>
                </div>

                <!-- Letter Display -->
                <div class="letter-display">
                    <div class="letter-visual">
                        <div class="letter-uppercase" id="letterUpper">A</div>
                        <div class="letter-lowercase" id="letterLower">a</div>
                    </div>
                    <div class="letter-actions">
                        <button class="btn btn-primary" id="playLetter">
                            <span>üîä</span> ŸÜÿ∑ŸÇ ÿßŸÑÿ≠ÿ±ŸÅ
                        </button>
                        <button class="btn btn-secondary" id="letterInfo">
                            <span>‚ÑπÔ∏è</span> ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ≠ÿ±ŸÅ
                        </button>
                        <button class="btn btn-secondary" id="resetLetter">
                            <span>üîÑ</span> ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ©
                        </button>
                    </div>
                </div>

                <!-- Words Section -->
                <div class="words-section">
                    <h3 class="section-title">
                        <span>üî§</span> ŸÉŸÑŸÖÿßÿ™ ÿ™ÿ®ÿØÿ£ ÿ®ÿßŸÑÿ≠ÿ±ŸÅ <span id="letterForWords">A</span>
                    </h3>
                    <div class="words-grid" id="wordsGrid">
                        <!-- Words will be generated here by JavaScript -->
                    </div>
                </div>

                <!-- Writing Section -->
                <div class="writing-section">
                    <h3 class="section-title">
                        <span>‚úçÔ∏è</span> ÿ™ÿØÿ±ÿ® ÿπŸÑŸâ ŸÉÿ™ÿßÿ®ÿ© ÿßŸÑÿ≠ÿ±ŸÅ
                    </h3>
                    <div class="writing-row">
                        <div class="writing-label">ÿßŸÑÿ≠ÿ±ŸÅ ÿßŸÑŸÉÿ®Ÿäÿ± (A) 10 ŸÖÿ±ÿßÿ™</div>
                        <div class="writing-boxes" id="capitalWriting">
                            <!-- Writing boxes will be generated here by JavaScript -->
                        </div>
                    </div>
                    <div class="writing-row">
                        <div class="writing-label">ÿßŸÑÿ≠ÿ±ŸÅ ÿßŸÑÿµÿ∫Ÿäÿ± (a) 10 ŸÖÿ±ÿßÿ™</div>
                        <div class="writing-boxes" id="smallWriting">
                            <!-- Writing boxes will be generated here by JavaScript -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Right Panel -->
            <section class="panel">
                <div class="panel-header">
                    <h2 class="panel-title">ÿ™ŸÖÿßÿ±ŸäŸÜ ÿßŸÑÿ≠ÿ±ŸÅ</h2>
                    <span class="panel-badge">ÿßŸÑÿÆÿ∑Ÿàÿ© 3-4: ŸÉÿ™ÿßÿ®ÿ© ŸÉŸÑŸÖÿßÿ™ ŸàÿßÿÆÿ™ÿ®ÿßÿ±</span>
                </div>

                <!-- Word Writing -->
                <div class="words-section">
                    <h3 class="section-title">
                        <span>üìù</span> ÿßŸÉÿ™ÿ® ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿßŸÑÿ™ÿßŸÑŸäÿ©
                    </h3>
                    <div class="word-writing-list" id="wordWritingList">
                        <!-- Word writing items will be generated here by JavaScript -->
                    </div>
                </div>

                <!-- Quiz Section -->
                <div class="words-section">
                    <h3 class="section-title">
                        <span>‚ùì</span> ÿßÿÆÿ™ÿ®ÿ± ŸÖÿπŸÑŸàŸÖÿßÿ™ŸÉ
                    </h3>
                    <div class="quiz-container">
                        <div class="quiz-header">
                            <div>ÿßŸÑÿ≥ÿ§ÿßŸÑ <span id="questionNumber">1</span> ŸÖŸÜ 6</div>
                            <div>ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©: <span id="quizScore">0</span>/6</div>
                        </div>
                        <div class="quiz-question" id="quizQuestion">
                            <!-- Question will be set by JavaScript -->
                        </div>
                        <div class="quiz-options" id="quizOptions">
                            <!-- Options will be set by JavaScript -->
                        </div>
                        <div class="quiz-navigation" id="quizNavigation">
                            <button class="quiz-next-btn" id="quizNextBtn">
                                <span>‚û°Ô∏è</span> ÿßŸÑÿ™ÿßŸÑŸä
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Score Panel -->
                <div class="score-panel">
                    <div class="score-card">
                        <div class="score-label">ŸÉÿ™ÿßÿ®ÿ© ÿßŸÑÿ≠ÿ±ŸÅ</div>
                        <div class="score-value" id="writingScore">0/20</div>
                    </div>
                    <div class="score-card">
                        <div class="score-label">ŸÉÿ™ÿßÿ®ÿ© ÿßŸÑŸÉŸÑŸÖÿßÿ™</div>
                        <div class="score-value" id="wordsScore">0/6</div>
                    </div>
                    <div class="score-card">
                        <div class="score-label">ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±</div>
                        <div class="score-value" id="testScore">0/6</div>
                    </div>
                    <div class="score-card">
                        <div class="score-label">ÿßŸÑŸÖÿ¨ŸÖŸàÿπ</div>
                        <div class="score-value" id="totalScore">0/32</div>
                    </div>
                </div>

                <!-- Achievements -->
                <div class="words-section">
                    <h3 class="section-title">
                        <span>üèÜ</span> ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™
                    </h3>
                    <div class="achievements-container" id="achievementsContainer">
                        <!-- Achievements will be generated here by JavaScript -->
                    </div>
                </div>

                <!-- Footer Actions -->
                <div class="footer-actions">
                    <button class="btn btn-secondary" id="prevLetter">
                        <span>‚¨ÖÔ∏è</span> ÿßŸÑÿ≠ÿ±ŸÅ ÿßŸÑÿ≥ÿßÿ®ŸÇ
                    </button>
                    <button class="btn btn-primary" id="finishLetter">
                        <span>‚úÖ</span> ÿ•ŸÜŸáÿßÿ° ÿßŸÑÿ≠ÿ±ŸÅ
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Motivation Modal -->
    <div class="modal" id="motivationModal">
        <div class="modal-content">
            <button class="modal-close" id="closeMotivation">√ó</button>
            <div class="modal-header">
                <div class="modal-badge">üî• ŸÜÿßÿ±! ŸÖÿ®ÿ±ŸàŸÉ!</div>
                <h2 class="modal-title" id="motivationTitle">ÿ£ÿ≠ÿ≥ŸÜÿ™!</h2>
                <p class="modal-subtitle" id="motivationSubtitle">ŸÑŸÇÿØ ÿ£ÿ™ŸÖŸÖÿ™ ÿ™ÿπŸÑŸÖ ÿßŸÑÿ≠ÿ±ŸÅ A ÿ®ŸÜÿ¨ÿßÿ≠</p>
            </div>
            <div class="modal-quote" id="motivationQuote">
                "ŸÖŸÜ ÿ¨ÿØ Ÿàÿ¨ÿØÿå ŸàŸÖŸÜ ÿ≤ÿ±ÿπ ÿ≠ÿµÿØ. ÿßÿ≥ÿ™ŸÖÿ± ŸÅŸä ÿßŸÑÿ™ŸÇÿØŸÖ!"
            </div>
            
            <!-- Games Grid -->
            <div class="games-grid" id="gamesGrid">
                <div class="game-card" data-game="carRace">
                    <div class="game-icon">üèéÔ∏è</div>
                    <div class="game-name">ÿ≥ÿ®ÿßŸÇ ÿßŸÑÿ≥Ÿäÿßÿ±ÿßÿ™</div>
                </div>
                <div class="game-card" data-game="racket">
                    <div class="game-icon">üéæ</div>
                    <div class="game-name">ŸÑÿπÿ®ÿ© ÿßŸÑŸÖÿ∂ÿ±ÿ®</div>
                </div>
                <div class="game-card" data-game="fishing">
                    <div class="game-icon">üé£</div>
                    <div class="game-name">ÿßÿµÿ∑ŸäÿßÿØ ÿßŸÑÿ≠ÿ±ŸÅ</div>
                </div>
                <div class="game-card" data-game="balloons">
                    <div class="game-icon">üéà</div>
                    <div class="game-name">ŸÑÿπÿ®ÿ© ÿßŸÑÿ®ÿßŸÑŸàŸÜÿßÿ™</div>
                </div>
                <div class="game-card" data-game="memory">
                    <div class="game-icon">üß†</div>
                    <div class="game-name">ŸÑÿπÿ®ÿ© ÿßŸÑÿ∞ÿßŸÉÿ±ÿ©</div>
                </div>
                <div class="game-card" data-game="wordsearch">
                    <div class="game-icon">üîç</div>
                    <div class="game-name">ŸÑÿπÿ®ÿ© ÿßŸÑÿ®ÿ≠ÿ´</div>
                </div>
                <div class="game-card" data-game="typing">
                    <div class="game-icon">‚å®Ô∏è</div>
                    <div class="game-name">ÿßŸÑŸÉÿ™ÿßÿ®ÿ© ÿßŸÑÿ≥ÿ±Ÿäÿπÿ©</div>
                </div>
                <div class="game-card" data-game="match">
                    <div class="game-icon">üî§</div>
                    <div class="game-name">ŸÑÿπÿ®ÿ© ÿßŸÑŸÖÿ∑ÿßÿ®ŸÇÿ©</div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="modal-btn next" id="nextLetter">
                    <span>‚û°Ô∏è</span> ÿßŸÑÿ≠ÿ±ŸÅ ÿßŸÑÿ™ÿßŸÑŸä
                </button>
            </div>
        </div>
    </div>

    <!-- Game Modal -->
    <div class="modal" id="gameModal">
        <div class="modal-content game-modal">
            <button class="modal-close" id="closeGame">√ó</button>
            <div class="game-header">
                <h3 class="game-title" id="gameTitle">üéÆ ŸÑÿπÿ®ÿ© ÿ™ÿπŸÑŸäŸÖŸäÿ©</h3>
                <div class="game-score">
                    <span>ÿßŸÑŸÜŸÇÿßÿ∑:</span>
                    <span id="gameScore">0</span>
                    <span>ÿßŸÑŸàŸÇÿ™:</span>
                    <span id="gameTimer">60</span>
                </div>
            </div>
            <div class="game-area">
                <canvas id="gameCanvas"></canvas>
            </div>
            
            <!-- Touch Controls for Mobile -->
            <div class="touch-controls" id="touchControls">
                <button class="control-btn" data-action="left">‚Üê</button>
                <button class="control-btn" data-action="action">‚ö°</button>
                <button class="control-btn" data-action="right">‚Üí</button>
            </div>
            
            <div class="game-instructions" id="gameInstructions">
                ÿ™ÿπŸÑŸäŸÖÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©
            </div>
            
            <div class="game-stats" id="gameStats">
                <div class="stat-item">
                    <div class="stat-value" id="successCount">0</div>
                    <div class="stat-label">ŸÖÿ±ÿßÿ™ ŸÜÿßÿ¨ÿ≠ÿ©</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="difficultyLevel">1</div>
                    <div class="stat-label">ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="accuracy">0%</div>
                    <div class="stat-label">ÿßŸÑÿØŸÇÿ©</div>
                </div>
            </div>
            
            <div class="game-controls" id="gameControls">
                <button class="btn btn-primary" id="restartGame">
                    <span>üîÑ</span> ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÑÿπÿ®
                </button>
                <button class="btn btn-secondary" id="pauseGame">
                    <span>‚è∏Ô∏è</span> ÿ•ŸäŸÇÿßŸÅ
                </button>
            </div>
        </div>
    </div>

    <!-- Win Modal -->
    <div class="modal win-modal" id="winModal">
        <div class="modal-content">
            <button class="modal-close" id="closeWin">√ó</button>
            <div class="modal-header">
                <div class="modal-badge">üèÜ ŸÅŸàÿ≤ ÿ±ÿßÿ¶ÿπ!</div>
                <h2 class="modal-title" id="winTitle">ŸÖÿ®ÿ±ŸàŸÉ! ŸÑŸÇÿØ ŸÅÿ≤ÿ™!</h2>
                <p class="modal-subtitle" id="winSubtitle">ÿ≠ŸÇŸÇÿ™Ÿá 10 ŸÖÿ±ÿßÿ™ ŸÜÿßÿ¨ÿ≠ÿ©!</p>
            </div>
            
            <div class="win-animation" id="winAnimation">üéâ</div>
            
            <div class="modal-quote" id="winQuote">
                "ÿ£ŸÜÿ™ ÿ®ÿ∑ŸÑ ŸÅŸä ÿ™ÿπŸÑŸÖ ÿßŸÑÿ≠ÿ±ŸàŸÅ ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿäÿ©!"
            </div>
            
            <div class="game-stats">
                <div class="stat-item">
                    <div class="stat-value" id="finalScore">0</div>
                    <div class="stat-label">ÿßŸÑŸÜŸÇÿßÿ∑ ÿßŸÑŸÜŸáÿßÿ¶Ÿäÿ©</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="finalTime">60</div>
                    <div class="stat-label">ÿ´ÿßŸÜŸäÿ© ŸÖÿ™ÿ®ŸÇŸäÿ©</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="finalAccuracy">100%</div>
                    <div class="stat-label">ÿßŸÑÿØŸÇÿ©</div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="modal-btn game" id="playAgain">
                    <span>üîÑ</span> ÿßŸÑÿπÿ® ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ
                </button>
                <button class="modal-btn next" id="backToGames">
                    <span>üè†</span> ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑÿ£ŸÑÿπÿßÿ®
                </button>
            </div>
        </div>
    </div>

    <!-- Certificate Modal -->
    <div class="modal" id="certificateModal">
        <div class="certificate-container">
            <div class="certificate-header">
                <h1 class="certificate-title">ÿ¥ŸáÿßÿØÿ© ÿ•ŸÜÿ¨ÿßÿ≤</h1>
                <p class="certificate-subtitle">ŸÖŸÜÿµÿ© ÿ£ŸÑÿπÿßÿ® ÿßŸÑÿ≠ÿ±ŸàŸÅ ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿäÿ©</p>
            </div>
            <div class="certificate-body">
                <p>Ÿáÿ∞Ÿá ÿßŸÑÿ¥ŸáÿßÿØÿ© ÿ™ŸÖŸÜÿ≠ ÿ•ŸÑŸâ:</p>
                <h2 class="certificate-student-name" id="certificateName">ÿßŸÑÿ∑ÿßŸÑÿ® ÿßŸÑŸÖÿ™ŸÖŸäÿ≤</h2>
                <p class="certificate-message">
                    ŸÑŸÇÿØ ÿ£ÿ™ŸÖŸÖÿ™ ÿ®ŸÜÿ¨ÿßÿ≠ ÿ™ÿπŸÑŸÖ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ÿ±ŸàŸÅ ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿäÿ© ŸÖŸÜ A ÿ•ŸÑŸâ Z<br>
                    Ÿàÿ£ÿ∏Ÿáÿ±ÿ™ ÿ™ŸÅÿßŸÜŸäÿßŸã ŸàŸÖÿ´ÿßÿ®ÿ±ÿ© ŸÅŸä ÿ±ÿ≠ŸÑÿ© ÿßŸÑÿ™ÿπŸÑŸÖ
                </p>
                <p class="certificate-date" id="certificateDate">ÿ™ŸÖ ŸÖŸÜÿ≠ Ÿáÿ∞Ÿá ÿßŸÑÿ¥ŸáÿßÿØÿ© ŸÅŸä: Ÿ° ŸäŸÜÿßŸäÿ± Ÿ¢Ÿ†Ÿ¢Ÿ£</p>
            </div>
            <div class="certificate-stamp">
                ŸÖŸÉÿ™ŸÖŸÑ<br>ÿ®ŸÜÿ¨ÿßÿ≠
            </div>
            <div style="margin-top: 30px;">
                <button class="btn btn-primary" id="printCertificate">
                    <span>üñ®Ô∏è</span> ÿ∑ÿ®ÿßÿπÿ© ÿßŸÑÿ¥ŸáÿßÿØÿ©
                </button>
                <button class="btn btn-secondary" id="closeCertificate">
                    <span>‚úï</span> ÿ•ÿ∫ŸÑÿßŸÇ
                </button>
            </div>
        </div>
    </div>

    <!-- Letter Jump Menu -->
    <div class="letter-jump-menu" id="letterJumpMenu">
        <!-- Letters will be added here -->
    </div>

    <!-- Completion Animation -->
    <div class="completion-animation" id="completionAnimation"></div>

    <!-- Microphone Status -->
    <div class="mic-status" id="micStatus">
        <span>üé§</span>
        <span id="micStatusText">ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ÿ∂Ÿäÿ± ÿßŸÑŸÖÿßŸäŸÉÿ±ŸàŸÅŸàŸÜ...</span>
    </div>

    <!-- Scroll to Top Button -->
    <button class="scroll-top" id="scrollTop">‚Üë</button>

    <script>
        // ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
        const LETTERS = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
        
        // ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿµŸàÿ™ ŸÑŸÖŸÜÿπ ÿßŸÑÿ™ÿØÿßÿÆŸÑ
        class SoundManager {
            constructor() {
                this.sounds = new Map();
                this.currentSpeech = null;
                this.isSpeaking = false;
                this.audioQueue = [];
                this.isProcessing = false;
            }
            
            speak(text, lang = 'en-US') {
                return new Promise((resolve) => {
                    if (!window.speechSynthesis) {
                        console.log('Speech synthesis not available');
                        resolve();
                        return;
                    }
                    
                    // ÿ•ŸÑÿ∫ÿßÿ° ÿ£Ÿä ŸÉŸÑÿßŸÖ ÿ≥ÿßÿ®ŸÇ
                    if (this.isSpeaking) {
                        window.speechSynthesis.cancel();
                        this.isSpeaking = false;
                    }
                    
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = lang;
                    utterance.rate = 0.8;
                    utterance.pitch = 1;
                    utterance.volume = 1;
                    
                    // ÿßÿÆÿ™Ÿäÿßÿ± ÿµŸàÿ™ ŸÖŸÜÿßÿ≥ÿ®
                    const voices = window.speechSynthesis.getVoices();
                    const englishVoice = voices.find(voice => 
                        voice.lang.startsWith('en') && voice.name.includes('Female')
                    ) || voices.find(voice => voice.lang.startsWith('en'));
                    
                    if (englishVoice) {
                        utterance.voice = englishVoice;
                    }
                    
                    utterance.onstart = () => {
                        this.isSpeaking = true;
                        this.currentSpeech = utterance;
                    };
                    
                    utterance.onend = () => {
                        this.isSpeaking = false;
                        this.currentSpeech = null;
                        resolve();
                    };
                    
                    utterance.onerror = (event) => {
                        console.error('Speech error:', event);
                        this.isSpeaking = false;
                        this.currentSpeech = null;
                        resolve();
                    };
                    
                    // ÿ™ÿ£ÿÆŸäÿ± ÿ®ÿ≥Ÿäÿ∑ ŸÇÿ®ŸÑ ÿßŸÑÿ®ÿØÿ°
                    setTimeout(() => {
                        window.speechSynthesis.speak(utterance);
                    }, 100);
                });
            }
            
            playSound(type) {
                if (!this.sounds.has(type)) {
                    this.createSound(type);
                }
                
                const sound = this.sounds.get(type);
                sound.currentTime = 0;
                sound.play().catch(e => console.log('Sound play failed:', e));
            }
            
            createSound(type) {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                let frequency, duration;
                
                switch(type) {
                    case 'success':
                        frequency = [523.25, 659.25, 783.99];
                        duration = 0.5;
                        break;
                    case 'error':
                        frequency = [220, 180];
                        duration = 0.3;
                        break;
                    case 'click':
                        frequency = [440];
                        duration = 0.1;
                        break;
                    default:
                        frequency = [440];
                        duration = 0.2;
                }
                
                oscillator.frequency.setValueAtTime(frequency[0], audioContext.currentTime);
                
                if (frequency.length > 1) {
                    frequency.forEach((freq, index) => {
                        oscillator.frequency.setValueAtTime(freq, audioContext.currentTime + (index * 0.1));
                    });
                }
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration);
                
                this.sounds.set(type, { oscillator, gainNode, audioContext });
            }
            
            stopAll() {
                if (this.isSpeaking) {
                    window.speechSynthesis.cancel();
                    this.isSpeaking = false;
                }
                
                this.sounds.forEach(sound => {
                    try {
                        sound.oscillator.stop();
                    } catch (e) {}
                });
                this.sounds.clear();
            }
        }

        // ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≠ÿ±ŸàŸÅ ŸàÿßŸÑŸÉŸÑŸÖÿßÿ™
        const LETTER_DATA = {
            A: {
                words: [
                    { word: "Apple", translation: "ÿ™ŸÅÿßÿ≠ÿ©", emoji: "üçé", sound: "√¶" },
                    { word: "Ant", translation: "ŸÜŸÖŸÑÿ©", emoji: "üêú", sound: "√¶" },
                    { word: "Alligator", translation: "ÿ™ŸÖÿ≥ÿßÿ≠", emoji: "üêä", sound: "√¶" },
                    { word: "Airplane", translation: "ÿ∑ÿßÿ¶ÿ±ÿ©", emoji: "‚úàÔ∏è", sound: "e…™" },
                    { word: "Arrow", translation: "ÿ≥ŸáŸÖ", emoji: "üèπ", sound: "√¶r" },
                    { word: "Astronaut", translation: "ÿ±ÿßÿ¶ÿØ ŸÅÿ∂ÿßÿ°", emoji: "üßë‚ÄçüöÄ", sound: "√¶" }
                ],
                quiz: [
                    {
                        question: "ŸÖÿß ŸáŸà ÿßŸÑÿµŸàÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä ŸÑŸÑÿ≠ÿ±ŸÅ Aÿü",
                        options: ["/√¶/ ŸÉŸÖÿß ŸÅŸä Apple", "/…ë:/ ŸÉŸÖÿß ŸÅŸä Arm", "/e…™/ ŸÉŸÖÿß ŸÅŸä Ace"],
                        correct: 0
                    },
                    {
                        question: "ÿ£Ÿä ŸÖŸÜ Ÿáÿ∞Ÿá ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿ™ÿ®ÿØÿ£ ÿ®ÿßŸÑÿ≠ÿ±ŸÅ Aÿü",
                        options: ["Apple", "Banana", "Cat"],
                        correct: 0
                    },
                    {
                        question: "ŸÖÿß ŸáŸà ÿ¥ŸÉŸÑ ÿßŸÑÿ≠ÿ±ŸÅ A ÿßŸÑÿµÿ∫Ÿäÿ±ÿü",
                        options: ["A", "a", "Œ±"],
                        correct: 1
                    },
                    {
                        question: "ÿ£Ÿä ŸÖŸÜ Ÿáÿ∞Ÿá ÿßŸÑÿµŸàÿ± ÿ™ÿ®ÿØÿ£ ÿ®ÿßŸÑÿ≠ÿ±ŸÅ Aÿü",
                        options: ["üçé", "üê∂", "üè†"],
                        correct: 0
                    },
                    {
                        question: "ŸÖÿß ŸÜŸàÿπ ÿßŸÑÿ≠ÿ±ŸÅ Aÿü",
                        options: ["ÿ≠ÿ±ŸÅ ŸÖÿ™ÿ≠ÿ±ŸÉ (Vowel)", "ÿ≠ÿ±ŸÅ ÿ≥ÿßŸÉŸÜ (Consonant)", "ÿ±ŸÇŸÖ"],
                        correct: 0
                    },
                    {
                        question: "ÿ£Ÿä ŸÉŸÑŸÖÿ© ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ ÿßŸÑÿ≠ÿ±ŸÅ A ŸÅŸä ÿßŸÑŸÖŸÜÿ™ÿµŸÅÿü",
                        options: ["Cat", "Apple", "Ant"],
                        correct: 0
                    }
                ],
                sound: "√¶",
                type: "ÿ≠ÿ±ŸÅ ŸÖÿ™ÿ≠ÿ±ŸÉ"
            },
            B: {
                words: [
                    { word: "Ball", translation: "ŸÉÿ±ÿ©", emoji: "‚öΩ", sound: "b" },
                    { word: "Banana", translation: "ŸÖŸàÿ≤ÿ©", emoji: "üçå", sound: "b" },
                    { word: "Butterfly", translation: "ŸÅÿ±ÿßÿ¥ÿ©", emoji: "ü¶ã", sound: "b" },
                    { word: "Book", translation: "ŸÉÿ™ÿßÿ®", emoji: "üìñ", sound: "b" },
                    { word: "Bear", translation: "ÿØÿ®", emoji: "üêª", sound: "b" },
                    { word: "Bird", translation: "ÿ∑ÿßÿ¶ÿ±", emoji: "üê¶", sound: "b" }
                ],
                quiz: [
                    {
                        question: "ŸÖÿß ŸáŸà ÿßŸÑÿµŸàÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä ŸÑŸÑÿ≠ÿ±ŸÅ Bÿü",
                        options: ["/b/ ŸÉŸÖÿß ŸÅŸä Ball", "/p/ ŸÉŸÖÿß ŸÅŸä Park", "/v/ ŸÉŸÖÿß ŸÅŸä Van"],
                        correct: 0
                    },
                    {
                        question: "ÿ£Ÿä ŸÖŸÜ Ÿáÿ∞Ÿá ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿ™ÿ®ÿØÿ£ ÿ®ÿßŸÑÿ≠ÿ±ŸÅ Bÿü",
                        options: ["Ball", "Apple", "Cat"],
                        correct: 0
                    },
                    {
                        question: "ŸÖÿß ŸáŸà ÿ¥ŸÉŸÑ ÿßŸÑÿ≠ÿ±ŸÅ B ÿßŸÑÿµÿ∫Ÿäÿ±ÿü",
                        options: ["B", "b", "Œ≤"],
                        correct: 1
                    },
                    {
                        question: "ÿ£Ÿä ŸÖŸÜ Ÿáÿ∞Ÿá ÿßŸÑÿµŸàÿ± ÿ™ÿ®ÿØÿ£ ÿ®ÿßŸÑÿ≠ÿ±ŸÅ Bÿü",
                        options: ["üçå", "üçé", "üê±"],
                        correct: 0
                    },
                    {
                        question: "ŸÖÿß ŸÜŸàÿπ ÿßŸÑÿ≠ÿ±ŸÅ Bÿü",
                        options: ["ÿ≠ÿ±ŸÅ ÿ≥ÿßŸÉŸÜ (Consonant)", "ÿ≠ÿ±ŸÅ ŸÖÿ™ÿ≠ÿ±ŸÉ (Vowel)", "ÿ±ŸÇŸÖ"],
                        correct: 0
                    },
                    {
                        question: "ÿ£Ÿä ŸÉŸÑŸÖÿ© ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ ÿßŸÑÿ≠ÿ±ŸÅ B ŸÅŸä ÿßŸÑŸÖŸÜÿ™ÿµŸÅÿü",
                        options: ["Rabbit", "Ball", "Banana"],
                        correct: 0
                    }
                ],
                sound: "b",
                type: "ÿ≠ÿ±ŸÅ ÿ≥ÿßŸÉŸÜ"
            },
            P: {
                words: [
                    { word: "Pencil", translation: "ŸÇŸÑŸÖ ÿ±ÿµÿßÿµ", emoji: "‚úèÔ∏è", sound: "p" },
                    { word: "Pizza", translation: "ÿ®Ÿäÿ™ÿ≤ÿß", emoji: "üçï", sound: "p" },
                    { word: "Penguin", translation: "ÿ®ÿ∑ÿ±ŸäŸÇ", emoji: "üêß", sound: "p" },
                    { word: "Panda", translation: "ÿ®ÿßŸÜÿØÿß", emoji: "üêº", sound: "p" },
                    { word: "Pineapple", translation: "ÿ£ŸÜÿßŸÜÿßÿ≥", emoji: "üçç", sound: "p" },
                    { word: "Pear", translation: "ŸÉŸÖÿ´ÿ±Ÿâ", emoji: "üçê", sound: "p" }
                ],
                quiz: [
                    {
                        question: "ŸÖÿß ŸáŸà ÿßŸÑÿµŸàÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä ŸÑŸÑÿ≠ÿ±ŸÅ Pÿü",
                        options: ["/p/ ŸÉŸÖÿß ŸÅŸä Pencil", "/b/ ŸÉŸÖÿß ŸÅŸä Ball", "/f/ ŸÉŸÖÿß ŸÅŸä Fish"],
                        correct: 0
                    },
                    {
                        question: "ÿ£Ÿä ŸÖŸÜ Ÿáÿ∞Ÿá ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿ™ÿ®ÿØÿ£ ÿ®ÿßŸÑÿ≠ÿ±ŸÅ Pÿü",
                        options: ["Pencil", "Apple", "Cat"],
                        correct: 0
                    },
                    {
                        question: "ŸÖÿß ŸáŸà ÿ¥ŸÉŸÑ ÿßŸÑÿ≠ÿ±ŸÅ P ÿßŸÑÿµÿ∫Ÿäÿ±ÿü",
                        options: ["P", "p", "œÅ"],
                        correct: 1
                    },
                    {
                        question: "ÿ£Ÿä ŸÖŸÜ Ÿáÿ∞Ÿá ÿßŸÑÿµŸàÿ± ÿ™ÿ®ÿØÿ£ ÿ®ÿßŸÑÿ≠ÿ±ŸÅ Pÿü",
                        options: ["‚úèÔ∏è", "üê∂", "üè†"],
                        correct: 0
                    },
                    {
                        question: "ŸÖÿß ŸÜŸàÿπ ÿßŸÑÿ≠ÿ±ŸÅ Pÿü",
                        options: ["ÿ≠ÿ±ŸÅ ÿ≥ÿßŸÉŸÜ (Consonant)", "ÿ≠ÿ±ŸÅ ŸÖÿ™ÿ≠ÿ±ŸÉ (Vowel)", "ÿ±ŸÇŸÖ"],
                        correct: 0
                    },
                    {
                        question: "ÿ£Ÿä ŸÉŸÑŸÖÿ© ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ ÿßŸÑÿ≠ÿ±ŸÅ P ŸÅŸä ÿßŸÑŸÖŸÜÿ™ÿµŸÅÿü",
                        options: ["Apple", "Pencil", "Panda"],
                        correct: 0
                    }
                ],
                sound: "p",
                type: "ÿ≠ÿ±ŸÅ ÿ≥ÿßŸÉŸÜ"
            },
            Z: {
                words: [
                    { word: "Zebra", translation: "ÿ≠ŸÖÿßÿ± Ÿàÿ≠ÿ¥Ÿä", emoji: "ü¶ì", sound: "z" },
                    { word: "Zoo", translation: "ÿ≠ÿØŸäŸÇÿ© ÿ≠ŸäŸàÿßŸÜÿßÿ™", emoji: "üêÖ", sound: "z" },
                    { word: "Zoologist", translation: "ÿπÿßŸÑŸÖ ÿ≠ŸäŸàÿßŸÜÿßÿ™", emoji: "üî¨", sound: "z" },
                    { word: "Zero", translation: "ÿµŸÅÿ±", emoji: "0Ô∏è‚É£", sound: "z" },
                    { word: "Zone", translation: "ŸÖŸÜÿ∑ŸÇÿ©", emoji: "üó∫Ô∏è", sound: "z" },
                    { word: "Zigzag", translation: "ŸÖÿ™ÿπÿ±ÿ¨", emoji: "‚ö°", sound: "z" }
                ],
                quiz: [
                    {
                        question: "ŸÖÿß ŸáŸà ÿßŸÑÿµŸàÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä ŸÑŸÑÿ≠ÿ±ŸÅ Zÿü",
                        options: ["/z/ ŸÉŸÖÿß ŸÅŸä Zebra", "/s/ ŸÉŸÖÿß ŸÅŸä Sun", "/ í/ ŸÉŸÖÿß ŸÅŸä Vision"],
                        correct: 0
                    },
                    {
                        question: "ÿ£Ÿä ŸÖŸÜ Ÿáÿ∞Ÿá ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿ™ÿ®ÿØÿ£ ÿ®ÿßŸÑÿ≠ÿ±ŸÅ Zÿü",
                        options: ["Zebra", "Apple", "Cat"],
                        correct: 0
                    },
                    {
                        question: "ŸÖÿß ŸáŸà ÿ¥ŸÉŸÑ ÿßŸÑÿ≠ÿ±ŸÅ Z ÿßŸÑÿµÿ∫Ÿäÿ±ÿü",
                        options: ["Z", "z", "Œ∂"],
                        correct: 1
                    },
                    {
                        question: "ÿ£Ÿä ŸÖŸÜ Ÿáÿ∞Ÿá ÿßŸÑÿµŸàÿ± ÿ™ÿ®ÿØÿ£ ÿ®ÿßŸÑÿ≠ÿ±ŸÅ Zÿü",
                        options: ["ü¶ì", "üê∂", "üè†"],
                        correct: 0
                    },
                    {
                        question: "ŸÖÿß ŸÜŸàÿπ ÿßŸÑÿ≠ÿ±ŸÅ Zÿü",
                        options: ["ÿ≠ÿ±ŸÅ ÿ≥ÿßŸÉŸÜ (Consonant)", "ÿ≠ÿ±ŸÅ ŸÖÿ™ÿ≠ÿ±ŸÉ (Vowel)", "ÿ±ŸÇŸÖ"],
                        correct: 0
                    },
                    {
                        question: "ÿ£Ÿä ŸÉŸÑŸÖÿ© ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ ÿßŸÑÿ≠ÿ±ŸÅ Z ŸÅŸä ÿßŸÑŸÖŸÜÿ™ÿµŸÅÿü",
                        options: ["Pizza", "Zebra", "Zoo"],
                        correct: 0
                    }
                ],
                sound: "z",
                type: "ÿ≠ÿ±ŸÅ ÿ≥ÿßŸÉŸÜ"
            }
        };

        // ÿ®ŸäÿßŸÜÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© ŸÑŸÑÿ≠ÿ±ŸàŸÅ ÿßŸÑÿ£ÿÆÿ±Ÿâ
        const ADDITIONAL_WORDS = {
            C: ["Cat", "Car", "Cake", "Cow", "Candy", "Cloud"],
            D: ["Dog", "Duck", "Door", "Dolphin", "Diamond", "Doctor"],
            E: ["Elephant", "Egg", "Ear", "Engine", "Eagle", "Earth"],
            F: ["Fish", "Flower", "Frog", "Flag", "Fox", "Fruit"],
            G: ["Giraffe", "Goat", "Grapes", "Gold", "Glass", "Garden"],
            H: ["House", "Horse", "Hat", "Heart", "Hand", "Honey"],
            I: ["Ice", "Igloo", "Insect", "Island", "Iron", "Ice cream"],
            J: ["Jellyfish", "Juice", "Jacket", "Jar", "Jewel", "Jungle"],
            K: ["Kite", "Key", "Kangaroo", "King", "Kitchen", "Koala"],
            L: ["Lion", "Lemon", "Leaf", "Ladder", "Light", "Ladybug"],
            M: ["Monkey", "Moon", "Milk", "Mouse", "Mountain", "Music"],
            N: ["Nest", "Nose", "Nut", "Night", "Nurse", "Numbers"],
            O: ["Octopus", "Orange", "Owl", "Ocean", "Onion", "Ostrich"],
            Q: ["Queen", "Quilt", "Question", "Quack", "Quarter", "Quiet"],
            R: ["Rabbit", "Rainbow", "Robot", "Rose", "Rocket", "Ring"],
            S: ["Sun", "Star", "Snake", "Spider", "Strawberry", "Ship"],
            T: ["Tiger", "Tree", "Table", "Train", "Tomato", "Turtle"],
            U: ["Umbrella", "Unicorn", "Uniform", "Ukulele", "Up", "Under"],
            V: ["Violin", "Volcano", "Vegetable", "Van", "Vase", "Vacuum"],
            W: ["Watermelon", "Whale", "Wheel", "Wolf", "Window", "Watch"],
            X: ["Xylophone", "X-ray", "Xmas", "Box", "Six", "Fox"],
            Y: ["Yoyo", "Yacht", "Yogurt", "Yellow", "Yak", "Yarn"]
        };

        // ÿ™ŸáŸäÿ¶ÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ© ŸÑŸÑÿ≠ÿ±ŸàŸÅ ÿßŸÑÿ£ÿÆÿ±Ÿâ
        LETTERS.forEach(letter => {
            if (!LETTER_DATA[letter]) {
                const words = ADDITIONAL_WORDS[letter] || [`${letter}pple`, `${letter}nt`, `${letter}lligator`, `${letter}irplane`, `${letter}rrow`, `${letter}stronaut`];
                const emojis = ["üçé", "üêú", "üêä", "‚úàÔ∏è", "üèπ", "üßë‚ÄçüöÄ"];
                const translations = ["ÿ™ŸÅÿßÿ≠ÿ©", "ŸÜŸÖŸÑÿ©", "ÿ™ŸÖÿ≥ÿßÿ≠", "ÿ∑ÿßÿ¶ÿ±ÿ©", "ÿ≥ŸáŸÖ", "ÿ±ÿßÿ¶ÿØ ŸÅÿ∂ÿßÿ°"];
                const sounds = ["√¶", "b", "k", "d", "e", "f", "g", "h", "…™", "d í", "k", "l", "m", "n", "…ëÀê", "k", "r", "s", "t", " å", "v", "w", "ks", "j", "z"];
                
                LETTER_DATA[letter] = {
                    words: words.map((word, index) => ({
                        word: word,
                        translation: translations[index] || word,
                        emoji: emojis[index] || "üî§",
                        sound: sounds[LETTERS.indexOf(letter)] || "√¶"
                    })),
                    quiz: [
                        {
                            question: `ŸÖÿß ŸáŸà ÿßŸÑÿµŸàÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä ŸÑŸÑÿ≠ÿ±ŸÅ ${letter}ÿü`,
                            options: [`/${sounds[LETTERS.indexOf(letter)] || '√¶'}/`, "/…ë:/", "/e…™/"],
                            correct: 0
                        },
                        {
                            question: `ÿ£Ÿä ŸÖŸÜ Ÿáÿ∞Ÿá ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿ™ÿ®ÿØÿ£ ÿ®ÿßŸÑÿ≠ÿ±ŸÅ ${letter}ÿü`,
                            options: [words[0], "Banana", "Cat"],
                            correct: 0
                        },
                        {
                            question: `ŸÖÿß ŸáŸà ÿ¥ŸÉŸÑ ÿßŸÑÿ≠ÿ±ŸÅ ${letter} ÿßŸÑÿµÿ∫Ÿäÿ±ÿü`,
                            options: [letter, letter.toLowerCase(), "Œ±"],
                            correct: 1
                        },
                        {
                            question: `ÿ£Ÿä ŸÖŸÜ Ÿáÿ∞Ÿá ÿßŸÑÿµŸàÿ± ÿ™ÿ®ÿØÿ£ ÿ®ÿßŸÑÿ≠ÿ±ŸÅ ${letter}ÿü`,
                            options: ["üçé", "üê∂", "üè†"],
                            correct: 0
                        },
                        {
                            question: `ŸÖÿß ŸÜŸàÿπ ÿßŸÑÿ≠ÿ±ŸÅ ${letter}ÿü`,
                            options: ["ÿ≠ÿ±ŸÅ ŸÖÿ™ÿ≠ÿ±ŸÉ (Vowel)", "ÿ≠ÿ±ŸÅ ÿ≥ÿßŸÉŸÜ (Consonant)", "ÿ±ŸÇŸÖ"],
                            correct: ["A", "E", "I", "O", "U"].includes(letter) ? 0 : 1
                        },
                        {
                            question: `ÿ£Ÿä ŸÉŸÑŸÖÿ© ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ ÿßŸÑÿ≠ÿ±ŸÅ ${letter} ŸÅŸä ÿßŸÑŸÖŸÜÿ™ÿµŸÅÿü`,
                            options: ["Cat", words[0], "Ant"],
                            correct: 0
                        }
                    ],
                    sound: sounds[LETTERS.indexOf(letter)] || "√¶",
                    type: ["A", "E", "I", "O", "U"].includes(letter) ? "ÿ≠ÿ±ŸÅ ŸÖÿ™ÿ≠ÿ±ŸÉ" : "ÿ≠ÿ±ŸÅ ÿ≥ÿßŸÉŸÜ"
                };
            }
        });

        // ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä
        class PhonicsGameLab {
            constructor() {
                this.currentLetterIndex = 0;
                this.currentQuizIndex = 0;
                this.quizScore = 0;
                this.writingScore = 0;
                this.wordsScore = 0;
                this.completedLetters = JSON.parse(localStorage.getItem('completedLetters')) || [];
                this.unlockedLetters = JSON.parse(localStorage.getItem('unlockedLetters')) || [0];
                this.studentName = localStorage.getItem('studentName') || '';
                this.currentGame = null;
                this.isNightMode = localStorage.getItem('nightMode') === 'true';
                this.gameInterval = null;
                this.gameTimeLeft = 60;
                this.soundEnabled = localStorage.getItem('soundEnabled') !== 'false';
                this.speechRecognition = null;
                this.isListening = false;
                this.micPermissionGranted = false;
                this.audioContext = null;
                this.analyser = null;
                this.microphone = null;
                this.audioStream = null;
                this.soundManager = new SoundManager();
                this.gameStats = {
                    successCount: 0,
                    totalAttempts: 0,
                    accuracy: 0,
                    difficulty: 1,
                    gameWins: 0
                };
                this.isPaused = false;
                this.touchControls = {
                    left: false,
                    right: false,
                    up: false,
                    down: false,
                    action: false
                };
                this.quizCompletedFlag = false;
                this.isAnswerSelected = false;
                this.currentQuizAnswer = null;
                
                this.init();
            }
            
            init() {
                this.cacheDOM();
                this.bindEvents();
                this.renderLettersNav();
                this.loadLetter(this.currentLetterIndex);
                this.updateProgress();
                this.setupScrollTop();
                this.setupTheme();
                this.renderAchievements();
                this.setupLetterJumpMenu();
                
                if (this.studentName) {
                    document.getElementById('studentName').value = this.studentName;
                }
                
                if (this.completedLetters.length === LETTERS.length) {
                    this.showCompletionAnimation();
                }
                
                this.setupSpeechRecognition();
                this.setupAudioVisualizer();
                this.checkMicrophonePermission();
                this.setupTouchControls();
                
                // ÿ™ÿ≠ŸÖŸäŸÑ ÿ£ÿµŸàÿßÿ™ ÿßŸÑŸÉŸÑÿßŸÖ
                if (window.speechSynthesis) {
                    window.speechSynthesis.onvoiceschanged = () => {
                        console.log('Voices loaded');
                    };
                }
            }
            
            cacheDOM() {
                this.lettersNav = document.getElementById('lettersNav');
                this.currentLetterEl = document.getElementById('currentLetter');
                this.letterUpperEl = document.getElementById('letterUpper');
                this.letterLowerEl = document.getElementById('letterLower');
                this.letterForWordsEl = document.getElementById('letterForWords');
                this.wordsGrid = document.getElementById('wordsGrid');
                this.capitalWriting = document.getElementById('capitalWriting');
                this.smallWriting = document.getElementById('smallWriting');
                this.wordWritingList = document.getElementById('wordWritingList');
                this.quizQuestion = document.getElementById('quizQuestion');
                this.quizOptions = document.getElementById('quizOptions');
                this.questionNumberEl = document.getElementById('questionNumber');
                this.quizScoreEl = document.getElementById('quizScore');
                this.writingScoreEl = document.getElementById('writingScore');
                this.wordsScoreEl = document.getElementById('wordsScore');
                this.testScoreEl = document.getElementById('testScore');
                this.totalScoreEl = document.getElementById('totalScore');
                this.progressValueEl = document.getElementById('progressValue');
                this.progressBar = document.getElementById('progressBar');
                this.achievementsContainer = document.getElementById('achievementsContainer');
                this.quizNextBtn = document.getElementById('quizNextBtn');
                this.quizNavigation = document.getElementById('quizNavigation');
                
                this.playLetterBtn = document.getElementById('playLetter');
                this.letterInfoBtn = document.getElementById('letterInfo');
                this.resetLetterBtn = document.getElementById('resetLetter');
                this.prevLetterBtn = document.getElementById('prevLetter');
                this.finishLetterBtn = document.getElementById('finishLetter');
                this.studentNameInput = document.getElementById('studentName');
                this.themeToggle = document.getElementById('themeToggle');
                
                this.hamburger = document.querySelector('.hamburger');
                this.dropdownContent = document.querySelector('.dropdown-content');
                this.resetProgressBtn = document.getElementById('resetProgress');
                this.viewAllLettersBtn = document.getElementById('viewAllLetters');
                this.viewCertificateBtn = document.getElementById('viewCertificate');
                this.toggleSoundBtn = document.getElementById('toggleSound');
                this.testMicrophoneBtn = document.getElementById('testMicrophone');
                this.jumpToLetterBtn = document.getElementById('jumpToLetter');
                
                this.motivationModal = document.getElementById('motivationModal');
                this.gameModal = document.getElementById('gameModal');
                this.winModal = document.getElementById('winModal');
                this.certificateModal = document.getElementById('certificateModal');
                this.closeMotivationBtn = document.getElementById('closeMotivation');
                this.closeGameBtn = document.getElementById('closeGame');
                this.closeWinBtn = document.getElementById('closeWin');
                this.nextLetterBtn = document.getElementById('nextLetter');
                this.motivationTitle = document.getElementById('motivationTitle');
                this.motivationSubtitle = document.getElementById('motivationSubtitle');
                this.motivationQuote = document.getElementById('motivationQuote');
                this.gamesGrid = document.getElementById('gamesGrid');
                
                this.gameCanvas = document.getElementById('gameCanvas');
                this.gameScoreEl = document.getElementById('gameScore');
                this.gameTimerEl = document.getElementById('gameTimer');
                this.gameTitle = document.getElementById('gameTitle');
                this.gameInstructions = document.getElementById('gameInstructions');
                this.touchControlsEl = document.getElementById('touchControls');
                this.gameControlsEl = document.getElementById('gameControls');
                this.restartGameBtn = document.getElementById('restartGame');
                this.pauseGameBtn = document.getElementById('pauseGame');
                this.successCountEl = document.getElementById('successCount');
                this.difficultyLevelEl = document.getElementById('difficultyLevel');
                this.accuracyEl = document.getElementById('accuracy');
                this.gameStatsEl = document.getElementById('gameStats');
                
                this.winTitle = document.getElementById('winTitle');
                this.winSubtitle = document.getElementById('winSubtitle');
                this.winQuote = document.getElementById('winQuote');
                this.winAnimation = document.getElementById('winAnimation');
                this.finalScoreEl = document.getElementById('finalScore');
                this.finalTimeEl = document.getElementById('finalTime');
                this.finalAccuracyEl = document.getElementById('finalAccuracy');
                this.playAgainBtn = document.getElementById('playAgain');
                this.backToGamesBtn = document.getElementById('backToGames');
                
                this.certificateName = document.getElementById('certificateName');
                this.certificateDate = document.getElementById('certificateDate');
                this.printCertificateBtn = document.getElementById('printCertificate');
                this.closeCertificateBtn = document.getElementById('closeCertificate');
                
                this.completionAnimation = document.getElementById('completionAnimation');
                this.scrollTopBtn = document.getElementById('scrollTop');
                this.micStatus = document.getElementById('micStatus');
                this.micStatusText = document.getElementById('micStatusText');
                this.letterJumpMenu = document.getElementById('letterJumpMenu');
                this.toast = document.getElementById('toast');
            }
            
            bindEvents() {
                this.playLetterBtn.addEventListener('click', () => this.speakLetter());
                this.letterInfoBtn.addEventListener('click', () => this.showLetterInfo());
                this.resetLetterBtn.addEventListener('click', () => this.resetLetter());
                this.prevLetterBtn.addEventListener('click', () => this.previousLetter());
                this.finishLetterBtn.addEventListener('click', () => this.finishLetter());
                this.themeToggle.addEventListener('click', () => this.toggleTheme());
                
                this.hamburger.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.dropdownContent.classList.toggle('show');
                });
                
                this.resetProgressBtn.addEventListener('click', () => {
                    if (confirm('ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™ŸÇÿØŸÖÿü ÿ≥Ÿäÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™ŸÉ.')) {
                        localStorage.clear();
                        location.reload();
                    }
                    this.dropdownContent.classList.remove('show');
                });
                
                this.viewAllLettersBtn.addEventListener('click', () => {
                    document.getElementById('lettersNav').scrollIntoView({ behavior: 'smooth' });
                    this.dropdownContent.classList.remove('show');
                });
                
                this.jumpToLetterBtn.addEventListener('click', () => {
                    this.toggleLetterJumpMenu();
                    this.dropdownContent.classList.remove('show');
                });
                
                this.viewCertificateBtn.addEventListener('click', () => {
                    if (this.completedLetters.length === LETTERS.length) {
                        this.showCertificate();
                    } else {
                        alert('ŸÑŸÖ ÿ™ŸÉÿ™ŸÖŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ÿ±ŸàŸÅ ÿ®ÿπÿØ!');
                    }
                    this.dropdownContent.classList.remove('show');
                });
                
                this.toggleSoundBtn.addEventListener('click', () => {
                    this.soundEnabled = !this.soundEnabled;
                    localStorage.setItem('soundEnabled', this.soundEnabled);
                    this.toggleSoundBtn.innerHTML = this.soundEnabled ? 
                        'üîä ÿ•ŸäŸÇÿßŸÅ ÿßŸÑÿµŸàÿ™' : 'üîá ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿµŸàÿ™';
                    this.dropdownContent.classList.remove('show');
                });
                
                this.testMicrophoneBtn.addEventListener('click', () => {
                    this.testMicrophone();
                    this.dropdownContent.classList.remove('show');
                });
                
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.mobile-menu')) {
                        this.dropdownContent.classList.remove('show');
                    }
                    if (!e.target.closest('#letterJumpMenu') && !e.target.closest('#jumpToLetter')) {
                        this.letterJumpMenu.classList.remove('show');
                    }
                });
                
                this.studentNameInput.addEventListener('input', (e) => {
                    this.studentName = e.target.value;
                    localStorage.setItem('studentName', this.studentName);
                });
                
                this.closeMotivationBtn.addEventListener('click', () => this.motivationModal.style.display = 'none');
                this.closeGameBtn.addEventListener('click', () => this.closeGame());
                this.closeWinBtn.addEventListener('click', () => this.winModal.style.display = 'none');
                this.nextLetterBtn.addEventListener('click', () => this.nextLetter());
                this.closeCertificateBtn.addEventListener('click', () => this.certificateModal.style.display = 'none');
                this.printCertificateBtn.addEventListener('click', () => this.printCertificate());
                this.restartGameBtn.addEventListener('click', () => this.restartGame());
                this.pauseGameBtn.addEventListener('click', () => this.togglePause());
                this.playAgainBtn.addEventListener('click', () => this.playAgain());
                this.backToGamesBtn.addEventListener('click', () => this.backToGames());
                
                this.gamesGrid.addEventListener('click', (e) => {
                    const gameCard = e.target.closest('.game-card');
                    if (gameCard && !gameCard.classList.contains('locked')) {
                        const gameType = gameCard.dataset.game;
                        this.startGame(gameType);
                    }
                });
                
                this.quizNextBtn.addEventListener('click', () => this.nextQuizQuestion());
                
                window.addEventListener('click', (e) => {
                    if (e.target === this.motivationModal) {
                        this.motivationModal.style.display = 'none';
                    }
                    if (e.target === this.gameModal) {
                        this.closeGame();
                    }
                    if (e.target === this.winModal) {
                        this.winModal.style.display = 'none';
                    }
                    if (e.target === this.certificateModal) {
                        this.certificateModal.style.display = 'none';
                    }
                });
                
                // ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑÿ£ŸÑÿπÿßÿ® ÿπŸÜÿØ ÿßŸÑÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ ÿ≤ÿ± ÿßŸÑŸáÿ±Ÿàÿ®
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closeGame();
                    }
                });
            }
            
            setupTheme() {
                if (this.isNightMode) {
                    document.body.classList.add('night-mode');
                    this.themeToggle.innerHTML = '<i class="fas fa-sun"></i><span>ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÜŸáÿßÿ±Ÿä</span>';
                } else {
                    document.body.classList.remove('night-mode');
                    this.themeToggle.innerHTML = '<i class="fas fa-moon"></i><span>ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÑŸäŸÑŸä</span>';
                }
            }
            
            toggleTheme() {
                this.isNightMode = !this.isNightMode;
                localStorage.setItem('nightMode', this.isNightMode);
                this.setupTheme();
            }
            
            setupSpeechRecognition() {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    this.speechRecognition = new SpeechRecognition();
                    this.speechRecognition.continuous = false;
                    this.speechRecognition.interimResults = false;
                    this.speechRecognition.lang = 'en-US';
                    this.speechRecognition.maxAlternatives = 1;
                    
                    this.speechRecognition.onstart = () => {
                        this.isListening = true;
                        this.showMicStatus('üé§ ÿ¨ÿßÿ±Ÿä ÿßŸÑÿßÿ≥ÿ™ŸÖÿßÿπ...', false);
                    };
                    
                    this.speechRecognition.onresult = (event) => {
                        const transcript = event.results[0][0].transcript.trim().toLowerCase();
                        this.showMicStatus('‚úÖ ÿ™ŸÖ ÿßŸÑÿßÿ≥ÿ™ŸÖÿßÿπ ÿ®ŸÜÿ¨ÿßÿ≠!', false);
                        setTimeout(() => this.hideMicStatus(), 2000);
                        return transcript;
                    };
                    
                    this.speechRecognition.onerror = (event) => {
                        this.isListening = false;
                        let errorMessage = 'ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ™ÿπÿ±ŸÅ ÿπŸÑŸâ ÿßŸÑÿµŸàÿ™';
                        
                        switch(event.error) {
                            case 'not-allowed':
                            case 'permission-denied':
                                errorMessage = 'ŸÑŸÖ Ÿäÿ™ŸÖ ŸÖŸÜÿ≠ ÿßŸÑÿ•ÿ∞ŸÜ ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸÖŸäŸÉÿ±ŸàŸÅŸàŸÜ';
                                this.micPermissionGranted = false;
                                break;
                            case 'no-speech':
                                errorMessage = 'ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÉÿ™ÿ¥ÿßŸÅ ÿ£Ÿä ŸÉŸÑÿßŸÖ';
                                break;
                            case 'audio-capture':
                                errorMessage = 'ŸÑÿß ŸäŸàÿ¨ÿØ ŸÖŸäŸÉÿ±ŸàŸÅŸàŸÜ ŸÖÿ™ÿßÿ≠';
                                break;
                            case 'network':
                                errorMessage = 'ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ¥ÿ®ŸÉÿ©';
                                break;
                        }
                        
                        this.showMicStatus(`‚ùå ${errorMessage}`, true);
                    };
                    
                    this.speechRecognition.onend = () => {
                        this.isListening = false;
                    };
                } else {
                    console.warn('Speech recognition not supported in this browser');
                    this.showMicStatus('‚ö†Ô∏è ÿßŸÑŸÖÿ™ÿµŸÅÿ≠ ŸÑÿß ŸäÿØÿÆÿØŸÖ ÿßŸÑÿ™ÿπÿ±ŸÅ ÿπŸÑŸâ ÿßŸÑÿµŸàÿ™', true);
                }
            }
            
            setupAudioVisualizer() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    this.analyser = this.audioContext.createAnalyser();
                    this.analyser.fftSize = 256;
                } catch (error) {
                    console.log('Audio context not supported:', error);
                }
            }
            
            async checkMicrophonePermission() {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    this.micPermissionGranted = true;
                    stream.getTracks().forEach(track => track.stop());
                    this.showMicStatus('‚úÖ ÿßŸÑŸÖÿßŸäŸÉÿ±ŸàŸÅŸàŸÜ ÿ¨ÿßŸáÿ≤ ŸÑŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ', false);
                    setTimeout(() => this.hideMicStatus(), 3000);
                } catch (error) {
                    this.micPermissionGranted = false;
                    this.showMicStatus('‚ùå Ÿäÿ±ÿ¨Ÿâ ŸÖŸÜÿ≠ ÿ•ÿ∞ŸÜ ÿßŸÑŸÖÿßŸäŸÉÿ±ŸàŸÅŸàŸÜ', true);
                }
            }
            
            showMicStatus(message, isError = false) {
                this.micStatusText.textContent = message;
                this.micStatus.className = 'mic-status' + (isError ? ' error' : '');
                this.micStatus.classList.add('show');
            }
            
            hideMicStatus() {
                this.micStatus.classList.remove('show');
            }
            
            async testMicrophone() {
                if (!this.micPermissionGranted) {
                    if (!await this.requestMicrophonePermission()) {
                        return;
                    }
                }
                
                try {
                    this.audioStream = await navigator.mediaDevices.getUserMedia({ 
                        audio: {
                            echoCancellation: true,
                            noiseSuppression: true,
                            autoGainControl: true
                        }
                    });
                    
                    this.showMicStatus('üé§ ÿ¨ÿßÿ±Ÿä ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑŸÖÿßŸäŸÉÿ±ŸàŸÅŸàŸÜ...', false);
                    
                    if (this.audioContext) {
                        const source = this.audioContext.createMediaStreamSource(this.audioStream);
                        source.connect(this.analyser);
                        
                        const bufferLength = this.analyser.frequencyBinCount;
                        const dataArray = new Uint8Array(bufferLength);
                        
                        const checkAudio = () => {
                            this.analyser.getByteFrequencyData(dataArray);
                            const average = dataArray.reduce((a, b) => a + b) / bufferLength;
                            
                            if (average > 10) {
                                this.showMicStatus('‚úÖ ÿßŸÑŸÖÿßŸäŸÉÿ±ŸàŸÅŸàŸÜ ŸäÿπŸÖŸÑ ÿ®ÿ¥ŸÉŸÑ ŸÖŸÖÿ™ÿßÿ≤!', false);
                                setTimeout(() => {
                                    this.stopMicrophoneTest();
                                    this.showMicStatus('üé§ ÿ¨ÿßŸáÿ≤ ŸÑŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ', false);
                                    setTimeout(() => this.hideMicStatus(), 2000);
                                }, 1000);
                            } else {
                                setTimeout(checkAudio, 100);
                            }
                        };
                        
                        setTimeout(() => {
                            this.showMicStatus('üé§ ÿ™ÿ≠ÿØÿ´ ÿßŸÑÿ¢ŸÜ...', false);
                            checkAudio();
                        }, 500);
                        
                        setTimeout(() => {
                            if (this.isListening) {
                                this.showMicStatus('‚ö†Ô∏è ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÉÿ™ÿ¥ÿßŸÅ ÿµŸàÿ™', true);
                                this.stopMicrophoneTest();
                            }
                        }, 5000);
                    }
                    
                } catch (error) {
                    this.showMicStatus('‚ùå ŸÅÿ¥ŸÑ ŸÅŸä ÿßŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ ÿßŸÑŸÖÿßŸäŸÉÿ±ŸàŸÅŸàŸÜ', true);
                }
            }
            
            stopMicrophoneTest() {
                if (this.audioStream) {
                    this.audioStream.getTracks().forEach(track => track.stop());
                    this.audioStream = null;
                }
            }
            
            async requestMicrophonePermission() {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    this.micPermissionGranted = true;
                    stream.getTracks().forEach(track => track.stop());
                    this.showMicStatus('‚úÖ ÿ™ŸÖ ŸÖŸÜÿ≠ ÿ•ÿ∞ŸÜ ÿßŸÑŸÖÿßŸäŸÉÿ±ŸàŸÅŸàŸÜ', false);
                    setTimeout(() => this.hideMicStatus(), 3000);
                    return true;
                } catch (error) {
                    this.showMicStatus('‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ŸÖŸÜÿ≠ ÿ•ÿ∞ŸÜ ÿßŸÑŸÖÿßŸäŸÉÿ±ŸàŸÅŸàŸÜ', true);
                    return false;
                }
            }
            
            setupTouchControls() {
                const controlButtons = this.touchControlsEl.querySelectorAll('.control-btn');
                
                controlButtons.forEach(btn => {
                    const action = btn.dataset.action;
                    
                    // ÿ£ÿ≠ÿØÿßÿ´ ÿßŸÑŸÑŸÖÿ≥
                    btn.addEventListener('touchstart', (e) => {
                        e.preventDefault();
                        this.touchControls[action] = true;
                        btn.style.transform = 'scale(0.95)';
                        this.soundManager.playSound('click');
                    });
                    
                    btn.addEventListener('touchend', (e) => {
                        e.preventDefault();
                        this.touchControls[action] = false;
                        btn.style.transform = 'scale(1)';
                    });
                    
                    btn.addEventListener('touchcancel', (e) => {
                        e.preventDefault();
                        this.touchControls[action] = false;
                        btn.style.transform = 'scale(1)';
                    });
                    
                    // ÿ£ÿ≠ÿØÿßÿ´ ÿßŸÑŸÖÿßŸàÿ≥ ŸÑŸÑÿßÿÆÿ™ÿ®ÿßÿ± ÿπŸÑŸâ ÿßŸÑŸÉŸÖÿ®ŸäŸàÿ™ÿ±
                    btn.addEventListener('mousedown', (e) => {
                        e.preventDefault();
                        this.touchControls[action] = true;
                        btn.style.transform = 'scale(0.95)';
                        this.soundManager.playSound('click');
                    });
                    
                    btn.addEventListener('mouseup', (e) => {
                        e.preventDefault();
                        this.touchControls[action] = false;
                        btn.style.transform = 'scale(1)';
                    });
                    
                    btn.addEventListener('mouseleave', (e) => {
                        e.preventDefault();
                        this.touchControls[action] = false;
                        btn.style.transform = 'scale(1)';
                    });
                });
                
                // ÿ•ÿÆŸÅÿßÿ° ÿπŸÜÿßÿµÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿ•ÿ∞ÿß ŸÑŸÖ ŸäŸÉŸÜ ÿßŸÑÿ¨Ÿáÿßÿ≤ ŸäÿØÿπŸÖ ÿßŸÑŸÑŸÖÿ≥
                if (!('ontouchstart' in window || navigator.maxTouchPoints > 0)) {
                    this.touchControlsEl.style.display = 'none';
                }
            }
            
            setupLetterJumpMenu() {
                this.letterJumpMenu.innerHTML = '';
                
                LETTERS.forEach((letter, index) => {
                    const item = document.createElement('div');
                    item.className = 'letter-jump-item';
                    item.textContent = `${letter} - ÿßŸÑÿ≠ÿ±ŸÅ ${index + 1}`;
                    item.dataset.index = index;
                    
                    item.addEventListener('click', () => {
                        if (this.unlockedLetters.includes(index)) {
                            this.loadLetter(index);
                            this.letterJumpMenu.classList.remove('show');
                        } else {
                            alert('Ÿäÿ¨ÿ® ÿ•ŸÜŸáÿßÿ° ÿßŸÑÿ≠ÿ±ŸàŸÅ ÿßŸÑÿ≥ÿßÿ®ŸÇÿ© ÿ£ŸàŸÑÿßŸã ŸÑŸÅÿ™ÿ≠ Ÿáÿ∞ÿß ÿßŸÑÿ≠ÿ±ŸÅ');
                        }
                    });
                    
                    this.letterJumpMenu.appendChild(item);
                });
            }
            
            toggleLetterJumpMenu() {
                this.letterJumpMenu.classList.toggle('show');
            }
            
            renderLettersNav() {
                this.lettersNav.innerHTML = '';
                
                LETTERS.forEach((letter, index) => {
                    const tab = document.createElement('div');
                    tab.className = 'letter-tab';
                    tab.textContent = letter;
                    tab.dataset.index = index;
                    
                    if (index === this.currentLetterIndex) {
                        tab.classList.add('active');
                    }
                    
                    if (this.completedLetters.includes(index)) {
                        tab.classList.add('completed');
                    }
                    
                    if (!this.unlockedLetters.includes(index)) {
                        tab.classList.add('locked');
                    }
                    
                    tab.addEventListener('click', () => {
                        if (this.unlockedLetters.includes(index)) {
                            this.loadLetter(index);
                        } else {
                            alert('Ÿäÿ¨ÿ® ÿ•ŸÜŸáÿßÿ° ÿßŸÑÿ≠ÿ±ŸàŸÅ ÿßŸÑÿ≥ÿßÿ®ŸÇÿ© ÿ£ŸàŸÑÿßŸã ŸÑŸÅÿ™ÿ≠ Ÿáÿ∞ÿß ÿßŸÑÿ≠ÿ±ŸÅ');
                        }
                    });
                    
                    this.lettersNav.appendChild(tab);
                });
            }
            
            loadLetter(index) {
                this.currentLetterIndex = index;
                this.currentQuizIndex = 0;
                this.quizScore = 0;
                this.writingScore = 0;
                this.wordsScore = 0;
                this.quizCompletedFlag = false;
                this.isAnswerSelected = false;
                this.currentQuizAnswer = null;
                
                const letter = LETTERS[index];
                this.currentLetterEl.textContent = letter;
                this.letterUpperEl.textContent = letter;
                this.letterLowerEl.textContent = letter.toLowerCase();
                this.letterForWordsEl.textContent = letter;
                
                this.renderWordsGrid();
                this.renderWritingBoxes();
                this.renderWordWriting();
                this.renderQuiz();
                this.updateScores();
                this.renderLettersNav();
                this.updateProgress();
                this.renderAchievements();
                
                // ÿ•ÿ≤ÿßŸÑÿ© ÿ™ÿ£ÿ´Ÿäÿ± ÿ•ŸÉŸÖÿßŸÑ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±
                const quizContainer = document.querySelector('.quiz-container');
                if (quizContainer) {
                    quizContainer.classList.remove('quiz-completed');
                }
            }
            
            renderWordsGrid() {
                this.wordsGrid.innerHTML = '';
                const letterData = LETTER_DATA[LETTERS[this.currentLetterIndex]];
                
                letterData.words.forEach(wordData => {
                    const card = document.createElement('div');
                    card.className = 'word-card';
                    
                    card.innerHTML = `
                        <div class="word-emoji">${wordData.emoji}</div>
                        <div class="word-text">${wordData.word}</div>
                        <div class="word-ar">${wordData.translation}</div>
                        <div class="word-actions">
                            <button class="icon-btn play-word" title="ÿßÿ≥ÿ™ŸÖÿπ ŸÑŸÑŸÜÿ∑ŸÇ">
                                üîä
                            </button>
                            <button class="icon-btn mic-word" title="ÿ≥ÿ¨ŸÑ ŸÜÿ∑ŸÇŸÉ">
                                üé§
                            </button>
                        </div>
                    `;
                    
                    const playBtn = card.querySelector('.play-word');
                    playBtn.addEventListener('click', () => {
                        this.speakText(wordData.word);
                    });
                    
                    const micBtn = card.querySelector('.mic-word');
                    micBtn.addEventListener('click', () => {
                        this.startSpeechRecognitionForWord(wordData.word, micBtn);
                    });
                    
                    this.wordsGrid.appendChild(card);
                });
            }
            
            renderWritingBoxes() {
                this.capitalWriting.innerHTML = '';
                this.smallWriting.innerHTML = '';
                
                const letter = LETTERS[this.currentLetterIndex];
                
                for (let i = 0; i < 10; i++) {
                    const box = document.createElement('input');
                    box.type = 'text';
                    box.className = 'writing-box';
                    box.maxLength = 1;
                    box.dataset.type = 'capital';
                    box.dataset.index = i;
                    box.placeholder = letter;
                    
                    box.addEventListener('input', (e) => {
                        this.checkWritingBox(e.target, letter);
                    });
                    
                    // ÿØÿπŸÖ ÿßŸÑŸÑŸÖÿ≥
                    box.addEventListener('focus', () => {
                        if ('ontouchstart' in window) {
                            setTimeout(() => {
                                box.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }, 100);
                        }
                    });
                    
                    this.capitalWriting.appendChild(box);
                }
                
                for (let i = 0; i < 10; i++) {
                    const box = document.createElement('input');
                    box.type = 'text';
                    box.className = 'writing-box';
                    box.maxLength = 1;
                    box.dataset.type = 'small';
                    box.dataset.index = i;
                    box.placeholder = letter.toLowerCase();
                    
                    box.addEventListener('input', (e) => {
                        this.checkWritingBox(e.target, letter.toLowerCase());
                    });
                    
                    box.addEventListener('focus', () => {
                        if ('ontouchstart' in window) {
                            setTimeout(() => {
                                box.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }, 100);
                        }
                    });
                    
                    this.smallWriting.appendChild(box);
                }
            }
            
            checkWritingBox(box, expected) {
                if (box.value.toUpperCase() === expected.toUpperCase()) {
                    box.classList.add('correct');
                    box.classList.remove('incorrect');
                    this.soundManager.playSound('success');
                } else if (box.value !== '') {
                    box.classList.add('incorrect');
                    box.classList.remove('correct');
                    this.soundManager.playSound('error');
                } else {
                    box.classList.remove('correct', 'incorrect');
                }
                
                this.updateWritingScore();
            }
            
            updateWritingScore() {
                const capitalBoxes = this.capitalWriting.querySelectorAll('.writing-box');
                const smallBoxes = this.smallWriting.querySelectorAll('.writing-box');
                
                let correctCount = 0;
                
                capitalBoxes.forEach(box => {
                    if (box.classList.contains('correct')) {
                        correctCount++;
                    }
                });
                
                smallBoxes.forEach(box => {
                    if (box.classList.contains('correct')) {
                        correctCount++;
                    }
                });
                
                this.writingScore = correctCount;
                this.updateScores();
            }
            
            renderWordWriting() {
                this.wordWritingList.innerHTML = '';
                const letterData = LETTER_DATA[LETTERS[this.currentLetterIndex]];
                
                letterData.words.forEach((wordData, index) => {
                    const item = document.createElement('div');
                    item.className = 'word-writing-item';
                    
                    item.innerHTML = `
                        <div class="word-info">
                            <button class="icon-btn play-word-write" title="ÿßÿ≥ÿ™ŸÖÿπ ŸÑŸÑŸÜÿ∑ŸÇ">üîä</button>
                            <span class="word-text">${wordData.word}</span>
                        </div>
                        <div class="word-input-container">
                            <input type="text" class="word-input" data-word="${wordData.word}" placeholder="ÿßŸÉÿ™ÿ® ÿßŸÑŸÉŸÑŸÖÿ©...">
                            <button class="icon-btn mic-word-write" title="ÿ≥ÿ¨ŸÑ ŸÜÿ∑ŸÇŸÉ">üé§</button>
                        </div>
                    `;
                    
                    const playBtn = item.querySelector('.play-word-write');
                    playBtn.addEventListener('click', () => {
                        this.speakText(wordData.word);
                    });
                    
                    const micBtn = item.querySelector('.mic-word-write');
                    const input = item.querySelector('.word-input');
                    micBtn.addEventListener('click', () => {
                        this.startSpeechRecognitionForWord(wordData.word, micBtn, input);
                    });
                    
                    input.addEventListener('input', (e) => {
                        this.checkWordInput(e.target, wordData.word);
                    });
                    
                    this.wordWritingList.appendChild(item);
                });
            }
            
            checkWordInput(input, expected) {
                if (input.value.toLowerCase() === expected.toLowerCase()) {
                    input.classList.add('correct');
                    input.classList.remove('incorrect');
                    this.soundManager.playSound('success');
                } else if (input.value !== '') {
                    input.classList.add('incorrect');
                    input.classList.remove('correct');
                    this.soundManager.playSound('error');
                } else {
                    input.classList.remove('correct', 'incorrect');
                }
                
                this.updateWordsScore();
            }
            
            updateWordsScore() {
                const inputs = this.wordWritingList.querySelectorAll('.word-input');
                let correctCount = 0;
                
                inputs.forEach(input => {
                    if (input.classList.contains('correct')) {
                        correctCount++;
                    }
                });
                
                this.wordsScore = correctCount;
                this.updateScores();
            }
            
            renderQuiz() {
                const letterData = LETTER_DATA[LETTERS[this.currentLetterIndex]];
                
                // ÿ•ÿ∞ÿß ÿ£ŸÉŸÖŸÑŸÜÿß ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ©ÿå ŸÜÿπÿ±ÿ∂ ÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑÿ•ŸÉŸÖÿßŸÑ
                if (this.currentQuizIndex >= 6) {
                    this.quizQuestion.textContent = "üéâ ŸÑŸÇÿØ ÿ£ŸÉŸÖŸÑÿ™ ÿ¨ŸÖŸäÿπ ÿ£ÿ≥ÿ¶ŸÑÿ© ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±!";
                    this.quizOptions.innerHTML = '<div class="quiz-option" style="background-color: var(--success); color: white; cursor: default;">ÿ™ŸÖ ÿ•ŸÉŸÖÿßŸÑ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ± ÿ®ŸÜÿ¨ÿßÿ≠</div>';
                    this.questionNumberEl.textContent = "6";
                    this.quizScoreEl.textContent = this.quizScore;
                    
                    // ÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑÿ•ŸÉŸÖÿßŸÑ
                    const quizContainer = document.querySelector('.quiz-container');
                    if (quizContainer) {
                        quizContainer.classList.add('quiz-completed');
                    }
                    
                    // ÿ•ÿÆŸÅÿßÿ° ÿ≤ÿ± ÿßŸÑÿ™ÿßŸÑŸä
                    this.quizNavigation.style.display = 'none';
                    
                    return;
                }
                
                const quiz = letterData.quiz[this.currentQuizIndex];
                
                this.quizQuestion.textContent = quiz.question;
                this.quizOptions.innerHTML = '';
                this.questionNumberEl.textContent = this.currentQuizIndex + 1;
                this.quizScoreEl.textContent = this.quizScore;
                
                // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿ≠ÿßŸÑÿ© ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ©
                this.isAnswerSelected = false;
                this.currentQuizAnswer = null;
                
                // ÿ•ÿÆŸÅÿßÿ° ÿ≤ÿ± ÿßŸÑÿ™ÿßŸÑŸä ÿ≠ÿ™Ÿâ Ÿäÿ™ŸÖ ÿßÿÆÿ™Ÿäÿßÿ± ÿ•ÿ¨ÿßÿ®ÿ©
                this.quizNextBtn.disabled = true;
                this.quizNextBtn.style.opacity = '0.5';
                
                quiz.options.forEach((option, index) => {
                    const optionEl = document.createElement('div');
                    optionEl.className = 'quiz-option';
                    optionEl.textContent = option;
                    optionEl.dataset.index = index;
                    
                    optionEl.addEventListener('click', () => {
                        if (!this.isAnswerSelected) {
                            this.checkQuizAnswer(index, quiz.correct, optionEl);
                        }
                    });
                    
                    this.quizOptions.appendChild(optionEl);
                });
                
                // ÿ•ÿ∏Ÿáÿßÿ± ÿ≤ÿ± ÿßŸÑÿ™ÿßŸÑŸä
                this.quizNavigation.style.display = 'flex';
            }
            
            checkQuizAnswer(selected, correct, optionEl) {
                if (this.isAnswerSelected) return;
                
                this.isAnswerSelected = true;
                this.currentQuizAnswer = { selected, correct };
                
                const options = this.quizOptions.querySelectorAll('.quiz-option');
                
                if (selected === correct) {
                    optionEl.classList.add('correct');
                    this.quizScore++;
                    this.quizScoreEl.textContent = this.quizScore;
                    this.soundManager.playSound('success');
                } else {
                    optionEl.classList.add('incorrect');
                    options[correct].classList.add('correct');
                    this.soundManager.playSound('error');
                }
                
                // ÿ™ÿπÿ∑ŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™ ÿ®ÿπÿØ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ©
                options.forEach(opt => {
                    opt.style.pointerEvents = 'none';
                    opt.classList.add('disabled');
                });
                
                // ÿ™ŸÅÿπŸäŸÑ ÿ≤ÿ± ÿßŸÑÿ™ÿßŸÑŸä
                this.quizNextBtn.disabled = false;
                this.quizNextBtn.style.opacity = '1';
                
                // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä ÿ®ÿπÿØ 3 ÿ´ŸàÿßŸÜŸç ÿ•ÿ∞ÿß ŸÑŸÖ ŸäŸÜŸÇÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿπŸÑŸâ ÿßŸÑÿ™ÿßŸÑŸä
                this.autoNextTimeout = setTimeout(() => {
                    this.nextQuizQuestion();
                }, 3000);
            }
            
            nextQuizQuestion() {
                // ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸÖŸàÿ¨ŸàÿØÿßŸã
                if (this.autoNextTimeout) {
                    clearTimeout(this.autoNextTimeout);
                    this.autoNextTimeout = null;
                }
                
                if (this.currentQuizIndex < 5) {
                    this.currentQuizIndex++;
                    this.renderQuiz();
                } else {
                    // Ÿáÿ∞ÿß ŸáŸà ÿßŸÑÿ≥ÿ§ÿßŸÑ ÿßŸÑÿ£ÿÆŸäÿ±
                    this.currentQuizIndex = 6; // ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸÅŸáÿ±ÿ≥ ŸÑŸäŸÉŸàŸÜ 6 ŸÑŸÑÿ•ÿ¥ÿßÿ±ÿ© ÿ•ŸÑŸâ ÿßŸÑÿ•ŸÉŸÖÿßŸÑ
                    this.quizCompletedFlag = true;
                    this.showToast('üéâ ŸÑŸÇÿØ ÿ£ŸÉŸÖŸÑÿ™ ÿ¨ŸÖŸäÿπ ÿ£ÿ≥ÿ¶ŸÑÿ© ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±!', 3000);
                    this.renderQuiz(); // ÿπÿ±ÿ∂ ÿ¥ÿßÿ¥ÿ© ÿ•ŸÉŸÖÿßŸÑ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±
                }
            }
            
            updateScores() {
                this.writingScoreEl.textContent = `${this.writingScore}/20`;
                this.wordsScoreEl.textContent = `${this.wordsScore}/6`;
                this.testScoreEl.textContent = `${this.quizScore}/6`;
                
                const total = this.writingScore + this.wordsScore + this.quizScore;
                this.totalScoreEl.textContent = `${total}/32`;
                
                this.totalScoreEl.className = 'score-value';
                if (total >= 22) {
                    this.totalScoreEl.classList.add('high');
                } else if (total >= 14) {
                    this.totalScoreEl.classList.add('medium');
                } else {
                    this.totalScoreEl.classList.add('low');
                }
            }
            
            updateProgress() {
                const currentLetter = LETTERS[this.currentLetterIndex];
                this.progressValueEl.textContent = `ÿßŸÑÿ≠ÿ±ŸÅ ${currentLetter}`;
                
                const progress = ((this.currentLetterIndex + 1) / LETTERS.length) * 100;
                this.progressBar.style.width = `${progress}%`;
            }
            
            renderAchievements() {
                this.achievementsContainer.innerHTML = '';
                
                const achievements = [
                    { id: 'first-letter', icon: 'üöÄ', name: 'ÿßŸÑÿ≠ÿ±ŸÅ ÿßŸÑÿ£ŸàŸÑ', description: 'ÿ•ŸÉŸÖÿßŸÑ ÿ£ŸàŸÑ ÿ≠ÿ±ŸÅ', unlocked: this.completedLetters.length >= 1 },
                    { id: 'five-letters', icon: '‚≠ê', name: '5 ÿ≠ÿ±ŸàŸÅ', description: 'ÿ•ŸÉŸÖÿßŸÑ 5 ÿ≠ÿ±ŸàŸÅ', unlocked: this.completedLetters.length >= 5 },
                    { id: 'ten-letters', icon: 'üèÜ', name: '10 ÿ≠ÿ±ŸàŸÅ', description: 'ÿ•ŸÉŸÖÿßŸÑ 10 ÿ≠ÿ±ŸàŸÅ', unlocked: this.completedLetters.length >= 10 },
                    { id: 'all-letters', icon: 'üëë', name: 'ŸÉŸÑ ÿßŸÑÿ≠ÿ±ŸàŸÅ', description: 'ÿ•ŸÉŸÖÿßŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ÿ±ŸàŸÅ', unlocked: this.completedLetters.length === LETTERS.length }
                ];
                
                achievements.forEach(achievement => {
                    const badge = document.createElement('div');
                    badge.className = `achievement-badge ${achievement.unlocked ? '' : 'locked'}`;
                    badge.innerHTML = `
                        <span>${achievement.icon}</span>
                        <div class="tooltip">${achievement.name}<br>${achievement.description}</div>
                    `;
                    
                    this.achievementsContainer.appendChild(badge);
                });
            }
            
            showToast(message, duration = 3000) {
                this.toast.textContent = message;
                this.toast.classList.add('show');
                
                setTimeout(() => {
                    this.toast.classList.remove('show');
                }, duration);
            }
            
            async speakLetter() {
                const letter = LETTERS[this.currentLetterIndex];
                await this.speakText(letter);
                await this.speakText(letter.toLowerCase());
            }
            
            async speakText(text) {
                if (!this.soundEnabled) return;
                await this.soundManager.speak(text);
            }
            
            showLetterInfo() {
                const letter = LETTERS[this.currentLetterIndex];
                const letterData = LETTER_DATA[letter];
                
                const info = `
                    <div style="text-align: right; direction: rtl;">
                        <h3 style="color: var(--primary); margin-bottom: 15px;">ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿπŸÜ ÿßŸÑÿ≠ÿ±ŸÅ ${letter}</h3>
                        <p><strong>ÿßŸÑŸÜŸàÿπ:</strong> ${letterData.type}</p>
                        <p><strong>ÿßŸÑÿµŸàÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä:</strong> /${letterData.sound}/</p>
                        <p><strong>ÿßŸÑÿ≠ÿ±ŸÅ ÿßŸÑŸÉÿ®Ÿäÿ±:</strong> ${letter}</p>
                        <p><strong>ÿßŸÑÿ≠ÿ±ŸÅ ÿßŸÑÿµÿ∫Ÿäÿ±:</strong> ${letter.toLowerCase()}</p>
                        <p><strong>ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿßŸÑÿ¥ÿßÿ¶ÿπÿ©:</strong> ${letterData.words.map(w => w.word).join(', ')}</p>
                        <hr style="margin: 15px 0; border-color: var(--border);">
                        <p style="font-style: italic; color: var(--text-secondary);">
                            ${letter === 'A' || letter === 'E' || letter === 'I' || letter === 'O' || letter === 'U' ? 
                              'Ÿáÿ∞ÿß ÿ≠ÿ±ŸÅ ŸÖÿ™ÿ≠ÿ±ŸÉ ŸäŸÖŸÉŸÜ ÿ£ŸÜ ŸäŸÉŸàŸÜ ŸÑŸá ÿπÿØÿ© ÿ£ÿµŸàÿßÿ™ ÿ≠ÿ≥ÿ® ÿßŸÑŸÉŸÑŸÖÿ©.' : 
                              'Ÿáÿ∞ÿß ÿ≠ÿ±ŸÅ ÿ≥ÿßŸÉŸÜ ŸÑŸá ÿµŸàÿ™ ÿ£ÿ≥ÿßÿ≥Ÿä.'}
                        </p>
                    </div>
                `;
                
                const modal = document.createElement('div');
                modal.innerHTML = info;
                
                alert(modal.textContent || modal.innerText);
            }
            
            async startSpeechRecognitionForWord(expectedWord, micButton, inputField = null) {
                if (!this.speechRecognition) {
                    this.showMicStatus('‚ö†Ô∏è ÿßŸÑŸÖÿ™ÿµŸÅÿ≠ ŸÑÿß ŸäÿØÿπŸÖ ÿßŸÑÿ™ÿπÿ±ŸÅ ÿπŸÑŸâ ÿßŸÑÿµŸàÿ™', true);
                    return;
                }
                
                if (!this.micPermissionGranted) {
                    if (!await this.requestMicrophonePermission()) {
                        return;
                    }
                }
                
                micButton.classList.add('mic-active');
                micButton.disabled = true;
                
                this.speechRecognition.onresult = async (event) => {
                    const transcript = event.results[0][0].transcript.trim().toLowerCase();
                    const expected = expectedWord.toLowerCase();
                    
                    micButton.classList.remove('mic-active');
                    micButton.disabled = false;
                    
                    // ÿ™ÿ≠ÿ≥ŸäŸÜ ÿØŸÇÿ© ÿßŸÑŸÖÿ∑ÿßÿ®ŸÇÿ©
                    const similarity = this.calculateSimilarity(transcript, expected);
                    
                    if (similarity >= 0.7) {
                        if (inputField) {
                            inputField.value = expectedWord;
                            inputField.classList.add('correct');
                            inputField.classList.remove('incorrect');
                            this.updateWordsScore();
                        }
                        
                        micButton.textContent = '‚úÖ';
                        this.showMicStatus('üéâ ŸÜÿ∑ŸÇ ŸÖŸÖÿ™ÿßÿ≤!', false);
                        this.soundManager.playSound('success');
                        
                        setTimeout(() => {
                            micButton.textContent = 'üé§';
                            this.hideMicStatus();
                        }, 2000);
                        
                        await this.speakText(expectedWord);
                    } else {
                        micButton.textContent = '‚ùå';
                        this.showMicStatus(`‚ö†Ô∏è ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ: ${expectedWord}`, true);
                        this.soundManager.playSound('error');
                        
                        setTimeout(() => {
                            micButton.textContent = 'üé§';
                            this.hideMicStatus();
                        }, 3000);
                        
                        await this.speakText(expectedWord);
                    }
                };
                
                this.speechRecognition.onerror = (event) => {
                    micButton.classList.remove('mic-active');
                    micButton.disabled = false;
                    micButton.textContent = 'üé§';
                    
                    if (event.error === 'no-speech') {
                        this.showMicStatus('‚ö†Ô∏è ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÉÿ™ÿ¥ÿßŸÅ ÿ£Ÿä ŸÉŸÑÿßŸÖ', true);
                    } else if (event.error === 'audio-capture') {
                        this.showMicStatus('‚ùå ŸÑÿß ŸäŸàÿ¨ÿØ ŸÖŸäŸÉÿ±ŸàŸÅŸàŸÜ ŸÖÿ™ÿßÿ≠', true);
                    } else {
                        this.showMicStatus('‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ™ÿπÿ±ŸÅ ÿπŸÑŸâ ÿßŸÑÿµŸàÿ™', true);
                    }
                    
                    setTimeout(() => this.hideMicStatus(), 3000);
                };
                
                try {
                    this.speechRecognition.start();
                } catch (error) {
                    micButton.classList.remove('mic-active');
                    micButton.disabled = false;
                    this.showMicStatus('‚ùå ÿπÿ∞ÿ±Ÿãÿßÿå ŸÑÿß ŸäŸÖŸÉŸÜ ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑŸÖŸäŸÉÿ±ŸàŸÅŸàŸÜ', true);
                    setTimeout(() => this.hideMicStatus(), 3000);
                }
            }
            
            calculateSimilarity(str1, str2) {
                const longer = str1.length > str2.length ? str1 : str2;
                const shorter = str1.length > str2.length ? str2 : str1;
                
                if (longer.length === 0) return 1.0;
                
                const distance = this.levenshteinDistance(longer, shorter);
                return (longer.length - distance) / longer.length;
            }
            
            levenshteinDistance(str1, str2) {
                const matrix = [];
                
                for (let i = 0; i <= str2.length; i++) {
                    matrix[i] = [i];
                }
                
                for (let j = 0; j <= str1.length; j++) {
                    matrix[0][j] = j;
                }
                
                for (let i = 1; i <= str2.length; i++) {
                    for (let j = 1; j <= str1.length; j++) {
                        const cost = str1.charAt(j - 1) === str2.charAt(i - 1) ? 0 : 1;
                        matrix[i][j] = Math.min(
                            matrix[i - 1][j] + 1,
                            matrix[i][j - 1] + 1,
                            matrix[i - 1][j - 1] + cost
                        );
                    }
                }
                
                return matrix[str2.length][str1.length];
            }
            
            resetLetter() {
                if (confirm('ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ≠ÿ±ŸÅ ÿßŸÑÿ≠ÿßŸÑŸäÿü ÿ≥Ÿäÿ™ŸÖ ŸÖÿ≥ÿ≠ ŸÉŸÑ ÿßŸÑÿ™ŸÇÿØŸÖ ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑÿ≠ÿ±ŸÅ.')) {
                    this.loadLetter(this.currentLetterIndex);
                }
            }
            
            previousLetter() {
                if (this.currentLetterIndex > 0) {
                    this.loadLetter(this.currentLetterIndex - 1);
                }
            }
            
            finishLetter() {
                const totalScore = this.writingScore + this.wordsScore + this.quizScore;
                
                if (totalScore >= 22) {
                    if (!this.completedLetters.includes(this.currentLetterIndex)) {
                        this.completedLetters.push(this.currentLetterIndex);
                        localStorage.setItem('completedLetters', JSON.stringify(this.completedLetters));
                    }
                    
                    const nextIndex = this.currentLetterIndex + 1;
                    if (nextIndex < LETTERS.length && !this.unlockedLetters.includes(nextIndex)) {
                        this.unlockedLetters.push(nextIndex);
                        localStorage.setItem('unlockedLetters', JSON.stringify(this.unlockedLetters));
                    }
                    
                    if (this.completedLetters.length === LETTERS.length) {
                        this.showCertificate();
                        this.showCompletionAnimation();
                    } else {
                        this.showMotivationModal(totalScore);
                    }
                } else {
                    alert(`ŸÑŸÖ ÿ™ÿ≠ŸÇŸÇ ÿØÿ±ÿ¨ÿ© ÿßŸÑŸÜÿ¨ÿßÿ≠ ÿ®ÿπÿØ!\n\nÿØÿ±ÿ¨ÿ™ŸÉ ÿßŸÑÿ≠ÿßŸÑŸäÿ©: ${totalScore}/32\nÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ ŸÑŸÑŸÜÿ¨ÿßÿ≠: 22/32\n\nŸäÿ±ÿ¨Ÿâ ÿ•ŸÉŸÖÿßŸÑ ÿßŸÑŸÖÿ≤ŸäÿØ ŸÖŸÜ ÿßŸÑÿ™ŸÖÿßÿ±ŸäŸÜ.`);
                }
            }
            
            showMotivationModal(totalScore) {
                const letter = LETTERS[this.currentLetterIndex];
                const studentName = this.studentName || 'ÿßŸÑÿ®ÿ∑ŸÑ';
                
                const fireQuotes = [
                    `üî• ${studentName}ÿå ÿ£ŸÜÿ™ ŸÜÿßÿ± ŸÅŸä ÿßŸÑÿ™ÿπŸÑŸÖ!`,
                    `üöÄ ${studentName} ŸäÿµÿπÿØ ÿ•ŸÑŸâ ÿßŸÑŸÇŸÖÿ© ÿ®ÿ≥ÿ±ÿπÿ© ÿßŸÑÿµÿßÿ±ŸàÿÆ!`,
                    `üëë ŸÖŸÑŸÉ/ŸÖŸÑŸÉÿ© ÿßŸÑÿ≠ÿ±ŸàŸÅ ŸáŸà/ŸáŸä ${studentName}!`,
                    `üí´ ÿ®ÿ±ÿßÿπÿ© ${studentName} ŸÑÿß ŸÖÿ´ŸäŸÑ ŸÑŸáÿß!`,
                    `üåü ${studentName} ŸäŸÑŸÖÿπ ŸÉÿßŸÑŸÜÿ¨ŸàŸÖ ŸÅŸä ÿ≥ŸÖÿßÿ° ÿßŸÑÿ™ÿπŸÑŸÖ!`,
                    `üèÜ ${studentName} Ÿäÿ≠ÿµÿØ ÿßŸÑÿ¨Ÿàÿßÿ¶ÿ≤ Ÿàÿßÿ≠ÿØÿ© ÿ™ŸÑŸà ÿßŸÑÿ£ÿÆÿ±Ÿâ!`,
                    `‚ö° ${studentName} ÿ≥ÿ±Ÿäÿπ ÿßŸÑÿ™ÿπŸÑŸÖ ŸÉÿßŸÑÿ®ÿ±ŸÇ!`,
                    `üéØ ${studentName} ŸäÿµŸäÿ® ÿßŸÑŸáÿØŸÅ ŸÅŸä ŸÉŸÑ ŸÖÿ±ÿ©!`
                ];
                
                const scoreQuotes = totalScore >= 30 ? [
                    `ŸÖÿ∞ŸáŸÑ! ${studentName} ÿ≠ŸÇŸÇ ${totalScore}/32!`,
                    `ÿ•ÿ™ŸÇÿßŸÜ ŸÉÿßŸÖŸÑ! ${studentName} ŸÖŸÖÿ™ÿßÿ≤!`,
                    `ÿ£ÿØÿßÿ° ÿÆÿßÿ±ŸÇ! ${studentName} ŸÅŸä ÿßŸÑŸÇŸÖÿ©!`
                ] : totalScore >= 25 ? [
                    `ÿ±ÿßÿ¶ÿπ! ${studentName} Ÿäÿ≠ŸÇŸÇ ŸÜÿ™ÿßÿ¶ÿ¨ ŸÖŸÖÿ™ÿßÿ≤ÿ©!`,
                    `ÿ•ŸÜÿ¨ÿßÿ≤ ŸÉÿ®Ÿäÿ±! ${studentName} Ÿäÿ™ŸÇÿØŸÖ ÿ®ÿ´ÿ®ÿßÿ™!`,
                    `ŸÖŸÖÿ™ÿßÿ≤! ${studentName} ÿπŸÑŸâ ÿßŸÑÿ∑ÿ±ŸäŸÇ ÿßŸÑÿµÿ≠Ÿäÿ≠!`
                ] : [
                    `ÿ¨ŸäÿØ ÿ¨ÿØÿßŸã! ${studentName} ŸäŸÉŸÖŸÑ ÿßŸÑŸÖŸáŸÖÿ© ÿ®ŸÜÿ¨ÿßÿ≠!`,
                    `ŸÖÿ´ÿßÿ®ÿ±ÿ© ÿ±ÿßÿ¶ÿπÿ©! ${studentName} Ÿäÿ≥ÿ™ŸÖÿ± ŸÅŸä ÿßŸÑÿ™ŸÇÿØŸÖ!`,
                    `ÿ•ŸÜÿ¨ÿßÿ≤ ŸÖÿ¥ÿ±ŸÅ! ${studentName} Ÿäÿ®ÿ∞ŸÑ ÿ¨ŸáÿØÿßŸã ŸÉÿ®Ÿäÿ±ÿßŸã!`
                ];
                
                const randomFireQuote = fireQuotes[Math.floor(Math.random() * fireQuotes.length)];
                const randomScoreQuote = scoreQuotes[Math.floor(Math.random() * scoreQuotes.length)];
                
                this.motivationTitle.textContent = randomFireQuote;
                this.motivationSubtitle.textContent = `ŸÑŸÇÿØ ÿ£ÿ™ŸÖŸÖÿ™ ÿ™ÿπŸÑŸÖ ÿßŸÑÿ≠ÿ±ŸÅ ${letter} ÿ®ŸÜÿ¨ÿßÿ≠ - ${randomScoreQuote}`;
                
                const quotes = [
                    "ŸÖŸÜ ÿ¨ÿØ Ÿàÿ¨ÿØÿå ŸàŸÖŸÜ ÿ≤ÿ±ÿπ ÿ≠ÿµÿØ. ÿßÿ≥ÿ™ŸÖÿ± ŸÅŸä ÿßŸÑÿ™ŸÇÿØŸÖ!",
                    "ÿßŸÑÿπŸÑŸÖ ŸÜŸàÿ±ÿå ŸàÿßŸÑÿ¨ŸáŸÑ ÿ∏ŸÑÿßŸÖ. ÿ£ŸÜÿ™ ÿ™ŸÜŸäÿ± ÿπŸÇŸÑŸÉ ÿ®ÿßŸÑŸÖÿπÿ±ŸÅÿ©!",
                    "ŸÉŸÑ ÿ≠ÿ±ŸÅ ÿ™ÿ™ÿπŸÑŸÖŸá ŸáŸà ÿÆÿ∑Ÿàÿ© ÿ¨ÿØŸäÿØÿ© ŸÜÿ≠Ÿà ÿ•ÿ™ŸÇÿßŸÜ ÿßŸÑŸÑÿ∫ÿ© ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿäÿ©!",
                    "ÿ£ŸÜÿ™ ŸÖÿ®ÿØÿπ! ÿßÿ≥ÿ™ŸÖÿ± ŸÅŸä ÿßŸÑÿ™ÿπŸÑŸÖ Ÿàÿ≥ŸàŸÅ ÿ™ÿµŸÑ ÿ•ŸÑŸâ ÿßŸÑŸÇŸÖÿ©!",
                    "ÿßŸÑÿ•ÿµÿ±ÿßÿ± ŸàÿßŸÑÿπÿ≤ŸäŸÖÿ© ŸáŸÖÿß ÿ≥ÿ± ÿßŸÑŸÜÿ¨ÿßÿ≠. ÿ£ŸÜÿ™ ÿπŸÑŸâ ÿßŸÑÿ∑ÿ±ŸäŸÇ ÿßŸÑÿµÿ≠Ÿäÿ≠!",
                    "ÿ™ÿπŸÑŸÖ ÿßŸÑŸÑÿ∫ÿ© ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿäÿ© ŸäŸÅÿ™ÿ≠ ŸÑŸÉ ÿ£ÿ®Ÿàÿßÿ® ÿßŸÑÿπÿßŸÑŸÖ. ÿßÿ≥ÿ™ŸÖÿ± ŸÅŸä ÿßŸÑÿ™ŸÇÿØŸÖ!",
                    "ÿßŸÑŸÜÿ¨ÿßÿ≠ ŸáŸà ŸÖÿ¨ŸÖŸàÿπ ÿßŸÑÿ¨ŸáŸàÿØ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ÿßŸÑŸÖÿ™ŸÉÿ±ÿ±ÿ© ŸäŸàŸÖŸäÿßŸã. ÿ£ŸÜÿ™ ÿ™ŸÅÿπŸÑŸáÿß ÿ®ÿ¥ŸÉŸÑ ÿ±ÿßÿ¶ÿπ!",
                    "ŸÉŸÑŸÖÿß ÿ™ÿπŸÑŸÖÿ™ ÿ£ŸÉÿ´ÿ±ÿå ŸÉŸÑŸÖÿß ÿ£ÿµÿ®ÿ≠ÿ™ ÿ£ŸÉÿ´ÿ± ÿ´ŸÇÿ©. ÿ£ŸÜÿ™ ÿ±ÿßÿ¶ÿπ!"
                ];
                
                const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
                this.motivationQuote.textContent = randomQuote;
                
                this.motivationModal.style.display = 'flex';
                this.soundManager.playSound('success');
            }
            
            nextLetter() {
                this.motivationModal.style.display = 'none';
                
                const nextIndex = this.currentLetterIndex + 1;
                if (nextIndex < LETTERS.length) {
                    this.loadLetter(nextIndex);
                } else {
                    this.showCertificate();
                }
            }
            
            startGame(gameType) {
                this.motivationModal.style.display = 'none';
                this.gameModal.style.display = 'flex';
                this.currentGame = gameType;
                this.gameTimeLeft = 60;
                this.gameTimerEl.textContent = this.gameTimeLeft;
                this.gameScoreEl.textContent = '0';
                
                // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™
                this.gameStats = {
                    successCount: 0,
                    totalAttempts: 0,
                    accuracy: 0,
                    difficulty: Math.floor(this.currentLetterIndex / 5) + 1,
                    gameWins: 0
                };
                
                this.updateGameStats();
                
                // ÿ•ÿπÿØÿßÿØ ÿπŸÜÿßÿµÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ
                this.setupGameControls();
                
                // ÿ≥Ÿäÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ£ŸÑÿπÿßÿ® ŸáŸÜÿß ÿ≠ÿ≥ÿ® ÿßŸÑÿ≠ÿßÿ¨ÿ©
                this.initDefaultGame(gameType);
                
                this.gameInterval = setInterval(() => {
                    if (!this.isPaused) {
                        this.gameTimeLeft--;
                        this.gameTimerEl.textContent = this.gameTimeLeft;
                        
                        if (this.gameTimeLeft <= 0) {
                            this.endGame();
                        }
                    }
                }, 1000);
            }
            
            setupGameControls() {
                // ÿ•ÿÆŸÅÿßÿ° ÿ£Ÿà ÿ•ÿ∏Ÿáÿßÿ± ÿπŸÜÿßÿµÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑŸÑŸÖÿ≥Ÿäÿ© ÿ≠ÿ≥ÿ® ÿßŸÑÿ≠ÿßÿ¨ÿ©
                if (this.currentGame === 'carRace' || this.currentGame === 'racket') {
                    this.touchControlsEl.style.display = 'flex';
                } else {
                    this.touchControlsEl.style.display = 'none';
                }
            }
            
            updateGameStats() {
                this.successCountEl.textContent = this.gameStats.successCount;
                this.difficultyLevelEl.textContent = this.gameStats.difficulty;
                
                if (this.gameStats.totalAttempts > 0) {
                    this.gameStats.accuracy = Math.round((this.gameStats.successCount / this.gameStats.totalAttempts) * 100);
                } else {
                    this.gameStats.accuracy = 0;
                }
                
                this.accuracyEl.textContent = `${this.gameStats.accuracy}%`;
            }
            
            initDefaultGame(gameType) {
                const canvas = this.gameCanvas;
                const ctx = canvas.getContext('2d');
                
                const container = canvas.parentElement;
                canvas.width = container.clientWidth;
                canvas.height = container.clientHeight;
                
                this.gameTitle.textContent = 'üéÆ ŸÑÿπÿ®ÿ© ÿ™ÿπŸÑŸäŸÖŸäÿ©';
                this.gameInstructions.textContent = 'Ÿáÿ∞Ÿá ŸÑÿπÿ®ÿ© ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©. ÿ≥Ÿäÿ™ŸÖ ÿ™ÿ∑ŸàŸäÿ±Ÿáÿß ŸÅŸä ÿßŸÑŸÖÿ≥ÿ™ŸÇÿ®ŸÑ. ÿßÿ≥ÿ™ŸÖÿ™ÿπ!';
                
                // ÿ±ÿ≥ŸÖ ÿ¥ÿßÿ¥ÿ© ÿßŸÑŸÑÿπÿ®ÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©
                ctx.fillStyle = '#4361ee';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = 'white';
                ctx.font = 'bold 24px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(`ŸÑÿπÿ®ÿ© ${gameType}`, canvas.width / 2, canvas.height / 2 - 30);
                
                ctx.font = '18px Arial';
                ctx.fillText('ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ∑ŸàŸäÿ±...', canvas.width / 2, canvas.height / 2 + 30);
            }
            
            endGame() {
                clearInterval(this.gameInterval);
                if (this.currentGameIntervals) {
                    this.currentGameIntervals.forEach(clearInterval);
                }
                
                if (this.currentGameKeyHandlers) {
                    document.removeEventListener('keydown', this.currentGameKeyHandlers.keydown);
                    document.removeEventListener('keyup', this.currentGameKeyHandlers.keyup);
                }
                
                const canvas = this.gameCanvas;
                const ctx = canvas.getContext('2d');
                
                if (this.currentGameKeyHandler) {
                    document.removeEventListener('keydown', this.currentGameKeyHandler);
                    this.currentGameKeyHandler = null;
                }
                
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
                gradient.addColorStop(0, '#4cc9f0');
                gradient.addColorStop(1, '#4895ef');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = 'white';
                ctx.font = 'bold 36px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('ÿßŸÜÿ™ŸáŸâ ÿßŸÑŸàŸÇÿ™!', canvas.width / 2, canvas.height / 2 - 30);
                ctx.font = '24px Arial';
                ctx.fillText(`ÿßŸÑŸÜŸÇÿßÿ∑ ÿßŸÑŸÜŸáÿßÿ¶Ÿäÿ©: ${this.gameScoreEl.textContent}`, canvas.width / 2, canvas.height / 2 + 30);
                
                const finalScore = parseInt(this.gameScoreEl.textContent);
                let message = 'ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ!';
                if (finalScore >= 50) message = 'ŸÖÿ∞ŸáŸÑ! ÿ£ÿØÿßÿ° ÿ±ÿßÿ¶ÿπ!';
                else if (finalScore >= 30) message = 'ÿ¨ŸäÿØ ÿ¨ÿØÿßŸã!';
                else if (finalScore >= 15) message = 'ŸÑŸäÿ≥ ÿ≥Ÿäÿ¶ÿßŸã!';
                
                ctx.font = '20px Arial';
                ctx.fillText(message, canvas.width / 2, canvas.height / 2 + 70);
                
                this.soundManager.playSound('success');
            }
            
            closeGame() {
                this.gameModal.style.display = 'none';
                clearInterval(this.gameInterval);
                
                if (this.currentGameIntervals) {
                    this.currentGameIntervals.forEach(clearInterval);
                }
                
                if (this.currentGameKeyHandlers) {
                    document.removeEventListener('keydown', this.currentGameKeyHandlers.keydown);
                    document.removeEventListener('keyup', this.currentGameKeyHandlers.keyup);
                }
                
                if (this.currentGameKeyHandler) {
                    document.removeEventListener('keydown', this.currentGameKeyHandler);
                    this.currentGameKeyHandler = null;
                }
                
                const canvas = this.gameCanvas;
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                this.isPaused = false;
                this.pauseGameBtn.innerHTML = '<span>‚è∏Ô∏è</span> ÿ•ŸäŸÇÿßŸÅ';
            }
            
            togglePause() {
                this.isPaused = !this.isPaused;
                this.pauseGameBtn.innerHTML = this.isPaused ? 
                    '<span>‚ñ∂Ô∏è</span> ÿßÿ≥ÿ™ŸÖÿ±ÿßÿ±' : 
                    '<span>‚è∏Ô∏è</span> ÿ•ŸäŸÇÿßŸÅ';
            }
            
            restartGame() {
                this.closeGame();
                setTimeout(() => {
                    this.startGame(this.currentGame);
                }, 100);
            }
            
            playAgain() {
                this.winModal.style.display = 'none';
                this.restartGame();
            }
            
            backToGames() {
                this.winModal.style.display = 'none';
                this.closeGame();
                this.motivationModal.style.display = 'flex';
            }
            
            showCertificate() {
                const studentName = this.studentName || 'ÿßŸÑÿ∑ÿßŸÑÿ® ÿßŸÑŸÖÿ™ŸÖŸäÿ≤';
                const currentDate = new Date().toLocaleDateString('ar-EG', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                this.certificateName.textContent = studentName;
                this.certificateDate.textContent = `ÿ™ŸÖ ŸÖŸÜÿ≠ Ÿáÿ∞Ÿá ÿßŸÑÿ¥ŸáÿßÿØÿ© ŸÅŸä: ${currentDate}`;
                
                this.certificateModal.style.display = 'flex';
                this.soundManager.playSound('success');
            }
            
            printCertificate() {
                const printContent = this.certificateModal.innerHTML;
                const originalContent = document.body.innerHTML;
                
                document.body.innerHTML = printContent;
                window.print();
                document.body.innerHTML = originalContent;
                
                this.bindEvents();
            }
            
            showCompletionAnimation() {
                for (let i = 0; i < 150; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    confetti.style.animationDelay = Math.random() * 5 + 's';
                    confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 70%, 60%)`;
                    
                    this.completionAnimation.appendChild(confetti);
                }
                
                setTimeout(() => {
                    this.completionAnimation.innerHTML = '';
                }, 7000);
            }
            
            setupScrollTop() {
                window.addEventListener('scroll', () => {
                    if (window.pageYOffset > 300) {
                        this.scrollTopBtn.classList.add('visible');
                    } else {
                        this.scrollTopBtn.classList.remove('visible');
                    }
                });
                
                this.scrollTopBtn.addEventListener('click', () => {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            }
        }

        // ÿ®ÿØÿ° ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿπŸÜÿØ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ©
        document.addEventListener('DOMContentLoaded', () => {
            new PhonicsGameLab();
        });
    </script>
</body>
</html>