{% load static %}
<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 4 Unit 1 | Outdoor Fun ğŸï¸</title>
    <!-- Premium Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    
    <style>
        :root {
            --primary: #10b981;
            --primary-dark: #059669;
            --secondary: #3b82f6;
            --accent: #f59e0b;
            --bg: #ecfdf5;
            --glass: rgba(255, 255, 255, 0.95);
            --shadow: 0 10px 30px -10px rgba(16, 185, 129, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Outfit', 'Tajawal', sans-serif;
            background-color: var(--bg);
            background-image: url('https://images.unsplash.com/photo-1500382017468-9049fed747ef?auto=format&fit=crop&q=60&w=2000');
            background-attachment: fixed;
            background-size: cover;
            color: #1f2937;
            min-height: 100vh;
            padding-bottom: 80px;
        }

        .overlay {
            position: fixed; inset: 0; background: rgba(255,255,255,0.85); backdrop-filter: blur(5px); z-index: -1;
        }

        /* --- UI COMPONENTS --- */
        .glass-panel {
            background: var(--glass);
            border: 1px solid rgba(255,255,255,1);
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.05);
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            color: var(--primary-dark);
            margin-bottom: 40px;
            font-weight: 800;
            text-shadow: 2px 2px 0 white;
        }

        /* --- NAVIGATION --- */
        .nav-dock {
            position: sticky;
            top: 20px;
            z-index: 100;
            margin: -40px auto 40px;
            max-width: 900px;
            padding: 10px;
        }

        .nav-items {
            display: flex;
            justify-content: center;
            gap: 15px;
            background: white;
            padding: 10px 20px;
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            flex-wrap: wrap;
        }

        .nav-btn {
            border: none;
            background: transparent;
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: 700;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        /* --- VOCABULARY --- */
        .vocab-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
        }

        .vocab-card {
            background: white;
            border-radius: 24px;
            overflow: hidden;
            transition: all 0.4s;
            position: relative;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
        }

        .vocab-card:hover { transform: translateY(-10px) scale(1.02); z-index: 10; }

        .card-img {
            width: 100%;
            height: 220px;
            object-fit: cover;
        }

        .card-body { padding: 20px; text-align: center; }
        .word-en { font-size: 1.8rem; font-weight: 800; color: #111827; }
        .word-ar { font-size: 1.2rem; font-family: 'Tajawal'; color: #6b7280; margin-bottom: 15px; }

        .btn-audio {
            width: 50px; height: 50px;
            border-radius: 50%;
            border: none;
            background: #e0f2fe;
            color: #0ea5e9;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-audio:hover { background: #0ea5e9; color: white; transform: scale(1.1); }

        /* --- GRAMMAR TABLE --- */
        .grammar-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            margin-bottom: 40px;
            direction: ltr; /* Ensure English direction */
        }

        .grammar-table th {
            padding: 15px;
            text-align: left;
            color: white;
            font-size: 1.2rem;
        }

        .th-to { background: #059669; }
        .th-ing { background: #059669; }
        
        .grammar-table td {
            padding: 15px;
            border-bottom: 1px solid #f3f4f6;
            vertical-align: top;
        }

        .example-block { margin-bottom: 15px; }
        .ex-en { font-weight: 600; font-size: 1.1rem; color: #1f2937; }
        .ex-ar { font-family: 'Tajawal'; color: #6b7280; font-size: 0.95rem; margin-top: 4px; display: block;}
        .highlight-to { color: #059669; font-weight: 800; }
        .highlight-ing { color: #2563eb; font-weight: 800; }

        /* --- QUIZ --- */
        .quiz-container {
            max-width: 700px;
            margin: 0 auto;
            background: white;
            border-radius: 30px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
        }

        .quiz-question { font-size: 1.8rem; font-weight: 800; margin-bottom: 30px; color: #1e293b; }
        
        .quiz-options { display: grid; gap: 15px; }
        
        .quiz-btn {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            padding: 20px;
            border-radius: 16px;
            font-size: 1.3rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            position: relative;
        }

        .quiz-btn:hover { border-color: var(--primary); background: #f0fdf4; }
        
        .quiz-btn.correct { background: #dcfce7; border-color: #22c55e; color: #166534; }
        .quiz-btn.wrong { background: #fee2e2; border-color: #ef4444; color: #991b1b; }

        /* --- STORY SECTION --- */
        .story-container { max-width: 900px; margin: 0 auto; background: white; padding: 40px; border-radius: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.05); }
        .story-header { text-align: center; margin-bottom: 40px; }
        .story-title { font-size: 2.5rem; color: #d97706; font-weight: 900; margin-bottom: 10px; }
        .story-block { margin-bottom: 30px; padding-bottom: 30px; border-bottom: 1px dashed #e5e7eb; }
        .story-text { font-size: 1.4rem; line-height: 1.8; color: #1f2937; margin-bottom: 15px; }
        .story-trans { font-family: 'Tajawal'; color: #6b7280; font-size: 1.1rem; border-right: 4px solid var(--accent); padding-right: 15px; background: #fffbeb; padding: 10px; border-radius: 8px; display:none;}
        .highlight-word { color: #000; font-weight: 800; background: #fde047; padding: 0 4px; border-radius: 4px; cursor: help; position: relative; }
        .highlight-word:hover::after {
            content: attr(data-synonym);
            position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%);
            background: #1f2937; color: white; padding: 5px 10px; border-radius: 6px; font-size: 0.9rem; white-space: nowrap; pointer-events: none;
        }
        .btn-trans { font-size: 0.9rem; color: #d97706; background: none; border: none; cursor: pointer; text-decoration: underline; margin-top: 5px; }
        
        .social-card { background: #f0fdf4; border: 2px solid #22c55e; border-radius: 20px; padding: 30px; margin-top: 40px; }
        .social-q { font-weight: bold; font-size: 1.2rem; color: #15803d; margin-bottom: 15px; }

        .quiz-btn-small {
            padding: 8px 15px;
            margin-right: 10px;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }
        .quiz-btn-small:hover { border-color: #f59e0b; background: #fffbeb; }
        .quiz-btn-small:hover { border-color: #f59e0b; background: #fffbeb; }

        /* --- LESSON 5: VOCABULARY --- */
        .flash-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 50px; }
        .flash-card { perspective: 1000px; height: 320px; cursor: pointer; }
        .flash-inner { position: relative; width: 100%; height: 100%; transition: transform 0.8s; transform-style: preserve-3d; }
        .flash-card.flipped .flash-inner { transform: rotateY(180deg); }
        .flash-front, .flash-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; background: white; border: 2px solid #e5e7eb; }
        .flash-back { transform: rotateY(180deg); background: #f0fdf4; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; text-align: center; }
        
        .flash-img { width: 100%; height: 180px; object-fit: cover; border-bottom: 2px solid #f3f4f6; }
        .flash-content { padding: 15px; text-align: center; }
        .flash-word { font-size: 1.5rem; font-weight: 800; color: #1f2937; margin-bottom: 5px; }
        .flash-phonics { color: #6b7280; font-family: monospace; font-size: 0.9rem; }
        
        .mic-btn { width: 60px; height: 60px; border-radius: 50%; background: #f3f4f6; color: #4b5563; border: none; font-size: 1.5rem; cursor: pointer; transition: all 0.3s; margin-top: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .mic-btn:hover { background: #e0f2fe; color: #0284c7; transform: scale(1.1); }
        .mic-btn.listening { background: #fee2e2; color: #dc2626; animation: pulse 1.5s infinite; }
        
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.4); } 70% { box-shadow: 0 0 0 15px rgba(220, 38, 38, 0); } 100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0); } }

        .fill-box { border: 2px solid #94a3b8; padding: 5px 10px; border-radius: 8px; font-weight: bold; width: auto; min-width:100px; text-align: center; font-size: 1.1rem; transition: all 0.3s; background: #fff; cursor: pointer; }
        .fill-box:hover { border-color: var(--primary); background: #f0fdf4; }
        .fill-box:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.2); }
        .fill-box.correct { border-color: #22c55e; background: #dcfce7; color: #15803d; }
        .fill-box.wrong { border-color: #ef4444; background: #fee2e2; color: #991b1b; }

        /* --- LESSON 6: GRAMMAR --- */
        .grammar-card { background: white; border-radius: 20px; padding: 25px; margin-bottom: 30px; border: 1px solid #e2e8f0; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .grammar-title { font-size: 1.8rem; color: #7c3aed; margin-bottom: 20px; font-weight: 800; display: flex; align-items: center; gap: 10px; }
        .grammar-toggle { display: inline-flex; background: #f1f5f9; border-radius: 50px; padding: 5px; cursor: pointer; transition: all 0.3s; gap: 5px; }
        .grammar-option { padding: 10px 20px; border-radius: 40px; font-weight: bold; transition: all 0.3s; color: #64748b; }
        .grammar-option.active { background: #7c3aed; color: white; box-shadow: 0 5px 15px rgba(124, 58, 237, 0.3); }
        .camp-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 30px; }
        .camp-card { position: relative; border-radius: 20px; overflow: hidden; height: 200px; cursor: pointer; border: 4px solid transparent; transition: all 0.3s; }
        .camp-card:hover { transform: scale(1.02); }
        .camp-card.correct { border-color: #22c55e; }
        .camp-card.wrong { border-color: #ef4444; }
        .camp-img { width: 100%; height: 100%; object-fit: cover; }
        .camp-overlay { position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.6); color: white; padding: 15px; font-weight: bold; text-align: center; }

        /* --- LESSON 7: SOCIAL STUDIES --- */
        .reading-box { background: #fff; padding: 40px; border-radius: 25px; border-left: 8px solid #0ea5e9; box-shadow: 0 10px 30px rgba(0,0,0,0.05); line-height: 2; font-size: 1.2rem; margin-bottom: 40px; position:relative; }
        .highlight-blue { background: #e0f2fe; color: #0284c7; padding: 2px 5px; border-radius: 4px; font-weight: bold; cursor: help; }
        .tf-btn { width: 100%; padding: 15px; border-radius: 12px; border: 2px solid #e2e8f0; background: white; font-weight: bold; margin-bottom: 10px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: all 0.2s; text-align:left; }
        .tf-btn:hover { background: #f8fafc; border-color: #cbd5e1; }
        .tf-btn.correct { background: #dcfce7; border-color: #22c55e; color: #15803d; }
        .tf-btn.wrong { background: #fee2e2; border-color: #ef4444; color: #991b1b; }
        .q-text { display:block; font-size:1.1rem; color:#334155; margin-bottom:4px; line-height:1.4; }
        .ar-text { display:block; font-family:'Tajawal'; color:#15803d; font-size:1rem; font-weight:normal; }

    </style>
</head>
<body>

    <div class="overlay"></div>

    <!-- BACK BUTTON -->
    <a href="/" style="position:fixed; top:20px; left:20px; background:white; padding:12px; border-radius:50%; box-shadow:0 5px 15px rgba(0,0,0,0.1); z-index:200; color:#374151; transition:all 0.3s; text-decoration:none;">
        <i class="fas fa-home"></i>
    </a>

    <!-- Navigation Dropdown -->
    <div style="position:fixed; top:20px; right:20px; z-index:200;">
        <button onclick="togglePageNav()" style="background:white; padding:10px 20px; border-radius:30px; box-shadow:0 5px 15px rgba(0,0,0,0.1); border:none; cursor:pointer; display:flex; align-items:center; gap:10px; font-weight:bold; font-family:'Tajawal'; color:#374151; transition:all 0.3s;">
            <span>Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</span>
            <i class="fas fa-chevron-down"></i>
        </button>
        <div id="pageNavDropdown" style="display:none; position:absolute; top:110%; right:0; background:white; min-width:220px; border-radius:15px; box-shadow:0 10px 30px rgba(0,0,0,0.15); overflow:hidden; animation: fadeIn 0.3s;">
            <a href="/top-goal-6-unit-1/" style="display:flex; align-items:center; gap:10px; padding:15px; text-decoration:none; color:#1f2937; border-bottom:1px solid #f3f4f6; transition:bg 0.2s;">
                <i class="fas fa-film" style="color:#f43f5e; width:20px; text-align:center;"></i>
                <div style="display:flex; flex-direction:column;">
                    <span style="font-weight:bold;">Top Goal 6</span>
                    <span style="font-size:0.8rem; color:#6b7280;">Ø§Ù„ÙˆØ­Ø¯Ø© 1</span>
                </div>
            </a>
            <a href="/grade-4-unit-1/" style="display:flex; align-items:center; gap:10px; padding:15px; text-decoration:none; color:#1f2937; transition:bg 0.2s;">
                <i class="fas fa-tree" style="color:#10b981; width:20px; text-align:center;"></i>
                <div style="display:flex; flex-direction:column;">
                    <span style="font-weight:bold;">Ø±Ø§Ø¨Ø¹ Ø§Ù„ÙˆØ­Ø¯Ù‡ Ø§Ù„Ø§ÙˆÙ„Ù‰</span>
                    <span style="font-size:0.8rem; color:#6b7280;">Outdoor Fun</span>
                </div>
            </a>
        </div>
    </div>

    <script>
        function togglePageNav() {
            const dropdown = document.getElementById('pageNavDropdown');
            dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
        }
        
        // Close when clicking outside
        document.addEventListener('click', (e) => {
            const container = document.querySelector('[onclick="togglePageNav()"]').parentNode;
            if (!container.contains(e.target)) {
                document.getElementById('pageNavDropdown').style.display = 'none';
            }
        });
    </script>

    <!-- HEADER -->
     <header style="text-align:center; padding: 60px 20px 40px;">
        <h1 style="font-size:4rem; font-weight:900; color:#064e3b; margin-bottom:10px; text-shadow:0 5px 10px rgba(0,0,0,0.1);">Outdoor Fun</h1>
        <p style="font-size:1.5rem; color:#047857; font-family:'Tajawal', sans-serif;">Ø§Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹ - Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰</p>
    </header>

    <!-- NAV -->
    <div class="nav-dock">
        <div class="nav-items">
            <button class="nav-btn active" onclick="showSection('learn')">
                <i class="fas fa-book-open"></i> Learn
            </button>
            <button class="nav-btn" onclick="showSection('grammar')">
                <i class="fas fa-puzzle-piece"></i> Grammar
            </button>
            <button class="nav-btn" onclick="showSection('quiz')">
                <i class="fas fa-star"></i> Quiz
            </button>
            <button class="nav-btn" onclick="showSection('story')">
                <i class="fas fa-book-reader"></i> Story
            </button>
            <button class="nav-btn" onclick="showSection('vocab5')">
                <i class="fas fa-shapes"></i> Vocab & Games
            </button>
            <button class="nav-btn" onclick="showSection('grammar6')">
                <i class="fas fa-spell-check"></i> Grammar L6
            </button>
            <button class="nav-btn" onclick="showSection('social7')">
                <i class="fas fa-globe-americas"></i> Social Studies
            </button>
            <button class="nav-btn" onclick="showSection('writing')">
                <i class="fas fa-pen-fancy"></i> Writing
            </button>
        </div>
    </div>

    <main style="max-width:1200px; margin:0 auto; padding:0 20px;">
        
        <!-- SECTION 1: LEARN -->
        <div id="learn" class="section active animate__animated animate__fadeIn">
            <h2 class="section-title">Vocabulary Words ğŸ“–</h2>
            <div style="text-align:center; margin-bottom:30px; display:flex; gap:15px; justify-content:center; flex-wrap:wrap;">
                <button onclick="openTest('learn', 'pre')" style="background:linear-gradient(135deg, #3b82f6, #2563eb); color:white; border:none; padding:15px 35px; border-radius:50px; font-size:1.3rem; cursor:pointer; font-weight:600; box-shadow:0 5px 15px rgba(59,130,246,0.3);">
                    ğŸ“‹ Pre-Test / Ø§Ø®ØªØ¨Ø§Ø± Ù‚Ø¨Ù„ÙŠ
                </button>
                <button onclick="openTest('learn', 'post')" style="background:linear-gradient(135deg, #10b981, #059669); color:white; border:none; padding:15px 35px; border-radius:50px; font-size:1.3rem; cursor:pointer; font-weight:600; box-shadow:0 5px 15px rgba(16,185,129,0.3);">
                    âœ… Post-Test / Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø¹Ø¯ÙŠ
                </button>
            </div>
            <div class="vocab-grid" id="vocab-grid"></div>
        </div>

        <!-- SECTION 2: GRAMMAR -->
        <div id="grammar" class="section" style="display:none;">
            <h2 class="section-title">Grammar Rules âš¡</h2>
            <div style="text-align:center; margin-bottom:30px; display:flex; gap:15px; justify-content:center; flex-wrap:wrap;">
                <button onclick="openTest('grammar', 'pre')" style="background:linear-gradient(135deg, #3b82f6, #2563eb); color:white; border:none; padding:15px 35px; border-radius:50px; font-size:1.3rem; cursor:pointer; font-weight:600;">ğŸ“‹ Pre-Test / Ø§Ø®ØªØ¨Ø§Ø± Ù‚Ø¨Ù„ÙŠ</button>
                <button onclick="openTest('grammar', 'post')" style="background:linear-gradient(135deg, #10b981, #059669); color:white; border:none; padding:15px 35px; border-radius:50px; font-size:1.3rem; cursor:pointer; font-weight:600;">âœ… Post-Test / Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø¹Ø¯ÙŠ</button>
            </div>
            
            <!-- Reference Chart -->
            <div style="max-width:900px; margin:0 auto; overflow-x: auto;">
                <table class="grammar-table">
                    <thead>
                        <tr>
                            <th colspan="2" class="th-to" style="text-align:center;">Verb + to infinitive (Ø£ÙØ¹Ø§Ù„ ÙŠØªØ¨Ø¹Ù‡Ø§ to)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <div class="example-block">
                                    <div class="ex-en">She <span class="highlight-to">wanted to spend</span> the day in the countryside.</div>
                                    <span class="ex-ar">Ù‡ÙŠ Ø£Ø±Ø§Ø¯Øª Ø£Ù† ØªÙ‚Ø¶ÙŠ Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ø±ÙŠÙ.</span>
                                </div>
                                <div class="example-block">
                                    <div class="ex-en">We <span class="highlight-to">forgot to bring</span> our swimsuits.</div>
                                    <span class="ex-ar">Ù†Ø­Ù† Ù†Ø³ÙŠÙ†Ø§ Ø£Ù† Ù†Ø­Ø¶Ø± Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ø³Ø¨Ø§Ø­Ø©.</span>
                                </div>
                            </td>
                            <td>
                                <div class="example-block">
                                    <div class="ex-en">She <span class="highlight-to">didn't want to spend</span>...</div>
                                    <span class="ex-ar">Ù‡ÙŠ Ù„Ù… ØªØ±Ø¯ Ø£Ù† ØªÙ‚Ø¶ÙŠ... (Ù†ÙÙŠ)</span>
                                </div>
                                <div class="example-block">
                                    <div class="ex-en">We <span class="highlight-to">didn't forget to bring</span>...</div>
                                    <span class="ex-ar">Ù†Ø­Ù† Ù„Ù… Ù†Ù†Ø³Ù Ø£Ù† Ù†Ø­Ø¶Ø±... (Ù†ÙÙŠ)</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <table class="grammar-table">
                    <thead>
                        <tr>
                            <th colspan="2" class="th-ing" style="text-align:center; background:#2563eb;">Verb + -ing (Ø£ÙØ¹Ø§Ù„ ÙŠØªØ¨Ø¹Ù‡Ø§ ing)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <div class="example-block">
                                    <div class="ex-en">I <span class="highlight-ing">love hiking</span> in the hills.</div>
                                    <span class="ex-ar">Ø£Ù†Ø§ Ø£Ø­Ø¨ Ø§Ù„Ù…Ø´ÙŠ ÙÙŠ Ø§Ù„ØªÙ„Ø§Ù„.</span>
                                </div>
                                <div class="example-block">
                                    <div class="ex-en">They <span class="highlight-ing">like swimming</span> in the lake.</div>
                                    <span class="ex-ar">Ù‡Ù… ÙŠØ­Ø¨ÙˆÙ† Ø§Ù„Ø³Ø¨Ø§Ø­Ø© ÙÙŠ Ø§Ù„Ø¨Ø­ÙŠØ±Ø©.</span>
                                </div>
                            </td>
                            <td>
                                <div class="example-block">
                                    <div class="ex-en">I <span class="highlight-ing">don't love hiking</span> ...</div>
                                    <span class="ex-ar">Ø£Ù†Ø§ Ù„Ø§ Ø£Ø­Ø¨ Ø§Ù„Ù…Ø´ÙŠ... (Ù†ÙÙŠ)</span>
                                </div>
                                <div class="example-block">
                                    <div class="ex-en">They <span class="highlight-ing">don't like swimming</span> ...</div>
                                    <span class="ex-ar">Ù‡Ù… Ù„Ø§ ÙŠØ­Ø¨ÙˆÙ† Ø§Ù„Ø³Ø¨Ø§Ø­Ø©... (Ù†ÙÙŠ)</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Mini Game Wrapper -->
            <div style="text-align:center; margin-top:50px;">
                <h3 style="font-size:2rem; margin-bottom:20px; color:#1f2937;">Try it now! ğŸ‘‡</h3>
                <div style="background:white; padding:40px; border-radius:30px; display:inline-block; box-shadow:0 10px 30px rgba(0,0,0,0.1);">
                    <div id="grammar-question" style="font-size:1.8rem; font-weight:bold; margin-bottom:30px;">
                        I decided ________ to the park.
                    </div>
                    <div style="display:flex; gap:20px; justify-content:center;">
                        <button onclick="checkGrammar(this, 'to go')" style="padding:15px 30px; font-size:1.2rem; border-radius:15px; border:2px solid #e5e7eb; cursor:pointer; background:white;">to go</button>
                        <button onclick="checkGrammar(this, 'going')" style="padding:15px 30px; font-size:1.2rem; border-radius:15px; border:2px solid #e5e7eb; cursor:pointer; background:white;">going</button>
                    </div>
                    <div id="grammar-feedback" style="margin-top:20px; font-weight:bold; height:30px;"></div>
                </div>
            </div>
        </div>

        <!-- SECTION 3: QUIZ -->
        <div id="quiz" class="section" style="display:none;">
            <div class="quiz-container">
                <div id="quiz-screen">
                    <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                        <span style="font-weight:bold; color:#64748b;">Question <span id="q-num">1</span>/5</span>
                        <span style="font-weight:bold; color:#10b981;">Score: <span id="q-score">0</span></span>
                    </div>
                    <div class="quiz-question" id="q-text">Loading...</div>
                    <div class="quiz-options" id="q-options"></div>
                </div>
                <div id="result-screen" style="display:none;">
                    <i class="fas fa-trophy" style="font-size:5rem; color:#fbbf24; margin-bottom:20px;"></i>
                    <h2 style="font-size:2.5rem; margin-bottom:10px;">Quiz Completed!</h2>
                    <p style="font-size:1.5rem; color:#64748b; margin-bottom:30px;">Your Score: <span id="final-score" style="color:#10b981; font-weight:bold;"></span></p>
                    <button onclick="startQuiz()" style="background:var(--primary); color:white; border:none; padding:15px 40px; border-radius:50px; font-size:1.2rem; font-weight:bold; cursor:pointer; box-shadow:0 10px 20px rgba(16,185,129,0.3);">Play Again ğŸ”„</button>
                </div>
            </div>
        </div>

        <!-- SECTION 4: STORY (LESSON 3) -->
        <div id="story" class="section" style="display:none;">
            <div class="story-container">
                <div class="story-header animate__animated animate__fadeInDown">
                    <div style="font-size:1.2rem; color:#d97706; font-weight:bold; margin-bottom:5px;">Lesson 3</div>
                    <h2 class="story-title">ğŸš© The Flag Hunt</h2>
                    <p style="font-family:'Tajawal'; color:#9ca3af;">Ø¨Ø­Ø« Ø§Ù„Ø£Ø¹Ù„Ø§Ù…</p>
                </div>

                <!-- Part 1 -->
                <div class="story-block">
                    <div style="display:flex; justify-content:space-between; align-items:flex-start;">
                        <button class="btn-audio" onclick="speak(document.getElementById('txt-1').innerText)" style="flex-shrink:0; margin-right:15px;"><i class="fas fa-volume-up"></i></button>
                        <div style="flex-grow:1;">
                            <div id="txt-1" class="story-text">
                                The children were going to have a <span class="highlight-word" data-synonym="Searching game">flag hunt</span> in the <span class="highlight-word" data-synonym="Woods">forest</span>. Mrs. White was telling them the <span class="highlight-word" data-synonym="Laws/Instructions">rules</span>. "You have to find a flag at each place. And remember to <span class="highlight-word" data-synonym="Collect">pick up</span> your trash!"
                            </div>
                            <button class="btn-trans" onclick="toggleTrans('trans-1')">Show Translation ğŸ‘ï¸</button>
                            <div id="trans-1" class="story-trans">ÙƒØ§Ù† Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø°Ø§Ù‡Ø¨ÙŠÙ† Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø£Ø¹Ù„Ø§Ù… ÙÙŠ Ø§Ù„ØºØ§Ø¨Ø©. ÙƒØ§Ù†Øª Ø§Ù„Ø³ÙŠØ¯Ø© ÙˆØ§ÙŠØª ØªØ®Ø¨Ø±Ù‡Ù… Ø¨Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯. "Ø¹Ù„ÙŠÙƒÙ… Ø¥ÙŠØ¬Ø§Ø¯ Ø¹Ù„Ù… ÙÙŠ ÙƒÙ„ Ù…ÙƒØ§Ù†. ÙˆØªØ°ÙƒØ±ÙˆØ§ Ø£Ù† ØªÙ„ØªÙ‚Ø·ÙˆØ§ Ø§Ù„Ù‚Ù…Ø§Ù…Ø©!"</div>
                        </div>
                    </div>
                </div>

                <!-- Part 2 -->
                <div class="story-block">
                    <div style="display:flex; justify-content:space-between; align-items:flex-start;">
                        <button class="btn-audio" onclick="speak(document.getElementById('txt-2').innerText)" style="flex-shrink:0; margin-right:15px;"><i class="fas fa-volume-up"></i></button>
                        <div style="flex-grow:1;">
                            <div id="txt-2" class="story-text">
                                Lucy and Austin decided to go to the <span class="highlight-word" data-synonym="Water pond">lake</span> first. "Look, a flag! Let's go to the <span class="highlight-word" data-synonym="Cavern">cave</span> next," said Austin. Sarah and Jose from the blue team were walking to the <span class="highlight-word" data-synonym="Falling water">waterfall</span>. "Look! A flag," said Jose.
                            </div>
                            <button class="btn-trans" onclick="toggleTrans('trans-2')">Show Translation ğŸ‘ï¸</button>
                            <div id="trans-2" class="story-trans">Ù‚Ø±Ø±Øª Ù„ÙˆØ³ÙŠ ÙˆØ£ÙˆØ³ØªÙ† Ø§Ù„Ø°Ù‡Ø§Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø¨Ø­ÙŠØ±Ø© Ø£ÙˆÙ„Ø§Ù‹. "Ø§Ù†Ø¸Ø±ØŒ Ø¹Ù„Ù…! Ù„Ù†Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø§Ù„ÙƒÙ‡Ù ØªØ§Ù„ÙŠØ§Ù‹ØŒ" Ù‚Ø§Ù„ Ø£ÙˆØ³ØªÙ†. ÙƒØ§Ù† Ø³Ø§Ø±Ø© ÙˆØ®ÙˆØ³ÙŠÙ‡ Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚ ÙŠÙ…Ø´ÙˆÙ† Ø¥Ù„Ù‰ Ø§Ù„Ø´Ù„Ø§Ù„. "Ø§Ù†Ø¸Ø±! Ø¹Ù„Ù…ØŒ" Ù‚Ø§Ù„ Ø®ÙˆØ³ÙŠÙ‡.</div>
                        </div>
                    </div>
                </div>

                <!-- Part 3 -->
                <div class="story-block">
                    <div style="display:flex; justify-content:space-between; align-items:flex-start;">
                        <button class="btn-audio" onclick="speak(document.getElementById('txt-3').innerText)" style="flex-shrink:0; margin-right:15px;"><i class="fas fa-volume-up"></i></button>
                        <div style="flex-grow:1;">
                            <div id="txt-3" class="story-text">
                                They didn't see that Sarah's backpack was open. Sarah and Jose were climbing the <span class="highlight-word" data-synonym="Small mountain">hill</span>. Sarah saw that some <span class="highlight-word" data-synonym="Garbage/Rubbish">trash</span> from her backpack was on the ground. "Oh no," she cried. "We have to pick it up."
                            </div>
                            <button class="btn-trans" onclick="toggleTrans('trans-3')">Show Translation ğŸ‘ï¸</button>
                            <div id="trans-3" class="story-trans">Ù„Ù… ÙŠÙ„Ø§Ø­Ø¸ÙˆØ§ Ø£Ù† Ø­Ù‚ÙŠØ¨Ø© Ø¸Ù‡Ø± Ø³Ø§Ø±Ø© ÙƒØ§Ù†Øª Ù…ÙØªÙˆØ­Ø©. ÙƒØ§Ù† Ø³Ø§Ø±Ø© ÙˆØ®ÙˆØ³ÙŠÙ‡ ÙŠØªØ³Ù„Ù‚Ø§Ù† Ø§Ù„ØªÙ„. Ø±Ø£Øª Ø³Ø§Ø±Ø© Ø£Ù† Ø¨Ø¹Ø¶ Ø§Ù„Ù‚Ù…Ø§Ù…Ø© Ù…Ù† Ø­Ù‚ÙŠØ¨ØªÙ‡Ø§ ÙƒØ§Ù†Øª Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±Ø¶. "Ø£ÙˆÙ‡ Ù„Ø§ØŒ" ØµØ±Ø®Øª. "Ø¹Ù„ÙŠÙ†Ø§ Ø§Ù„ØªÙ‚Ø§Ø·Ù‡Ø§."</div>
                        </div>
                    </div>
                </div>
                
                 <!-- Part 4 -->
                <div class="story-block">
                    <div style="display:flex; justify-content:space-between; align-items:flex-start;">
                        <button class="btn-audio" onclick="speak(document.getElementById('txt-4').innerText)" style="flex-shrink:0; margin-right:15px;"><i class="fas fa-volume-up"></i></button>
                        <div style="flex-grow:1;">
                            <div id="txt-4" class="story-text">
                                A few hours later, the children went back. "The yellow team found four flags. You win today's flag hunt," said the teacher. "Here, take one of our flags. We saw that you collected all your trash, and you couldn't finish," said Lucy. "Thank you!" said Jose and Sarah.
                            </div>
                            <button class="btn-trans" onclick="toggleTrans('trans-4')">Show Translation ğŸ‘ï¸</button>
                            <div id="trans-4" class="story-trans">Ø¨Ø¹Ø¯ Ø¨Ø¶Ø¹ Ø³Ø§Ø¹Ø§ØªØŒ Ø¹Ø§Ø¯ Ø§Ù„Ø£Ø·ÙØ§Ù„. "Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ØµÙØ± ÙˆØ¬Ø¯ Ø£Ø±Ø¨Ø¹Ø© Ø£Ø¹Ù„Ø§Ù…. Ø£Ù†ØªÙ… Ø§Ù„ÙØ§Ø¦Ø²ÙˆÙ† Ø¨Ø¨Ø­Ø« Ø§Ù„Ø£Ø¹Ù„Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ØŒ" Ù‚Ø§Ù„ Ø§Ù„Ù…Ø¹Ù„Ù…. "Ù‡Ù†Ø§ØŒ Ø®Ø°ÙˆØ§ Ø£Ø­Ø¯ Ø£Ø¹Ù„Ø§Ù…Ù†Ø§. Ø±Ø£ÙŠÙ†Ø§ Ø£Ù†ÙƒÙ… Ø¬Ù…Ø¹ØªÙ… ÙƒÙ„ Ù‚Ù…Ø§Ù…ØªÙƒÙ…ØŒ ÙˆÙ„Ù… ØªØ³ØªØ·ÙŠØ¹ÙˆØ§ Ø§Ù„Ø¥Ù†Ù‡Ø§Ø¡ØŒ" Ù‚Ø§Ù„Øª Ù„ÙˆØ³ÙŠ. "Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ…!" Ù‚Ø§Ù„ Ø®ÙˆØ³ÙŠÙ‡ ÙˆØ³Ø§Ø±Ø©.</div>
                        </div>
                    </div>
                </div>

                <!-- Quiz Section -->
                <div style="margin-top:50px; background:#fafafa; padding:30px; border-radius:20px;">
                    <h3 style="color:#d97706; margin-bottom:20px;">ğŸ§  Story Quiz - Ø§Ø®ØªØ¨Ø± ÙÙ‡Ù…Ùƒ</h3>
                    <div id="story-quiz-container">
                        <!-- Q1 -->
                        <div class="quiz-item" style="margin-bottom:15px;">
                            <p style="font-weight:bold; margin-bottom:5px;">1. The yellow team goes to the ______ first.</p>
                            <p style="font-family:'Tajawal'; color:#64748b; margin-bottom:10px; font-size:0.95rem;">1. ÙŠØ°Ù‡Ø¨ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ØµÙØ± Ø¥Ù„Ù‰ ______ Ø£ÙˆÙ„Ø§Ù‹.</p>
                            <button class="quiz-btn-small" onclick="checkStoryQuiz(this, true)">lake</button>
                            <button class="quiz-btn-small" onclick="checkStoryQuiz(this, false)">field</button>
                        </div>
                         <!-- Q2 -->
                        <div class="quiz-item" style="margin-bottom:15px;">
                            <p style="font-weight:bold; margin-bottom:5px;">2. The yellow team ______ a flag there.</p>
                            <p style="font-family:'Tajawal'; color:#64748b; margin-bottom:10px; font-size:0.95rem;">2. Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ØµÙØ± ______ Ø¹Ù„Ù…Ø§Ù‹ Ù‡Ù†Ø§Ùƒ.</p>
                            <button class="quiz-btn-small" onclick="checkStoryQuiz(this, true)">finds</button>
                            <button class="quiz-btn-small" onclick="checkStoryQuiz(this, false)">doesn't find</button>
                        </div>
                        <!-- Q3 -->
                        <div class="quiz-item" style="margin-bottom:15px;">
                            <p style="font-weight:bold; margin-bottom:5px;">3. The blue team ______ their backpack.</p>
                            <p style="font-family:'Tajawal'; color:#64748b; margin-bottom:10px; font-size:0.95rem;">3. Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚ ______ Ø­Ù‚ÙŠØ¨Ø© Ø¸Ù‡Ø±Ù‡Ù….</p>
                            <button class="quiz-btn-small" onclick="checkStoryQuiz(this, false)">closes</button>
                            <button class="quiz-btn-small" onclick="checkStoryQuiz(this, true)">doesn't close</button>
                        </div>
                        <!-- Q4 -->
                        <div class="quiz-item" style="margin-bottom:15px;">
                            <p style="font-weight:bold; margin-bottom:5px;">4. The blue team ______ collect their trash.</p>
                            <p style="font-family:'Tajawal'; color:#64748b; margin-bottom:10px; font-size:0.95rem;">4. Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚ ______ Ø¬Ù…Ø¹ Ù‚Ù…Ø§Ù…ØªÙ‡Ù….</p>
                            <button class="quiz-btn-small" onclick="checkStoryQuiz(this, true)">needs to</button>
                            <button class="quiz-btn-small" onclick="checkStoryQuiz(this, false)">doesn't need to</button>
                        </div>
                        <!-- Q5 -->
                         <div class="quiz-item" style="margin-bottom:15px;">
                            <p style="font-weight:bold; margin-bottom:5px;">5. The ______ team wins the flag hunt.</p>
                            <p style="font-family:'Tajawal'; color:#64748b; margin-bottom:10px; font-size:0.95rem;">5. Ø§Ù„ÙØ±ÙŠÙ‚ ______ ÙŠÙÙˆØ² Ø¨Ø¨Ø­Ø« Ø§Ù„Ø£Ø¹Ù„Ø§Ù….</p>
                            <button class="quiz-btn-small" onclick="checkStoryQuiz(this, false)">blue</button>
                            <button class="quiz-btn-small" onclick="checkStoryQuiz(this, true)">yellow</button>
                        </div>
                        <!-- Q6 -->
                         <div class="quiz-item" style="margin-bottom:15px;">
                            <p style="font-weight:bold; margin-bottom:5px;">6. The yellow team ______ a flag to the blue team.</p>
                             <p style="font-family:'Tajawal'; color:#64748b; margin-bottom:10px; font-size:0.95rem;">6. Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ØµÙØ± ______ Ø¹Ù„Ù…Ø§Ù‹ Ù„Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚.</p>
                            <button class="quiz-btn-small" onclick="checkStoryQuiz(this, false)">doesn't give</button>
                            <button class="quiz-btn-small" onclick="checkStoryQuiz(this, true)">gives</button>
                        </div>
                    </div>
                </div>

                <!-- SEL Section -->
                <div class="social-card">
                    <h3 style="color:#15803d; margin-bottom:20px; font-size:1.5rem;">ğŸ¤ Social and Emotional Learning</h3>
                    <div style="display:grid; gap:20px;">
                        <div>
                            <div class="social-q">1. When do you usually feel stressed?</div>
                            <div style="font-family:'Tajawal'; color:#64748b;">Ù…ØªÙ‰ ØªØ´Ø¹Ø± ØºØ§Ù„Ø¨Ø§Ù‹ Ø¨Ø§Ù„ØªÙˆØªØ±ØŸ</div>
                        </div>
                        <div>
                            <div class="social-q">2. What do you do to feel less stressed?</div>
                            <div style="font-family:'Tajawal'; color:#64748b;">Ù…Ø§Ø°Ø§ ØªÙØ¹Ù„ Ù„ØªØ´Ø¹Ø± Ø¨ØªÙˆØªØ± Ø£Ù‚Ù„ØŸ</div>
                        </div>
                         <div>
                            <div class="social-q">3. Are there other activities that help you to feel better?</div>
                            <div style="font-family:'Tajawal'; color:#64748b;">Ù‡Ù„ Ù‡Ù†Ø§Ùƒ Ø£Ù†Ø´Ø·Ø© Ø£Ø®Ø±Ù‰ ØªØ³Ø§Ø¹Ø¯Ùƒ Ù„ØªØ´Ø¹Ø± Ø¨ØªØ­Ø³Ù†ØŸ</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

            </div>
        </div>

        <!-- SECTION 5: VOCAB & GAMES (LESSON 5) -->
        <div id="vocab5" class="section" style="display:none;">
            
            <!-- 1. Flashcards -->
            <h2 class="section-title">1. Vocabulary Flashcards ğŸƒ</h2>
            <p style="text-align:center; margin-bottom:30px; color:#64748b;">Click card to flip for Arabic. Click ğŸ¤ to practice pronunciation!</p>
            
            <div class="flash-grid" id="flash-container">
                <!-- Injected via JS -->
            </div>

            <!-- 2. Fill in the Blanks -->
            <div style="background:white; padding:40px; border-radius:30px; margin-top:50px; box-shadow:0 15px 30px rgba(0,0,0,0.05); border:1px solid #e5e7eb;">
                <h2 class="story-title" style="font-size:2rem; margin-bottom:20px; color:#0ea5e9;">2. Complete the Text âœï¸</h2>
                <div style="font-size:1.3rem; line-height:2.2; color:#374151;">
                    <div style="margin-bottom:20px;">
                        <span style="background:#e0f2fe; padding:5px 10px; border-radius:8px;">High Mountain ğŸ”ï¸</span> 
                        In this countryside landscape there's a 
                        <select class="fill-box" data-ans="high">
                            <option value="">???</option>
                            <option value="low">low</option>
                            <option value="high">high</option>
                            <option value="dry">dry</option>
                        </select>
                        mountain and a waterfall. The mountain is 
                        <select class="fill-box" data-ans="close">
                            <option value="">???</option>
                            <option value="far">far</option>
                            <option value="close">close</option>
                            <option value="hard">hard</option>
                        </select>
                        to the forest.
                    </div>
                    <div style="margin-bottom:20px;">
                         <span style="background:#fef3c7; padding:5px 10px; border-radius:8px;">Desert ğŸª</span>
                        This is a desert with a lot of sand, so the 
                        <select class="fill-box" data-ans="ground">
                            <option value="">???</option>
                            <option value="lake">lake</option>
                            <option value="ground">ground</option>
                            <option value="sky">sky</option>
                        </select>
                        is dry. There are also some 
                        <select class="fill-box" data-ans="low">
                            <option value="">???</option>
                            <option value="high">high</option>
                            <option value="low">low</option>
                            <option value="deep">deep</option>
                        </select>
                        hills. They are called sand dunes.
                    </div>
                     <div>
                         <span style="background:#dcfce7; padding:5px 10px; border-radius:8px;">Island ğŸï¸</span>
                        On this island, there are lots of 
                        <select class="fill-box" data-ans="snails">
                            <option value="">???</option>
                            <option value="snails">snails</option>
                            <option value="whales">whales</option>
                            <option value="snakes">snakes</option>
                        </select>
                        . Be careful! The ocean looks 
                        <select class="fill-box" data-ans="deep">
                            <option value="">???</option>
                            <option value="high">high</option>
                            <option value="deep">deep</option>
                            <option value="dry">dry</option>
                        </select>
                        . The island is 
                        <select class="fill-box" data-ans="far">
                            <option value="">???</option>
                            <option value="close">close</option>
                            <option value="far">far</option>
                            <option value="low">low</option>
                        </select>
                        from land. There are a lot of rocks that look 
                        <select class="fill-box" data-ans="hard">
                            <option value="">???</option>
                            <option value="soft">soft</option>
                            <option value="hard">hard</option>
                            <option value="wet">wet</option>
                        </select>
                        .
                    </div>
                </div>
                <div style="text-align:center; margin-top:30px;">
                    <button onclick="checkFillBlanks()" style="background:#0ea5e9; color:white; padding:15px 40px; border:none; border-radius:50px; font-size:1.2rem; font-weight:bold; cursor:pointer; box-shadow:0 10px 20px rgba(14,165,233,0.3);">Check Answers âœ…</button>
                    <p id="fill-feedback" style="margin-top:15px; font-weight:bold; font-size:1.2rem; min-height:30px;"></p>
                </div>
            </div>

            <!-- 3. Find Differences Game -->
            <div style="margin-top:50px; background:#fffbeb; padding:40px; border-radius:30px; border:2px dashed #f59e0b;">
                 <h2 class="story-title" style="font-size:2rem; margin-bottom:10px; color:#d97706;">3. Find the Right Picture ğŸ•µï¸</h2>
                 <p style="text-align:center; color:#92400e; margin-bottom:30px;">Read the sentence and click the correct matching picture regarding the description!</p>

                 <div id="diff-game-container">
                     <!-- Game Logic Injected -->
                     <div class="diff-game" id="game-options">
                         <img src="https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?w=500&q=80" class="diff-img" id="img-a" onclick="checkDiffGame('A')">
                         <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?w=500&q=80" class="diff-img" id="img-b" onclick="checkDiffGame('B')">
                     </div>
                     <div style="text-align:center; margin-top:20px;">
                         <div id="diff-sentence" style="font-size:1.5rem; font-weight:bold; color:#1f2937; background:white; padding:15px 30px; border-radius:15px; display:inline-block; box-shadow:0 5px 15px rgba(0,0,0,0.05);">Loading...</div>
                         <div id="diff-feedback" style="margin-top:10px; font-weight:bold;"></div>
                     </div>
                     <div style="text-align:center; margin-top:20px;">
                         <button onclick="nextDiffRound()" style="background:#f59e0b; color:white; border:none; padding:10px 25px; border-radius:20px; cursor:pointer; font-weight:bold;">Next Question â¡</button>
                     </div>
                 </div>
            </div>

        </div>

    </main>

        <!-- SECTION 6: GRAMMAR (LESSON 6) -->
        <div id="grammar6" class="section" style="display:none;">
            <div class="grammar-card">
                 <h2 class="grammar-title"><i class="fas fa-clock"></i> Past Ability: Could / Couldn't</h2>
                 <p style="color:#64748b; margin-bottom:5px;">We use <b>could</b> to talk about what we were able to do in the past.</p>
                 <p style="color:#15803d; margin-bottom:20px; font-family:'Tajawal';">Ù†Ø³ØªØ®Ø¯Ù… <b>could</b> Ù„Ù„ØªØ¹Ø¨ÙŠØ± Ø¹Ù† Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ ÙØ¹Ù„ Ø´ÙŠØ¡ ÙÙŠ Ø§Ù„Ù…Ø§Ø¶ÙŠ.</p>
                 
                 <div style="display:flex; gap:20px; flex-wrap:wrap; margin-bottom:40px;">
                      <div style="flex:1; background:#f5f3ff; pad:20px; border-radius:15px; padding:20px; text-align:center;">
                          <div style="font-size:3rem;">ğŸ‘¶</div>
                          <h3>When I was a baby...</h3>
                          <p>I <b>couldn't</b> walk.</p>
                          <p style="color:#64748b; font-size:0.9rem; margin-top:5px; font-family:'Tajawal';">Ø¹Ù†Ø¯Ù…Ø§ ÙƒÙ†Øª Ø·ÙÙ„Ø§Ù‹ØŒ Ù„Ù… Ø£ÙƒÙ† Ø£Ø³ØªØ·ÙŠØ¹ Ø§Ù„Ù…Ø´ÙŠ.</p>
                          <p style="color:#ef4444; font-size:1.5rem; margin-top:10px;">âŒ</p>
                      </div>
                      <div style="flex:1; background:#ecfdf5; pad:20px; border-radius:15px; padding:20px; text-align:center;">
                          <div style="font-size:3rem;">ğŸƒ</div>
                          <h3>When I was ten...</h3>
                          <p>I <b>could</b> run fast.</p>
                          <p style="color:#64748b; font-size:0.9rem; margin-top:5px; font-family:'Tajawal';">Ø¹Ù†Ø¯Ù…Ø§ ÙƒÙ†Øª ÙÙŠ Ø§Ù„Ø¹Ø§Ø´Ø±Ø©ØŒ ÙƒÙ†Øª Ø£Ø³ØªØ·ÙŠØ¹ Ø§Ù„Ø¬Ø±ÙŠ Ø¨Ø³Ø±Ø¹Ø©.</p>
                          <p style="color:#22c55e; font-size:1.5rem; margin-top:10px;">âœ…</p>
                      </div>
                 </div>

                 <!-- Ex 1 -->
                 <h3 style="margin-bottom:15px; color:#4b5563;">1. Choose the correct word ğŸ§ </h3>
                 <div style="font-size:1.3rem; margin-bottom:20px;">
                    1. You were an athlete. 
                    <span class="grammar-toggle" onclick="toggleGrammar(this, 'could')"><span class="grammar-option">Could</span><span class="grammar-option">Couldn't</span></span>
                    you run fast?
                 </div>
                 <div style="font-size:1.3rem; margin-bottom:20px;">
                    2. No, I 
                    <span class="grammar-toggle" onclick="toggleGrammar(this, 'couldnt')"><span class="grammar-option">could</span><span class="grammar-option">couldn't</span></span>
                    ride a horse.
                 </div>

                 <!-- Ex 3 Summer Camp -->
                 <h3 style="margin-top:40px; margin-bottom:15px; color:#4b5563;">2. Summer Camp Activities ğŸ•ï¸</h3>
                 <p style="color:#64748b;">Look at the pictures. Click "Could" or "Couldn't" based on the check/cross mark.</p>
                 
                 <div class="camp-grid">
                      <!-- 1 -->
                      <div class="camp-card" style="background-image:url('https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=500'); background-size:cover;">
                           <div class="camp-overlay">
                               <p style="margin-bottom:10px;">We _____ walk in the forest. âœ…</p>
                               <button class="quiz-btn-small" onclick="checkCamp(this, true)">Could</button>
                               <button class="quiz-btn-small" onclick="checkCamp(this, false)">Couldn't</button>
                           </div>
                      </div>
                      <!-- 2 -->
                      <div class="camp-card" style="background-image:url('https://images.unsplash.com/photo-1544465544-1b71aee9dfa3?w=500'); background-size:cover;">
                           <div class="camp-overlay">
                               <p style="margin-bottom:10px;">We _____ climb mountains. âŒ</p>
                               <button class="quiz-btn-small" onclick="checkCamp(this, false)">Could</button>
                               <button class="quiz-btn-small" onclick="checkCamp(this, true)">Couldn't</button>
                           </div>
                      </div>
                      <!-- 3 -->
                      <div class="camp-card" style="background-image:url('https://images.unsplash.com/photo-1558509355-635ec36353d2?w=500'); background-size:cover;">
                           <div class="camp-overlay">
                               <p style="margin-bottom:10px;">We _____ swim in the lake. âœ…</p>
                               <button class="quiz-btn-small" onclick="checkCamp(this, true)">Could</button>
                               <button class="quiz-btn-small" onclick="checkCamp(this, false)">Couldn't</button>
                           </div>
                      </div>
                 </div>

            </div>
        </div>

        <!-- SECTION 7: SOCIAL STUDIES (LESSON 7) -->
        <div id="social7" class="section" style="display:none;">
             <div class="reading-box">
                  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                      <div>
                          <h2 style="color:#0ea5e9; font-size:2rem; margin:0; line-height:1.2;">ğŸ¢ A New Theme Park in Qiddiya</h2>
                          <p style="color:#64748b; font-size:1rem; margin-top:5px;">Integrated Learning: Social Studies</p>
                      </div>
                      <button class="btn-audio" onclick="speak(document.getElementById('reading-text').innerText)">ğŸ”Š Listen</button>
                  </div>
                  
                  <div style="display:flex; gap:30px; flex-wrap:wrap; align-items:flex-start;">
                      <div style="flex:2;">
                          <div id="reading-text" style="font-size:1.15rem; line-height:1.8; color:#334155;">
                                A new theme park is coming to Saudi Arabia â€” a <span class="highlight-blue" title="Ø­Ø¯ÙŠÙ‚Ø© Ø¯Ø±Ø§Ø¬ÙˆÙ† Ø¨ÙˆÙ„">Dragon Ball Theme Park!</span> A theme park has exciting rides. This one will be the first theme park about <i>Dragon Ball</i> in the world. It will be in <span class="highlight-blue" title="Ø§Ù„Ù‚Ø¯ÙŠØ©">Qiddiya</span>. Qiddiya is a new city near the <span class="highlight-blue" title="Ø¬Ø¨Ø§Ù„ Ø·ÙˆÙŠÙ‚">Tuwaiq Mountains</span>.
                                <br><br>
                                <i>Dragon Ball</i> is a comic book series. It is also a TV show. It's about a boy named <span class="highlight-blue" title="ØºÙˆÙƒÙˆ">Goku</span>. He is looking for magic Dragon Balls. Master Roshi teaches Goku martial arts.
                                <br><br>
                                Fans of <i>Dragon Ball</i> want to have an adventure like Goku! Visitors want to come to the theme park.
                                <br><br>
                                One kind of ride is a <span class="highlight-blue" title="Ø£ÙØ¹ÙˆØ§Ù†ÙŠØ©">roller coaster</span>. It goes very fast. It goes up high. It is scary and fun â€” and safe, too! The Dragon Ball Theme Park will have a huge roller coaster inside a dragon. The dragon is a character from <i>Dragon Ball</i>. There are ideas for 30 rides about the characters and places from <i>Dragon Ball</i>.
                          </div>
                      </div>
                      <div style="flex:1; min-width:250px;">
                          <img src="https://images.unsplash.com/photo-1516051662668-94f11204cc1b?w=500" style="width:100%; border-radius:15px; box-shadow:0 10px 20px rgba(0,0,0,0.1); margin-bottom:15px;">
                          <img src="https://images.unsplash.com/photo-1598255280063-4416a41f6784?w=500" style="width:100%; border-radius:15px; box-shadow:0 10px 20px rgba(0,0,0,0.1);">
                      </div>
                  </div>
                  
                  <div style="margin-top:40px; border-top:2px solid #f1f5f9; padding-top:30px;">
                        <h3 style="margin-bottom:25px; color:#0f172a;">2. Read and write T (True) or F (False) âœ…âŒ</h3>
                        
                        <!-- Q1 -->
                        <div class="tf-btn" onclick="checkTF(this, false)">
                            <div>
                                <span class="q-text">1. Qiddiya is a character in <i>Dragon Ball</i>.</span>
                                <div class="ar-text">Ù‚Ø¯ÙŠØ© Ù‡ÙŠ Ø´Ø®ØµÙŠØ© ÙÙŠ ÙƒØ±Ø© Ø¯Ø±Ø§Ø¬ÙˆÙ†</div>
                            </div>
                            <span class="fb-icon">â“</span>
                        </div>
                        <!-- Q2 -->
                        <div class="tf-btn" onclick="checkTF(this, false)">
                            <div>
                                <span class="q-text">2. The theme park is far from the Tuwaiq Mountains.</span>
                                <div class="ar-text">Ø­Ø¯ÙŠÙ‚Ø© Ø§Ù„Ù…Ù„Ø§Ù‡ÙŠ Ø¨Ø¹ÙŠØ¯Ø© Ù…Ù† Ø¬Ø¨Ø§Ù„ Ø·ÙˆÙŠÙ‚</div>
                            </div>
                            <span class="fb-icon">â“</span>
                        </div>
                        <!-- Q3 -->
                        <div class="tf-btn" onclick="checkTF(this, true)">
                            <div>
                                <span class="q-text">3. Goku is a boy in <i>Dragon Ball</i>.</span>
                                <div class="ar-text">ØºÙˆÙƒÙˆ Ø·ÙÙ„ ÙÙŠ ÙƒØ±Ø© Ø¯Ø±Ø§Ø¬ÙˆÙ†</div>
                            </div>
                            <span class="fb-icon">â“</span>
                        </div>
                        <!-- Q4 -->
                        <div class="tf-btn" onclick="checkTF(this, false)">
                            <div>
                                <span class="q-text">4. Few people like <i>Dragon Ball</i> comic books.</span>
                                <div class="ar-text">Ù‚Ù„ÙŠÙ„ Ù…Ù† Ø§Ù„Ù†Ø§Ø³ ÙŠØ­Ø¨ÙˆÙ† ÙƒØªØ¨ Ø¯Ø±Ø§Ø¬ÙˆÙ† Ø§Ù„ÙÙƒØ§Ù‡ÙŠØ©</div>
                            </div>
                            <span class="fb-icon">â“</span>
                        </div>
                        <!-- Q5 -->
                        <div class="tf-btn" onclick="checkTF(this, true)">
                            <div>
                                <span class="q-text">5. A roller coaster is a kind of ride at theme parks.</span>
                                <div class="ar-text">Ø§Ø³Ø·ÙˆØ§Ù†Ø© ÙƒÙˆØ³ØªØ± Ù‡ÙŠ Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ø±ÙƒÙˆØ¨ ÙÙŠ Ø­Ø¯ÙŠÙ‚Ø© Ø§Ù„Ù…Ù„Ø§Ù‡ÙŠ</div>
                            </div>
                            <span class="fb-icon">â“</span>
                        </div>
                         <!-- Q6 -->
                        <div class="tf-btn" onclick="checkTF(this, true)">
                            <div>
                                <span class="q-text">6. The dragon roller coaster will be very big.</span>
                                <div class="ar-text">Ø§Ø³Ø·ÙˆØ§Ù†Ø© Ø¯Ø±Ø§Ø¬ÙˆÙ† Ø³ØªÙƒÙˆÙ† ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹</div>
                            </div>
                             <span class="fb-icon">â“</span>
                        </div>
                  </div>

                  <!-- Writing/Speaking Section -->
                  <div style="margin-top:40px; background:#f0fdf4; padding:25px; border-radius:15px; border:1px solid #bbf7d0;">
                        <h3 style="color:#166534; margin-bottom:10px;">3. Think and Speak ğŸ—£ï¸</h3>
                        <p style="font-weight:bold; margin-bottom:15px;">What can you do at theme parks?</p>
                        <div style="background:white; padding:15px; border-radius:10px; border-left:4px solid #166534; font-style:italic; color:#555;">
                             "When I go to an amusement park or theme parks, I enjoy walking around, playing the games, eating roasted corn on the cob."
                        </div>
                        <button class="quiz-btn" style="margin-top:15px; width:auto; padding:10px 20px; font-size:1rem;" onclick="speak('When I go to an amusement park or theme parks, I enjoy walking around, playing the games, eating roasted corn on the cob.')">ğŸ”Š Listen to Example</button>
                  </div>
             </div>
        </div>

        <!-- SECTION 8: WRITING -->
        <div id="writing" class="section" style="display:none;">
            <h2 class="section-title">ğŸ“ Word Work and Writing</h2>
            <div style="text-align:center; margin-bottom:30px; display:flex; gap:15px; justify-content:center; flex-wrap:wrap;">
                <button onclick="openTest('writing', 'pre')" style="background:linear-gradient(135deg, #3b82f6, #2563eb); color:white; border:none; padding:15px 35px; border-radius:50px; font-size:1.3rem; cursor:pointer; font-weight:600;">ğŸ“‹ Pre-Test / Ø§Ø®ØªØ¨Ø§Ø± Ù‚Ø¨Ù„ÙŠ</button>
                <button onclick="openTest('writing', 'post')" style="background:linear-gradient(135deg, #10b981, #059669); color:white; border:none; padding:15px 35px; border-radius:50px; font-size:1.3rem; cursor:pointer; font-weight:600;">âœ… Post-Test / Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø¹Ø¯ÙŠ</button>
            </div>
            
            <!-- Activity 1 -->
            <div class="card" style="margin-bottom:40px;">
                <h3 style="font-size:2rem; margin-bottom:25px; color:var(--primary);">
                    1. Look and write the words in the correct columns
                </h3>
                
                <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap:15px; margin-bottom:30px;">
                    <div style="padding:15px; text-align:center; background:white; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.05);">
                        <div style="font-size:2.5rem;">ğŸ¸</div>
                        <div style="font-size:1.2rem; font-weight:600; margin:8px 0;">frog</div>
                        <div style="font-size:0.9rem; font-family:'Tajawal'; color:#666;">Ø¶ÙØ¯Ø¹</div>
                        <button class="btn-audio" onclick="speak('frog')" style="margin-top:8px;">ğŸ”Š</button>
                    </div>
                    <div style="padding:15px; text-align:center; background:white; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.05);">
                        <div style="font-size:2.5rem;">ğŸš‚</div>
                        <div style="font-size:1.2rem; font-weight:600; margin:8px 0;">train</div>
                        <div style="font-size:0.9rem; font-family:'Tajawal'; color:#666;">Ù‚Ø·Ø§Ø±</div>
                        <button class="btn-audio" onclick="speak('train')" style="margin-top:8px;">ğŸ”Š</button>
                    </div>
                    <div style="padding:15px; text-align:center; background:white; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.05);">
                        <div style="font-size:2.5rem;">ğŸ‘</div>
                        <div style="font-size:1.2rem; font-weight:600; margin:8px 0;">sheep</div>
                        <div style="font-size:0.9rem; font-family:'Tajawal'; color:#666;">Ø®Ø±ÙˆÙ</div>
                        <button class="btn-audio" onclick="speak('sheep')" style="margin-top:8px;">ğŸ”Š</button>
                    </div>
                    <div style="padding:15px; text-align:center; background:white; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.05);">
                        <div style="font-size:2.5rem;">ğŸ§­</div>
                        <div style="font-size:1.2rem; font-weight:600; margin:8px 0;">west</div>
                        <div style="font-size:0.9rem; font-family:'Tajawal'; color:#666;">ØºØ±Ø¨</div>
                        <button class="btn-audio" onclick="speak('west')" style="margin-top:8px;">ğŸ”Š</button>
                    </div>
                    <div style="padding:15px; text-align:center; background:white; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.05);">
                        <div style="font-size:2.5rem;">ğŸš´</div>
                        <div style="font-size:1.2rem; font-weight:600; margin:8px 0;">bike</div>
                        <div style="font-size:0.9rem; font-family:'T ajawal'; color:#666;">Ø¯Ø±Ø§Ø¬Ø©</div>
                        <button class="btn-audio" onclick="speak('bike')" style="margin-top:8px;">ğŸ”Š</button>
                    </div>
                    <div style="padding:15px; text-align:center; background:white; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.05);">
                        <div style="font-size:2.5rem;">ğŸ±</div>
                        <div style="font-size:1.2rem; font-weight:600; margin:8px 0;">cat</div>
                        <div style="font-size:0.9rem; font-family:'Tajawal'; color:#666;">Ù‚Ø·Ø©</div>
                        <button class="btn-audio" onclick="speak('cat')" style="margin-top:8px;">ğŸ”Š</button>
                    </div>
                </div>

                <div style="overflow-x:auto;">
                    <table class="grammar-table" style="width:100%; text-align:center;">
                        <thead>
                            <tr>
                                <th style="background:#0ea5e9;">-og</th>
                                <th style="background:#10b981;">-ain</th>
                                <th style="background:#f59e0b;">-eep</th>
                                <th style="background:#ec4899;">-est</th>
                                <th style="background:#8b5cf6;">-ike</th>
                                <th style="background:#ef4444;">-at</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding:15px;">frog</td>
                                <td style="padding:15px;">train</td>
                                <td style="padding:15px;">sheep</td>
                                <td style="padding:15px;">west</td>
                                <td style="padding:15px;">bike</td>
                                <td style="padding:15px;">cat</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Activity 2 -->
            <div class="card" style="margin-bottom:40px;">
                <h3 style="font-size:2rem; margin-bottom:25px; color:var(--primary);">
                    2. Look, read, and complete the sentences
                </h3>

                <div style="background:#fffbeb; padding:20px; border-radius:15px; margin-bottom:20px;">
                    <p style="font-size:1.3rem; line-height:2;">
                        Let's k<span style="background:#fde047; padding:2px 8px; border-radius:4px; font-weight:700;">ing</span> s flowers in the spr<span style="background:#fde047; padding:2px 8px; border-radius:4px; font-weight:700;">ing</span>.
                    </p>
                    <button class="btn-audio" onclick="speak('Lets king s flowers in the spring')" style="margin-top:10px;">ğŸ”Š</button>
                </div>

                <div style="background:#f0fdf4; padding:20px; border-radius:15px; margin-bottom:20px;">
                    <p style="font-size:1.3rem; line-height:2;">
                        The s<span style="background:#a7f3d0; padding:2px 8px; border-radius:4px; font-weight:700;">un</span> for f<span style="background:#a7f3d0; padding:2px 8px; border-radius:4px; font-weight:700;">un</span>.
                    </p>
                    <button class="btn-audio" onclick="speak('The sun for fun')" style="margin-top:10px;">ğŸ”Š</button>
                </div>

                <div style="background:#fff7ed; padding:20px; border-radius:15px; margin-bottom:20px;">
                    <p style="font-size:1.3rem; line-height:2;">
                        We must sk<span style="background:#fed7aa; padding:2px 8px; border-radius:4px; font-weight:700;">ate</span> to the g<span style="background:#fed7aa; padding:2px 8px; border-radius:4px; font-weight:700;">ate</span> because we're l<span style="background:#fed7aa; padding:2px 8px; border-radius:4px; font-weight:700;">ate</span>.
                    </p>
                    <button class="btn-audio" onclick="speak('We must skate to the gate because we are late')" style="margin-top:10px;">ğŸ”Š</button>
                </div>

                <div style="background:#eff6ff; padding:20px; border-radius:15px;">
                    <p style="font-size:1.3rem; line-height:2;">
                        There's a c<span style="background:#bfdbfe; padding:2px 8px; border-radius:4px; font-weight:700;">ool</span> p<span style="background:#bfdbfe; padding:2px 8px; border-radius:4px; font-weight:700;">ool</span> at our new sch<span style="background:#bfdbfe; padding:2px 8px; border-radius:4px; font-weight:700;">ool</span>.
                    </p>
                    <button class="btn-audio" onclick="speak('Theres a cool pool at our new school')" style="margin-top:10px;">ğŸ”Š</button>
                </div>
            </div>

            <!-- Activity 3 -->
            <div class="card">
                <h3 style="font-size:2rem; margin-bottom:25px; color:var(--primary);">
                    3. Write about your summer vacation
                </h3>

                <div style="background:#f0fdf4; padding:25px; border-radius:15px; margin-bottom:25px;">
                    <h4 style="color:#15803d; margin-bottom:15px;">Guide Questions:</h4>
                    <ol style="font-size:1.1rem; line-height:2;">
                        <li>Where did you go on vacation?</li>
                        <li>What was the weather like?</li>
                        <li>What could you do there?</li>
                        <li>What couldn't you do there?</li>
                        <li>Where do you want to go next year?</li>
                    </ol>
                </div>

                <div style="background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding:30px; border-radius:20px; color:white; margin-bottom:25px;">
                    <div style="display:flex; align-items:center; gap:15px; margin-bottom:20px;">
                        <div style="background:white; padding:15px; border-radius:15px; font-size:2rem;">ğŸ“</div>
                        <div>
                            <h4 style="margin:0; font-size:1.5rem;">My Blog - March 12</h4>
                        </div>
                        <button class="btn-audio" onclick="speak('I had an excellent vacation last summer. I went to Jeddah with my family')" style="margin-left:auto; background:white; color:#667eea;">ğŸ”Š</button>
                    </div>
                    <div style="background:white; padding:25px; border-radius:15px; color:#1f2937; font-size:1.2rem; line-height:1.9;">
                        I had an excellent vacation last summer. I went to Jeddah with my family. The weather was cold so we couldn't swim in the sea, but we visited beautiful places like King Fahd's Fountain, Al-Balad and Red Sea Mall. It was a great vacation. We want to visit it again next summer.
                    </div>
                </div>

                <div>
                    <label style="display:block; font-size:1.2rem; font-weight:600; margin-bottom:10px;">âœï¸ Your Writing:</label>
                    <textarea style="width:100%; min-height:200px; padding:20px; border:2px solid #e2e8f0; border-radius:15px; font-size:1.1rem; resize:vertical;" placeholder="Write about your summer vacation here..."></textarea>
                </div>
            </div>
        </div>

    </main>

    <!-- TEST MODAL -->
    <div id="testModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:1000; justify-content:center; align-items:center; padding:20px; overflow-y:auto;">
        <div style="background:white; max-width:900px; width:100%; border-radius:25px; padding:40px; max-height:90vh; overflow-y:auto; position:relative;">
            <button onclick="closeTestModal()" style="position:absolute; top:20px; right:20px; background:#f87171; color:white; border:none; width:45px; height:45px; border-radius:50%; font-size:1.5rem; cursor:pointer;">âœ•</button>
            <h2 id="testTitle" style="text-align:center; font-size:2.5rem; color:var(--primary); margin-bottom:30px; font-family:'Tajawal'; line-height:1.5;"></h2>
            <div id="testQuestions"></div>
            <div style="text-align:center; margin-top:30px;">
                <button id="submitTest" class="quiz-btn" style="padding:18px 50px; font-size:1.6rem;">Ø¥Ø±Ø³Ø§Ù„ / Submit âœ“</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script>
        // --- DATA ---
        const vocabData = [
            { en: 'Earth', ar: 'Ø§Ù„Ø£Ø±Ø¶', img: 'https://images.unsplash.com/photo-1614730341194-75c607410095?w=500&q=80' },
            { en: 'Lake', ar: 'Ø¨ÙØ­ÙŠØ±Ø©', img: 'https://images.unsplash.com/photo-1558509355-635ec36353d2?w=500&q=80' },
            { en: 'Mountain', ar: 'Ø¬ÙØ¨ÙÙ„', img: 'https://images.unsplash.com/photo-1575351881847-b3bf188d9d0a?w=500&q=80' },
            { en: 'Forest', ar: 'ØºØ§Ø¨Ø©', img: 'https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?w=500&q=80' },
            { en: 'Island', ar: 'Ø¬Ø²ÙŠØ±Ø©', img: 'https://images.unsplash.com/photo-1559128010-7c1ad6e1b6a5?w=500&q=80' },
            { en: 'Hill', ar: 'ØªÙÙ„', img: 'https://images.unsplash.com/photo-1533241240974-9844e1383cb2?w=500&q=80' },
            { en: 'Waterfall', ar: 'Ø´Ù„Ø§Ù„', img: 'https://images.unsplash.com/photo-1512413116743-3c6d7d45f340?w=500&q=80' },
            { en: 'Cave', ar: 'ÙƒÙ‡Ù', img: 'https://images.unsplash.com/photo-1506893608240-692ab6242459?w=500&q=80' },
            { en: 'Desert', ar: 'ØµØ­Ø±Ø§Ø¡', img: 'https://images.unsplash.com/photo-1542401886-65d6c61db217?w=500&q=80' },
            { en: 'Field', ar: 'Ø­Ù‚Ù„', img: 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=500&q=80' },
            { en: 'Countryside', ar: 'Ø§Ù„Ø±ÙŠÙ', img: 'https://images.unsplash.com/photo-1517228817292-62a265a770be?w=500&q=80' },
            { en: 'Land', ar: 'ÙŠØ§Ø¨Ø³Ø©/Ø£Ø±Ø¶', img: 'https://images.unsplash.com/photo-1497911270199-1c552ee64aa4?w=500&q=80' }
        ];

        const quizQuestions = [
            { q: "We decided _______ to the beach.", options: ["going", "to go"], ans: 1 },
            { q: "I enjoy _______ stories.", options: ["reading", "to read"], ans: 0 },
            { q: "They forgot _______ their homework.", options: ["to do", "doing"], ans: 0 },
            { q: "She loves _______ flowers.", options: ["planting", "to plant"], ans: 0 },
            { q: "He wants _______ a doctor.", options: ["being", "to be"], ans: 1 },
        ];

        // --- LESSON 5 DATA ---
        // --- LESSON 5 DATA ---
        const vocabL5 = [
            { w: 'deep lake', ar: 'Ø¨Ø­ÙŠØ±Ø© Ø¹Ù…ÙŠÙ‚Ø© ğŸŒŠ', img: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?w=500' },
            { w: 'hard rock', ar: 'ØµØ®Ø±Ø© ØµÙ„Ø¨Ø© ğŸª¨', img: 'https://images.unsplash.com/photo-1525857597365-5f6dbff2e36e?w=500' },
            { w: 'dry ground', ar: 'Ø£Ø±Ø¶ Ø¬Ø§ÙØ© ğŸŒµ', img: 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=500' },
            { w: 'high mountain', ar: 'Ø¬Ø¨Ù„ Ù…Ø±ØªÙØ¹ ğŸ”ï¸', img: 'https://images.unsplash.com/photo-1575351881847-b3bf188d9d0a?w=500' },
            { w: 'far', ar: 'Ø¨Ø¹ÙŠØ¯ ğŸ”­', img: 'https://images.unsplash.com/photo-1453728013993-6d66e9c9123a?w=500' },
            { w: 'close', ar: 'Ù‚Ø±ÙŠØ¨ ğŸ”', img: 'https://images.unsplash.com/photo-1627236526189-b5702283dc47?w=500' }, // Snail close up
            { w: 'low tide', ar: 'Ù…Ø¯ Ù…Ù†Ø®ÙØ¶ ğŸ“‰', img: 'https://images.unsplash.com/photo-1518837695005-2083093ee35b?w=500' }
        ];

        const diffQuestions = [
            { q: "A forest close to a field", ans: 'A', imgA: 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=500', imgB: 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=500' }, 
            { q: "A deep lake", ans: 'B', imgA: 'https://images.unsplash.com/photo-1621255567439-012b07e86c06?w=500', imgB: 'https://images.unsplash.com/photo-1558509355-635ec36353d2?w=500' }, 
            { q: "A high mountain", ans: 'A', imgA: 'https://images.unsplash.com/photo-1575351881847-b3bf188d9d0a?w=500', imgB: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?w=500' }
        ];
        let diffIndex = 0;

        // --- INIT ---
        window.onload = function() {
            renderVocab();
            startQuiz();
            initLesson5();
        };

        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => {
                s.style.display = 'none';
                s.classList.remove('animate__fadeIn');
            });
            const active = document.getElementById(id);
            if(active) {
                active.style.display = 'block';
                active.classList.add('animate__animated', 'animate__fadeIn');
            }
            
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }

        // --- LESSON 1 LOGIC (Vocab) ---
        function renderVocab() {
            const grid = document.getElementById('vocab-grid');
            if(grid) {
                grid.innerHTML = vocabData.map(w => `
                    <div class="vocab-card">
                        <img src="${w.img}" class="card-img" alt="${w.en}">
                        <div class="card-body">
                            <div class="word-en">${w.en}</div>
                            <div class="word-ar">${w.ar}</div>
                            <button class="btn-audio" onclick="speak('${w.en}')">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
            }
        }

        // Audio Context & Fallbacks
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        let voices = [];
        const loadVoices = () => {
            voices = window.speechSynthesis.getVoices();
        };
        window.speechSynthesis.onvoiceschanged = loadVoices;
        loadVoices(); // Initial load

        window.speak = function(text, rate = 1) {
            if (!window.speechSynthesis) {
                console.error("Browser does not support TTS.");
                return;
            }
            
            // Cancel previous
            window.speechSynthesis.cancel();
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-GB'; // British English
            utterance.volume = 1.0; 
            
            // Attempt to find a British English voice
            if (voices.length === 0) voices = window.speechSynthesis.getVoices();
            const britishVoice = voices.find(v => v.lang === 'en-GB') || 
                                 voices.find(v => v.lang.startsWith('en-') && v.name.includes('UK')) ||
                                 voices.find(v => v.lang.startsWith('en-') && v.name.includes('British')) ||
                                 voices.find(v => v.lang.startsWith('en'));
            if (britishVoice) {
                utterance.voice = britishVoice;
            }
            
            // Use optimized rate (0.95 default)
            utterance.rate = rate === 1 ? 0.95 : rate;
            
            window.speechSynthesis.speak(utterance);
        };

        // --- LESSON 2 LOGIC (Grammar) ---
        function checkGrammar(btn, ans) {
            const feedback = document.getElementById('grammar-feedback');
            if(ans === 'to go') {
                btn.style.background = '#dcfce7';
                btn.style.borderColor = '#22c55e';
                feedback.innerHTML = '<span style="color:#16a34a">Correct! decided + to</span>';
                confetti({ particleCount: 50, origin: { y: 0.7 } });
            } else {
                btn.style.background = '#fee2e2';
                btn.style.borderColor = '#ef4444';
                feedback.innerHTML = '<span style="color:#dc2626">Try again! decided takes "to"</span>';
            }
        }

        // --- LESSON 2 QUIZ ---
        let currentQ = 0;
        let score = 0;

        function startQuiz() {
            currentQ = 0;
            score = 0;
            const screen = document.getElementById('quiz-screen');
            if(screen) {
                screen.style.display = 'block';
                document.getElementById('result-screen').style.display = 'none';
                document.getElementById('q-score').innerText = '0';
                loadQuestion();
            }
        }

        function loadQuestion() {
            if (currentQ >= quizQuestions.length) {
                showResults();
                return;
            }
            const data = quizQuestions[currentQ];
            document.getElementById('q-num').innerText = currentQ + 1;
            document.getElementById('q-text').innerText = data.q;
            
            const optionsDiv = document.getElementById('q-options');
            optionsDiv.innerHTML = '';
            
            data.options.forEach((opt, idx) => {
                optionsDiv.innerHTML += `
                    <button class="quiz-btn" onclick="checkAnswer(this, ${idx})">${opt}</button>
                `;
            });
        }

        function checkAnswer(btn, idx) {
            const data = quizQuestions[currentQ];
            const btns = document.querySelectorAll('.quiz-btn');
            btns.forEach(b => b.disabled = true);

            if (idx === data.ans) {
                btn.classList.add('correct');
                score += 10;
                document.getElementById('q-score').innerText = score;
                confetti({ particleCount: 30, spread: 50, origin: { y: 0.8 } });
            } else {
                btn.classList.add('wrong');
                btns[data.ans].classList.add('correct');
            }

            setTimeout(() => {
                currentQ++;
                loadQuestion();
            }, 1500);
        }

        function showResults() {
            document.getElementById('quiz-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';
            document.getElementById('final-score').innerText = score + ' / ' + (quizQuestions.length * 10);
        }

        // --- LESSON 3 STORY ---
        function toggleTrans(id) {
            const el = document.getElementById(id);
            el.style.display = (el.style.display === 'block') ? 'none' : 'block';
        }

        function checkStoryQuiz(btn, isCorrect) {
            const parent = btn.parentElement;
            const btns = parent.querySelectorAll('button');
            btns.forEach(b => {
                b.disabled = true;
                b.style.opacity = '0.7';
            });
            
            if(isCorrect) {
                 btn.style.background = '#dcfce7'; 
                 btn.style.borderColor = '#22c55e';
                 btn.style.color = '#15803d';
                 btn.innerHTML += ' âœ…';
                 btn.style.opacity = '1';
                 confetti({ particleCount: 20, origin: { y: 0.8 }, spread: 30 });
            } else {
                 btn.style.background = '#fee2e2'; 
                 btn.style.borderColor = '#ef4444'; 
                 btn.style.color = '#991b1b';
                 btn.innerHTML += ' âŒ';
                 btns.forEach(b => {
                     if(b !== btn) {
                         b.style.background = '#dcfce7';
                         b.style.borderColor = '#22c55e';
                     }
                 });
            }
        }

        // --- LESSON 5 LOGIC ---
        function initLesson5() {
            const grid = document.getElementById('flash-container');
            if(grid) {
                grid.innerHTML = vocabL5.map((item, idx) => `
                    <div class="flash-card" onclick="flipCard(this)">
                        <div class="flash-inner">
                            <div class="flash-front">
                                <img src="${item.img}" class="flash-img">
                                <div class="flash-content">
                                    <div class="flash-word">${item.w}</div>
                                    <button class="mic-btn" onclick="event.stopPropagation(); startListening(this, '${item.w}')">ğŸ¤</button>
                                    <button class="btn-audio" onclick="event.stopPropagation(); speak('${item.w}')" style="margin-top:10px; width:40px; height:40px; font-size:1rem;"><i class="fas fa-volume-up"></i></button>
                                </div>
                            </div>
                            <div class="flash-back">
                                <div style="font-family:'Tajawal'; font-size:1.8rem; font-weight:bold; color:#15803d;">${item.ar}</div>
                                <div style="font-size:3rem; margin-top:20px;">ğŸŒŸ</div>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                nextDiffRound();
            }
        }
        
        function flipCard(card) {
            card.classList.toggle('flipped');
        }

        function checkFillBlanks() {
            const inputs = document.querySelectorAll('.fill-box');
            let correct = 0;
            inputs.forEach(inp => {
                const ans = inp.dataset.ans.toLowerCase();
                if(inp.value.toLowerCase().trim() === ans) {
                    inp.classList.add('correct');
                    inp.classList.remove('wrong');
                    correct++;
                } else {
                    inp.classList.add('wrong');
                    inp.classList.remove('correct');
                }
            });
            
            const fb = document.getElementById('fill-feedback');
            if(correct === inputs.length) {
                fb.innerHTML = '<span style="color:#16a34a">ğŸ‰ Perfect! All answers correct!</span>';
                confetti({particleCount:100, origin:{y:0.6}});
            } else {
                fb.innerHTML = `<span style="color:#d97706">You got ${correct}/${inputs.length}. Keep trying!</span>`;
            }
        }

        function startListening(btn, targetWord) {
             if (!('webkitSpeechRecognition' in window)) {
                alert("Speech recognition not supported in this browser. Try Chrome!");
                return;
            }
            const recognition = new webkitSpeechRecognition();
            recognition.lang = 'en-US';
            
            btn.classList.add('listening');
            
            recognition.onresult = function(event) {
                const spoken = event.results[0][0].transcript.toLowerCase();
                btn.classList.remove('listening');
                
                if(spoken.includes(targetWord.toLowerCase()) || targetWord.toLowerCase().includes(spoken)) {
                    speak('Excellent! Correct!');
                    confetti({particleCount:30, origin:{y:0.7}});
                    btn.style.background = '#dcfce7';
                    btn.style.color = '#15803d';
                } else {
                    speak('Nice try! You said ' + spoken);
                    btn.style.background = '#fee2e2';
                }
            };
            
            recognition.onerror = function() {
                btn.classList.remove('listening');
            };
            recognition.onend = function() {
                btn.classList.remove('listening');
            };
            
            recognition.start();
        }

        function nextDiffRound() {
            if(diffIndex >= diffQuestions.length) diffIndex = 0;
            const q = diffQuestions[diffIndex];
            
            const imgA = document.getElementById('img-a');
            const imgB = document.getElementById('img-b');
            
            if(imgA && imgB) {
                imgA.src = q.imgA;
                imgB.src = q.imgB;
                document.getElementById('diff-sentence').innerText = q.q;
                document.getElementById('diff-feedback').innerText = '';
                
                document.querySelectorAll('.diff-img').forEach(img => {
                    img.classList.remove('selected');
                    img.style.borderColor = 'white';
                    img.style.opacity = '1';
                });
            }
        }
        
        function checkDiffGame(choice) {
            const q = diffQuestions[diffIndex];
            const feedback = document.getElementById('diff-feedback');
            
            if(choice === q.ans) {
                feedback.innerHTML = '<span style="color:#16a34a; font-size:1.5rem;">âœ… Correct! Well done!</span>';
                document.getElementById(choice === 'A' ? 'img-a' : 'img-b').style.borderColor = '#22c55e';
                 confetti({particleCount:50, origin:{y:0.8}});
                 setTimeout(() => {
                     diffIndex++;
                     nextDiffRound();
                 }, 1500);
            } else {
                feedback.innerHTML = '<span style="color:#dc2626; font-size:1.2rem;">âŒ Oops! Try again.</span>';
                document.getElementById(choice === 'A' ? 'img-a' : 'img-b').style.opacity = '0.5';
            }
        }

        // --- LESSON 6 GRAMMAR ---
        function toggleGrammar(container, correctVal) {
             const clicked = event.target;
             if(!clicked.classList.contains('grammar-option')) return;
             
             const txt = clicked.innerText.toLowerCase().replace("'", "").replace("â€™", "");
             const cleanCorrect = correctVal.toLowerCase().replace("'", "");
             
             const allOpts = container.querySelectorAll('.grammar-option');
             allOpts.forEach(o => o.classList.remove('active'));
             clicked.classList.add('active');
             
             if(txt === cleanCorrect) {
                 clicked.style.background = '#22c55e';
                 confetti({particleCount:30, origin:{y:0.6}});
             } else {
                 clicked.style.background = '#ef4444';
             }
        }

        function checkCamp(btn, isCorrect) {
            if(isCorrect) {
                btn.style.background = '#22c55e';
                btn.innerText = 'Correct! âœ…';
                confetti({particleCount:30, origin:{y:0.7}});
            } else {
                btn.style.background = '#ef4444';
                btn.innerText = 'Wrong âŒ';
            }
        }

        // --- LESSON 7 SOCIAL ---
        function checkTF(row, isTrue) {
            if(row.classList.contains('revealed')) return;
            row.classList.add('revealed');
            const icon = row.querySelector('.fb-icon');
            
            if(isTrue) { 
                row.classList.add('correct');
                icon.innerText = 'âœ… True';
                confetti({particleCount:20, origin:{y:0.8}});
            } else { 
                row.classList.add('wrong');
                row.style.borderColor = '#ef4444';
                row.style.background = '#fee2e2';
                row.style.color = '#991b1b';
                icon.innerText = 'âŒ False';
            }
        }

        // --- INIT ---
        window.onload = function() {
            renderVocab();
            startQuiz();
            initLesson5();
        };

        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => {
                s.style.display = 'none';
                s.classList.remove('animate__fadeIn');
            });
            const active = document.getElementById(id);
            if(active) {
                active.style.display = 'block';
                active.classList.add('animate__animated', 'animate__fadeIn');
            }
            
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }

        // --- SPEAK FUNCTION ---
        function speak(text) {
            // Clean text from emojis and special characters
            const cleanText = text.replace(/[^\w\s\.\,\!\?]/g, '').trim();
            if (!cleanText) return;
            
            const utterance = new SpeechSynthesisUtterance(cleanText);
            utterance.lang = 'en-GB'; // British English
            utterance.rate = 0.9;
            speechSynthesis.cancel(); // Stop any current speech
            speechSynthesis.speak(utterance);
        }

        // --- GRADE 4 TESTS ---
        const grade4Tests = {
            learn: {
                pre: [
                    {q: 'What is "Lake" in Arabic? / Ù…Ø§ Ù…Ø¹Ù†Ù‰ Lake Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©ØŸ', options: ['Ø¨ÙØ­ÙŠØ±Ø©', 'Ø¬ÙØ¨ÙÙ„', 'ØµØ­Ø±Ø§Ø¡', 'ØºØ§Ø¨Ø©'], correct: 0},
                    {q: 'Choose the correct word / Ø§Ø®ØªØ± Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: ğŸ”ï¸', options: ['Mountain', 'Island', 'Desert', 'Cave'], correct: 0},
                    {q: 'What is "Ø´Ù„Ø§Ù„" in English? / Ù…Ø§ Ù…Ø¹Ù†Ù‰ Ø´Ù„Ø§Ù„ Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©ØŸ', options: ['Waterfall', 'Lake', 'River', 'Ocean'], correct: 0},
                    {q: 'Where can you find trees? / Ø£ÙŠÙ† ØªØ¬Ø¯ Ø§Ù„Ø£Ø´Ø¬Ø§Ø±ØŸ', options: ['Forest', 'Desert', 'Cave', 'Island'], correct: 0},
                    {q: 'What is "ÙƒÙ‡Ù" in English? / Ù…Ø§ Ù…Ø¹Ù†Ù‰ ÙƒÙ‡ÙØŸ', options: ['Cave', 'Hill', 'Mountain', 'Valley'], correct: 0}
                ],
                post: [
                    {q: 'What is "Ø¬Ø²ÙŠØ±Ø©" in English? / Ù…Ø§ Ù…Ø¹Ù†Ù‰ Ø¬Ø²ÙŠØ±Ø©ØŸ', options: ['Island', 'Lake', 'Ocean', 'River'], correct: 0},
                    {q: 'Choose: A very dry place / Ù…ÙƒØ§Ù† Ø¬Ø§Ù Ø¬Ø¯Ø§Ù‹', options: ['Desert', 'Lake', 'Forest', 'Island'], correct: 0},
                    {q: 'What is "ØªÙÙ„" in English? / Ù…Ø§ Ù…Ø¹Ù†Ù‰ ØªÙ„ØŸ', options: ['Hill', 'Mountain', 'Valley', 'Cave'], correct: 0},
                    {q: 'The planet we live on / Ø§Ù„ÙƒÙˆÙƒØ¨ Ø§Ù„Ø°ÙŠ Ù†Ø¹ÙŠØ´ Ø¹Ù„ÙŠÙ‡', options: ['Earth', 'Moon', 'Sun', 'Star'], correct: 0},
                    {q: 'Water that falls from high / Ù…Ø§Ø¡ ÙŠØ³Ù‚Ø· Ù…Ù† Ø£Ø¹Ù„Ù‰', options: ['Waterfall', 'Rain', 'Lake', 'River'], correct: 0}
                ]
            },
            grammar: {
                pre: [
                    {q: 'I want ___ play outside. / Ø£Ø±ÙŠØ¯ ___ Ø§Ù„Ù„Ø¹Ø¨ Ø¨Ø§Ù„Ø®Ø§Ø±Ø¬', options: ['to', 'ing', 'for', 'at'], correct: 0},
                    {q: 'She forgot ___ bring her book. / Ù†Ø³ÙŠØª ___ ÙƒØªØ§Ø¨Ù‡Ø§', options: ['to', 'ing', 'for', 'with'], correct: 0},
                    {q: 'We enjoy ___ in the park. / Ù†Ø³ØªÙ…ØªØ¹ ___ ÙÙŠ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø©', options: ['playing', 'to play', 'play', 'played'], correct: 0},
                    {q: 'He likes ___ football. / ÙŠØ­Ø¨ ___ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…', options: ['playing', 'to play', 'play', 'plays'], correct: 0},
                    {q: 'They decided ___ go camping. / Ù‚Ø±Ø±ÙˆØ§ ___ Ø§Ù„ØªØ®ÙŠÙŠÙ…', options: ['to', 'ing', 'for', 'on'], correct: 0}
                ],
                post: [
                    {q: 'I love ___ books. / Ø£Ø­Ø¨ ___ Ø§Ù„ÙƒØªØ¨', options: ['reading', 'to read', 'read', 'reads'], correct: 0},
                    {q: 'We plan ___ visit the museum. / Ù†Ø®Ø·Ø· ___ Ø§Ù„Ù…ØªØ­Ù', options: ['to', 'ing', 'for', 'at'], correct: 0},
                    {q: 'She enjoys ___ pictures. / ØªØ³ØªÙ…ØªØ¹ ___ Ø§Ù„ØµÙˆØ±', options: ['drawing', 'to draw', 'draw', 'draws'], correct: 0},
                    {q: 'They hope ___ win the game. / ÙŠØ£Ù…Ù„ÙˆÙ† ___ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©', options: ['to', 'ing', 'for', 'in'], correct: 0},
                    {q: 'He finished ___ his homework. / Ø§Ù†ØªÙ‡Ù‰ Ù…Ù† ___ ÙˆØ§Ø¬Ø¨Ù‡', options: ['doing', 'to do', 'do', 'does'], correct: 0}
                ]
            },
            story: {
                pre: [
                    {q: 'Who spent the day in the countryside? / Ù…Ù† Ù‚Ø¶Ù‰ Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ø±ÙŠÙØŸ', options: ['Layla', 'Ahmed', 'Sara', 'Ali'], correct: 0},
                    {q: 'What did they see at the farm? / Ù…Ø§Ø°Ø§ Ø±Ø£ÙˆØ§ ÙÙŠ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©ØŸ', options: ['Animals', 'Cars', 'Toys', 'Books'], correct: 0},
                    {q: 'Where did they go? / Ø£ÙŠÙ† Ø°Ù‡Ø¨ÙˆØ§ØŸ', options: ['Countryside', 'City', 'Beach', 'Desert'], correct: 0}
                ],
                post: [
                    {q: 'Was it a good day? / Ù‡Ù„ ÙƒØ§Ù† ÙŠÙˆÙ…Ø§Ù‹ Ø¬ÙŠØ¯Ø§Ù‹ØŸ', options: ['Yes', 'No', 'Maybe', 'Unknown'], correct: 0},
                    {q: 'What season was it? / Ø£ÙŠ ÙØµÙ„ ÙƒØ§Ù†ØŸ', options: ['Summer', 'Winter', 'Spring', 'Fall'], correct: 0},
                    {q: 'Did they enjoy the trip? / Ù‡Ù„ Ø§Ø³ØªÙ…ØªØ¹ÙˆØ§ Ø¨Ø§Ù„Ø±Ø­Ù„Ø©ØŸ', options: ['Yes', 'No', 'A little', 'Not sure'], correct: 0}
                ]
            },
            vocab5: {
                pre: [
                    {q: 'Flash cards help you ___ / Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ØªØ³Ø§Ø¹Ø¯Ùƒ Ø¹Ù„Ù‰', options: ['Remember', 'Forget', 'Sleep', 'Eat'], correct: 0},
                    {q: 'A synonym for "big" / Ù…Ø±Ø§Ø¯Ù Ù„ÙƒÙ„Ù…Ø© ÙƒØ¨ÙŠØ±', options: ['Large', 'Small', 'Tiny', 'Little'], correct: 0},
                    {q: 'Opposite of "hot" / Ø¹ÙƒØ³ Ø³Ø§Ø®Ù†', options: ['Cold', 'Warm', 'Cool', 'Fire'], correct: 0}
                ],
                post: [
                    {q: 'Vocabulary means ___ / Vocabulary ØªØ¹Ù†ÙŠ', options: ['Words', 'Numbers', 'Colors', 'Shapes'], correct: 0},
                    {q: 'Synonym for "happy" / Ù…Ø±Ø§Ø¯Ù Ø³Ø¹ÙŠØ¯', options: ['Joyful', 'Sad', 'Angry', 'Tired'], correct: 0},
                    {q: 'Opposite of "old" / Ø¹ÙƒØ³ Ù‚Ø¯ÙŠÙ…', options: ['New', 'Young', 'Ancient', 'Modern'], correct: 0}
                ]
            },
            grammar6: {
                pre: [
                    {q: 'The book is ___ the table. / Ø§Ù„ÙƒØªØ§Ø¨ ___ Ø§Ù„Ø·Ø§ÙˆÙ„Ø©', options: ['on', 'in', 'at', 'to'], correct: 0},
                    {q: 'She lives ___ Riyadh. / ØªØ¹ÙŠØ´ ___ Ø§Ù„Ø±ÙŠØ§Ø¶', options: ['in', 'on', 'at', 'to'], correct: 0},
                    {q: 'We meet ___ 3 PM. / Ù†Ù„ØªÙ‚ÙŠ ___ Ø§Ù„Ø³Ø§Ø¹Ø© 3', options: ['at', 'in', 'on', 'to'], correct: 0}
                ],
                post: [
                    {q: 'The cat is ___ the box. / Ø§Ù„Ù‚Ø·Ø© ___ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚', options: ['in', 'on', 'at', 'to'], correct: 0},
                    {q: 'My birthday is ___ May. / Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯ÙŠ ___ Ù…Ø§ÙŠÙˆ', options: ['in', 'on', 'at', 'to'], correct: 0},
                    {q: 'She arrived ___ Monday. / ÙˆØµÙ„Øª ___ Ø§Ù„Ø§Ø«Ù†ÙŠÙ†', options: ['on', 'in', 'at', 'to'], correct: 0}
                ]
            },
            social7: {
                pre: [
                    {q: 'Where is Qiddiya? / Ø£ÙŠÙ† ØªÙ‚Ø¹ Ø§Ù„Ù‚Ø¯ÙŠØ©ØŸ', options: ['Saudi Arabia', 'UAE', 'Egypt', 'Jordan'], correct: 0},
                    {q: 'What is Dragon Ball? / Ù…Ø§ Ù‡Ùˆ Ø¯Ø±Ø§Ø¬ÙˆÙ† Ø¨ÙˆÙ„ØŸ', options: ['Comic & TV show', 'Game', 'Food', 'Sport'], correct: 0},
                    {q: 'A roller coaster is ___ / Ø§Ù„Ø£ÙØ¹ÙˆØ§Ù†ÙŠØ© Ù‡ÙŠ', options: ['A ride', 'A game', 'Food', 'A book'], correct: 0}
                ],
                post: [
                    {q: 'Is Qiddiya a new city? / Ù‡Ù„ Ø§Ù„Ù‚Ø¯ÙŠØ© Ù…Ø¯ÙŠÙ†Ø© Ø¬Ø¯ÙŠØ¯Ø©ØŸ', options: ['Yes', 'No', 'Maybe', 'Unknown'], correct: 0},
                    {q: 'Theme parks have ___ / Ø­Ø¯Ø§Ø¦Ù‚ Ø§Ù„Ù…Ù„Ø§Ù‡ÙŠ Ø¨Ù‡Ø§', options: ['Rides', 'Books', 'Desks', 'Beds'], correct: 0},
                    {q: 'Who is Goku? / Ù…Ù† Ù‡Ùˆ ØºÙˆÙƒÙˆØŸ', options: ['Character', 'City', 'Food', 'Game'], correct: 0}
                ]
            },
            writing: {
                pre: [
                    {q: 'Which word ends with -og? / Ø£ÙŠ ÙƒÙ„Ù…Ø© ØªÙ†ØªÙ‡ÙŠ Ø¨Ù€ -ogØŸ', options: ['frog', 'train', 'sheep', 'bike'], correct: 0},
                    {q: 'Which ends with -ain? / ØªÙ†ØªÙ‡ÙŠ Ø¨Ù€ -ain', options: ['rain', 'cat', 'nest', 'deep'], correct: 0},
                    {q: '"king" rhymes with ___ / ØªÙ‚Ø§ÙÙŠ Ù…Ø¹', options: ['spring', 'sun', 'gate', 'pool'], correct: 0}
                ],
                post: [
                    {q: 'Complete: The s_n for f_n', options: ['un, un', 'ing, ing', 'ate, ate', 'ool, ool'], correct: 0},
                    {q: 'Which word has -eep? / ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ -eep', options: ['sheep', 'frog', 'bike', 'cat'], correct: 0},
                    {q: 'A blog is for ___ / Ø§Ù„Ù…Ø¯ÙˆÙ†Ø© Ù„Ù€', options: ['Writing', 'Eating', 'Sleeping', 'Running'], correct: 0}
                ]
            }
        };

        // --- TEST FUNCTIONS ---
        function openTest(section, type) {
            const modal = document.getElementById('testModal');
            const title = document.getElementById('testTitle');
            const container = document.getElementById('testQuestions');
            
            title.innerHTML = `${type === 'pre' ? 'Pre-Test ğŸ“‹ Ø§Ø®ØªØ¨Ø§Ø± Ù‚Ø¨Ù„ÙŠ' : 'Post-Test âœ… Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø¹Ø¯ÙŠ'}<br><small style="font-size:1.2rem; color:#666;">${getSectionName(section)}</small>`;
            
            const tests = grade4Tests[section][type];
            container.innerHTML = tests.map((t, i) => `
                <div style="margin-bottom:30px; padding:25px; background:#f8fafc; border-radius:15px; border-left:4px solid var(--primary);">
                    <div style="font-size:1.8rem; font-weight:700; margin-bottom:20px; color:#1e293b; line-height:1.6;">
                        ${i + 1}. ${t.q}
                    </div>
                    <div style="display:grid; gap:12px;">
                        ${t.options.map((opt, idx) => `
                            <button class="quiz-btn" onclick="selectAnswer(${i}, ${idx})" data-qindex="${i}" style="text-align:left; font-size:1.5rem; padding:18px 25px; background:white;">
                                ${String.fromCharCode(65 + idx)}. ${opt}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `).join('');
            
            document.getElementById('submitTest').onclick = () => checkTest(section, type);
            modal.style.display = 'flex';
        }

        let selectedAnswers = {};
        function selectAnswer(qIndex, optIndex) {
            selectedAnswers[qIndex] = optIndex;
            const btns = document.querySelectorAll(`[data-qindex="${qIndex}"]`);
            btns.forEach((b, i) => {
                b.style.background = i === optIndex ? '#d1fae5' : 'white';
                b.style.borderColor = i === optIndex ? '#10b981' : '#e2e8f0';
            });
        }

        function checkTest(section, type) {
            const tests = grade4Tests[section][type];
            let score = 0;
            tests.forEach((t, i) => {
                if (selectedAnswers[i] === t.correct) score++;
            });
            
            const container = document.getElementById('testQuestions');
            const percentage = Math.round((score / tests.length) * 100);
            
            let message = '';
            let emoji = '';
            if (score === tests.length) {
                message = 'ğŸ‰ Ù…Ù…ØªØ§Ø²! Ø¯Ø±Ø¬Ø© ÙƒØ§Ù…Ù„Ø©!<br>Excellent! Perfect Score!';
                emoji = 'ğŸ‰';
                confetti({particleCount: 100, spread: 70, origin: {y: 0.6}});
            } else if (score >= tests.length * 0.7) {
                message = 'ğŸ‘ Ø£Ø­Ø³Ù†Øª! Ø¹Ù…Ù„ Ø¬ÙŠØ¯!<br>Good Job! Well Done!';
                emoji = 'ğŸ‘';
            } else {
                message = 'ğŸ“š Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰<br>Try Again!';
                emoji = 'ğŸ“š';
            }
            
            container.innerHTML = `
                <div style="text-align:center; padding:50px;">
                    <div style="font-size:6rem; margin-bottom:20px;">${emoji}</div>
                    <div style="font-size:3rem; font-weight:800; color:var(--primary); margin-bottom:15px;">
                        ${score}/${tests.length}
                    </div>
                    <div style="font-size:2rem; font-weight:600; color:#64748b; margin-bottom:20px;">
                        ${percentage}%
                    </div>
                    <div style="font-size:1.8rem; line-height:1.8; color:#475569; font-family:'Tajawal', sans-serif;">
                        ${message}
                    </div>
                    <button class="quiz-btn" onclick="closeTestModal()" style="margin-top:30px; font-size:1.5rem; padding:15px 40px;">
                        Ø¥ØºÙ„Ø§Ù‚ / Close
                    </button>
                </div>
            `;
            selectedAnswers = {};
        }

        function closeTestModal() {
            document.getElementById('testModal').style.display = 'none';
        }

        function getSectionName(section) {
            const names = {
                learn: 'Vocabulary', grammar: 'Grammar', story: 'Story',
                vocab5: 'Vocab & Games', grammar6: 'Grammar L6',
                social7: 'Social Studies', writing: 'Writing'
            };
            return names[section] || section;
        }

    </script>
</body>
</html>
