{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Top Goal 6 - Unit 1 | Phonics Game Lab</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #3a0ca3;
            --secondary: #f72585;
            --accent: #4cc9f0;
            --success: #22c55e;
            --bg-color: #f8fafc;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg-color);
            color: #1e293b;
            margin: 0;
            padding-bottom: 100px;
        }

        /* --- Header --- */
        .app-header {
            background: linear-gradient(135deg, #3a0ca3, #7209b7);
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(58, 12, 163, 0.2);
        }

        .header-title {
            font-size: 1.5rem;
            font-weight: 900;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .home-btn {
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
            color: white;
            text-decoration: none;
            transition: background 0.2s;
        }
        .home-btn:hover { background: rgba(255,255,255,0.3); }

        /* --- Layout --- */
        .top-goal-container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 20px;
        }

        /* --- Hero --- */
        .hero-unit {
            background: linear-gradient(120deg, #4361ee, #3a0ca3);
            border-radius: 30px;
            padding: 60px 40px;
            color: white;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(67, 97, 238, 0.3);
            margin-bottom: 50px;
        }

        .hero-title {
            font-size: 3.5rem;
            margin: 0;
            font-weight: 900;
            text-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .hero-subtitle {
            font-size: 1.5rem;
            opacity: 0.9;
            margin-top: 10px;
        }

        /* --- Games Arena --- */
        .games-arena {
            background: white;
            border-radius: 30px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.05);
            margin-bottom: 60px;
        }

        .arena-title {
            text-align: center;
            font-size: 2.2rem;
            color: #3a0ca3;
            margin-bottom: 30px;
            font-weight: 900;
        }

        /* --- Tabs --- */
        .game-tabs {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .game-tab {
            padding: 12px 25px;
            background: #f1f5f9;
            border: none;
            border-radius: 50px;
            font-family: 'Outfit', sans-serif;
            font-weight: 700;
            color: #64748b;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1rem;
        }

        .game-tab.active, .game-tab:hover {
            background: #3a0ca3;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(58, 12, 163, 0.2);
        }

        /* --- Visibility Utility --- */
        .game-panel {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }
        .game-panel.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- Shared Game Elements --- */
        .spin-btn {
            background: linear-gradient(to right, #f72585, #b5179e);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .spin-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(247, 37, 133, 0.3);
        }

        /* --- Memory Game --- */
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            max-width: 800px;
            margin: 0 auto;
        }

        .memory-card {
            aspect-ratio: 1/1;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.5s;
            cursor: pointer;
        }

        .memory-card.flip {
            transform: rotateY(180deg);
        }

        .memory-card.matched {
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.5s;
        }

        .memory-card .front, .memory-card .back {
            width: 100%; height: 100%;
            position: absolute;
            backface-visibility: hidden;
            border-radius: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            font-weight: 700;
        }

        .memory-card .front {
            background: linear-gradient(135deg, #4361ee, #4895ef);
            color: white;
            font-size: 2rem;
        }

        .memory-card .back {
            background: white;
            color: #3a0ca3;
            transform: rotateY(180deg);
            border: 2px solid #4361ee;
            font-size: 1.2rem;
            text-align: center; padding: 5px;
        }

        .emoji-large { font-size: 3.5rem !important; }


        /* --- Scramble Game Redesign (Single Drop Zone) --- */
        .scramble-container {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }
        
        .sentence-drop-zone {
            min-height: 100px;
            border: 3px dashed #cbd5e1;
            border-radius: 20px;
            background: #fff;
            margin-bottom: 30px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: all 0.3s;
        }

        .sentence-drop-zone.drag-over {
            border-color: #d946ef;
            background: #fdf4ff;
        }

        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            min-height: 60px;
        }

        .draggable-word {
            display: inline-block;
            padding: 12px 25px;
            background: white;
            border-radius: 12px;
            font-weight: 700;
            color: #1e293b;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            cursor: grab;
            user-select: none;
            transition: all 0.2s;
            border: 1px solid #e2e8f0;
            font-size: 1.1rem;
            font-family: 'Outfit', sans-serif;
        }
        
        .draggable-word:active {
            cursor: grabbing;
            transform: scale(1.05);
            box-shadow: 0 10px 15px rgba(0,0,0,0.1);
        }

        /* --- Listening Game --- */
        .listening-area { text-align: center; max-width: 600px; margin: 0 auto; }
        .listen-btn-large {
            width: 80px; height: 80px;
            border-radius: 50%;
            background: #f72585;
            color: white;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(247, 37, 133, 0.3);
            margin-bottom: 30px;
            transition: transform 0.2s;
        }
        .listen-btn-large:active { transform: scale(0.95); }
        .listening-options { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        .listening-option {
            background: white; padding: 20px; border-radius: 15px;
            border: 2px solid #e2e8f0; cursor: pointer;
            display: flex; flex-direction: column; alignItems: center; gap: 10px;
            transition: all 0.2s; font-weight: bold;
        }
        .listening-option:hover { border-color: #4cc9f0; transform: translateY(-5px); }
        .listening-option.correct { background: #dcfce7; border-color: #22c55e; color: #15803d; }
        .listening-option.wrong { background: #fee2e2; border-color: #ef4444; color: #b91c1c; }

        /* --- Picture Match Game --- */
        .match-container { display: flex; gap: 30px; justify-content: center; }
        .match-col { display: flex; flex-direction: column; gap: 15px; width: 45%; }
        .match-target {
            background: #f8fafc; border: 3px dashed #cbd5e1; border-radius: 15px;
            padding: 15px; display: flex; align-items: center; gap: 15px;
            transition: all 0.2s;
        }
        .match-target.drag-over { background: #e0f2fe; border-color: #3b82f6; }
        .target-emoji { font-size: 2.5rem; }
        .target-drop-area { flex-grow: 1; font-style: italic; color: #94a3b8; }
        .match-source {
            background: white; padding: 15px; border-radius: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); font-weight: bold;
            cursor: grab; border: 1px solid #e2e8f0; text-align: center;
        }

        /* --- Wheel & Vocab --- */
        .wheel-section { text-align: center; margin-bottom: 60px; }
        .wheel-container {
            width: 300px; height: 300px; background: #e2e8f0;
            border-radius: 50%; margin: 30px auto; position: relative;
            background: conic-gradient(#f72585 0 25%, #7209b7 25% 50%, #3a0ca3 50% 75%, #4cc9f0 75% 100%);
            border: 10px solid white; box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .wheel-arrow {
            position: absolute; top: -20px; left: 50%; transform: translateX(-50%);
            width: 0; height: 0; border-left: 20px solid transparent; border-right: 20px solid transparent;
            border-top: 30px solid #1e293b; z-index: 10;
        }
        .wheel-result { font-size: 1.5rem; font-weight: bold; color: #3a0ca3; min-height: 40px; margin-top: 10px; }

        .vocab-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        .vocab-card {
            background: white; padding: 25px; border-radius: 20px; text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: transform 0.3s;
        }
        .vocab-card:hover { transform: translateY(-10px); }
        .vocab-emoji { font-size: 4rem; display: block; margin-bottom: 10px; }
        .vocab-word { font-size: 1.5rem; font-weight: 800; color: #3a0ca3; }
        .vocab-arabic { color: #64748b; font-family: 'Tajawal', sans-serif; margin-bottom: 15px; }
        .vocab-actions { display: flex; justify-content: center; gap: 10px; }
        .action-btn {
            width: 40px; height: 40px; border-radius: 50%; border: none;
            background: #f1f5f9; color: #334155; cursor: pointer; transition: 0.2s;
        }
        .action-btn:hover { background: #3a0ca3; color: white; }

        /* --- Sentences --- */
        .sentences-section {
            background: white; border-radius: 30px; padding: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); margin-top: 60px;
        }
        .sentence-item {
            display: flex; align-items: center; gap: 20px; background: #f8fafc;
            padding: 20px; border-radius: 20px; margin-bottom: 15px; border: 1px solid #e2e8f0;
            transition: all 0.3s;
        }
        .sentence-item:hover { transform: translateX(10px); background: #fff; border-color: #4cc9f0; }
        .play-sentence-btn {
            width: 50px; height: 50px; border-radius: 50%;
            background: linear-gradient(135deg, #3a0ca3, #7209b7); color: white;
            border: none; cursor: pointer; font-size: 1.2rem;
        }
        .sentence-en { font-size: 1.1rem; font-weight: 700; color: #1e293b; }
        .sentence-ar { font-family: 'Tajawal', sans-serif; color: #64748b; direction: rtl; }

        /* --- Quiz --- */
        .quiz-section { margin: 60px 0 100px 0; }
        .quiz-question-card {
            background: white; padding: 25px; border-radius: 20px; margin-bottom: 25px;
            border-left: 5px solid #4cc9f0; box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .options-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; }
        .option-btn {
            padding: 15px; background: #f8fafc; border: 2px solid #e2e8f0;
            border-radius: 12px; font-weight: 500; cursor: pointer; text-align: left;
        }
        .option-btn:hover { border-color: #4cc9f0; background: #e0f2fe; }
        .option-btn.correct { background: #dcfce7; border-color: #22c55e; color: #15803d; }
        .option-btn.wrong { background: #fee2e2; border-color: #ef4444; color: #b91c1c; }

        /* --- Score & Modal --- */
        .floating-score {
            position: fixed; bottom: 30px; right: 30px; background: white;
            padding: 15px 25px; border-radius: 50px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15); display: flex; align-items: center; gap: 10px;
            z-index: 1000; border: 4px solid #f72585;
        }
        .result-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(5px); z-index: 2000;
            justify-content: center; align-items: center;
        }
        .result-content {
            background: white; padding: 50px; border-radius: 30px; text-align: center; width: 400px;
            animation: popIn 0.4s;
        }
        /* --- Mobile Responsiveness --- */
        @media (max-width: 768px) {
            .hero-title { font-size: 2.5rem; }
            .hero-subtitle { font-size: 1.2rem; }
            .hero-unit { padding: 40px 20px; }
            
            .games-arena { padding: 25px 20px; }
            .arena-title { font-size: 1.8rem; }
            
            .game-tabs { gap: 10px; }
            .game-tab { padding: 10px 15px; font-size: 0.9rem; flex: 1 1 45%; text-align: center; } /* 2 per row */
            
            /* Match Game: Stack columns */
            .match-container { flex-direction: column; }
            .match-col { width: 100%; }
            
            /* Listening Game: 1 column options */
            .listening-options { grid-template-columns: 1fr; }
            
            /* Floating Score: Smaller */
            .floating-score { bottom: 20px; right: 20px; padding: 10px 20px; }
            .score-stars { font-size: 1.2rem; }
            .score-text { font-size: 1.5rem; }
            
            /* Sentences: Stack controls */
            .sentence-item { flex-direction: column; text-align: center; }
            .sentence-ar { font-size: 1rem; }
            
            /* Vocab: Smaller cards */
            .vocab-grid { grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); }
            .vocab-emoji { font-size: 3rem; }
            .vocab-word { font-size: 1.2rem; }
            
            /* Modals */
            .result-content { width: 90%; padding: 30px; }
            
            /* Gap Game */
            .gap-sentence-box { padding: 20px; }
            #gap-sentence { font-size: 1.4rem; }
        }
        
        /* --- Lesson Nav Styles --- */
        .lesson-btn {
            padding: 15px 30px;
            border-radius: 15px;
            border: none;
            background: white;
            color: #64748b;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            display: flex; align-items: center; gap: 10px;
        }
        .lesson-btn.active {
            background: linear-gradient(135deg, #3a0ca3, #4361ee);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(58, 12, 163, 0.2);
        }
        .lesson-section { animation: fadeIn 0.4s ease-out; }

        /* --- Grammar Practice Styles --- */
        .concept-card {
            background: white; padding: 25px; border-radius: 20px;
            margin-bottom: 20px; border: 1px solid #e2e8f0;
            display: flex; justify-content: space-between; align-items: center;
        }
        .toggle-group {
            background: #f1f5f9; padding: 5px; border-radius: 50px;
            display: inline-flex; gap: 5px;
        }
        .toggle-opt {
            padding: 8px 20px; border-radius: 50px; cursor: pointer;
            font-weight: bold; color: #64748b; transition: all 0.2s; border: none; background: transparent;
        }
        .toggle-opt.selected { background: white; color: #3a0ca3; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .toggle-opt.correct { background: #22c55e; color: white; }
        .toggle-opt.wrong { background: #ef4444; color: white; }

        .mcq-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .mcq-card { background: white; padding: 25px; border-radius: 20px; border: 2px solid #f1f5f9; }
        .mcq-q { font-size: 1.1rem; font-weight: bold; margin-bottom: 15px; }
        .mcq-opts { display: flex; flex-direction: column; gap: 10px; }
        .mcq-btn {
            padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px;
            text-align: left; background: transparent; cursor: pointer; font-weight: 500;
            transition: all 0.2s;
        }
        .mcq-btn:hover { border-color: #3b82f6; background: #eff6ff; }
        .mcq-btn.correct { border-color: #22c55e; background: #dcfce7; color: #15803d; }
        .mcq-btn.wrong { border-color: #ef4444; background: #fee2e2; }
    </style>
</head>
<body>

    <header class="app-header">
        <div class="header-title">
            <i class="fas fa-gamepad"></i> Phonics Game Lab
        </div>
        <a href="/" class="home-btn"><i class="fas fa-home"></i> Home</a>
    </header>

    <div class="top-goal-container">
        <!-- Hero Header -->
        <div class="hero-unit">
            <h1 class="hero-title">{{ unit.title|default:"Let's watch a movie!" }}</h1>
            <div class="hero-subtitle">{{ unit.grade|default:"Top Goal 6" }} - Unit {{ unit.unit_number|default:5 }}</div>
        </div>

        {% if error %}
            <div style="text-align:center; padding:50px; color:#ef4444;">
                <h2>‚ö†Ô∏è Error Loading Content</h2>
                <p>Please run the populate command</p>
            </div>
        {% else %}

        <!-- Lesson Navigation -->
        <div style="position: relative; margin-bottom: 40px;">
            <div class="lesson-nav">
                <button class="lesson-btn active" onclick="switchLesson(1)">
                    <i class="fas fa-book-open"></i> Lesson 1: Vocabulary
                </button>
                <button class="lesson-btn" onclick="switchLesson(2)">
                    <i class="fas fa-clock"></i> Lesson 2: Grammar
                </button>
                <button class="lesson-btn" onclick="switchLesson(3)">
                    <i class="fas fa-pen-fancy"></i> Lesson 3: Exercises
                </button>
                <button class="lesson-btn" onclick="switchLesson(4)">
                    <i class="fas fa-book-reader"></i> Lesson 4: Story
                </button>
                <button class="lesson-btn" onclick="switchLesson(5)">
                    <i class="fas fa-headphones"></i> Lesson 5: Listening
                </button>
                <button class="lesson-btn" onclick="switchLesson(6)">
                    <i class="fas fa-theater-masks"></i> Lesson 6: Vocabulary
                </button>
                <button class="lesson-btn" onclick="switchLesson(7)">
                    <i class="fas fa-glasses"></i> Lesson 7: Reading
                </button>
                <button class="lesson-btn" onclick="switchLesson(8)">
                    <i class="fas fa-pencil-alt"></i> Lesson 8: Writing
                </button>
                <button class="lesson-btn" onclick="switchLesson(9)">
                    <i class="fas fa-chart-line"></i> Lesson 9: Story Structure
                </button>
                <button class="lesson-btn" onclick="switchLesson(10)">
                    <i class="fas fa-trophy"></i> Unit Review
                </button>
            </div>
            <!-- Scroll Hint -->
            <div style="text-align: center; margin-top: 10px; color: #94a3b8; font-size: 0.85rem;">
                <i class="fas fa-arrows-alt-h"></i> Scroll horizontally to see all lessons
            </div>
        </div>

        <!-- LESSON 1 CONTENT -->
        <div id="lesson-1" class="lesson-section active">

        <!-- Games Arena -->
        <div class="games-arena">
            <h2 class="arena-title">üéÆ <span>Top Goal Arena</span></h2>
    
            <div class="game-tabs">
                <button class="game-tab active" onclick="switchGame('memory')">üß† Memory Match</button>
                <button class="game-tab" onclick="switchGame('scramble')">‚úçÔ∏è Fill & Write</button>
                <button class="game-tab" onclick="switchGame('listening')">üëÇ Listening</button>
                <button class="game-tab" onclick="switchGame('picture')">üñºÔ∏è Picture Match</button>
                <button class="game-tab" onclick="switchGame('gap')">üß© Gap Fill</button>
            </div>
    
            <!-- Game 1: Memory Match -->
            <div id="memory-game" class="game-panel active">
                <p style="text-align:center; color:#64748b; margin-bottom:20px;">Find the matching pairs: Genre Name + Emoji</p>
                <div class="memory-grid" id="memory-grid"></div>
                <div style="text-align:center; margin-top:20px;">
                    <button class="spin-btn" onclick="initMemoryGame()">Restart Game</button>
                </div>
            </div>
    
            <!-- Game 2: Fill in Blanks (Scramble) - REDESIGNED -->
            <div id="scramble-game" class="game-panel">
                <div style="margin-bottom:20px; text-align:center;">
                    <button class="spin-btn" style="background:#d946ef; font-size:0.9rem; padding:8px 20px;" onclick="initScrambleGame()">Restart Game</button>
                    <p style="color:#64748b; margin-top:10px;">Drag words to build the correct sentence.</p>
                </div>
                
                <div class="scramble-container">
                    <div style="margin-bottom:25px; font-weight:800; color:#7209b7; font-size:1.2rem; direction:rtl;" id="target-translation">...</div>
                    
                    <div class="sentence-drop-zone" id="sentence-drop-zone"></div>
                    <div class="word-bank" id="word-bank"></div>
                    
                    <div style="margin-top:30px; display:flex; justify-content:center; gap:15px;">
                        <button class="spin-btn" onclick="checkSentence()">Check Answer</button>
                        <button class="spin-btn" style="background:#64748b;" onclick="nextSentence()">Next Sentence</button>
                    </div>
                    <div id="sentence-feedback" class="feedback-msg" style="font-weight:bold; margin-top:15px; min-height:24px;"></div>
                </div>
            </div>

            <!-- Game 3: Listening Challenge -->
            <div id="listening-game" class="game-panel">
                <p style="text-align:center; color:#64748b; margin-bottom:20px;">Listen and choose the picture.</p>
                <div class="listening-area">
                    <button class="listen-btn-large" onclick="playCurrentListeningWord()"><i class="fas fa-volume-up"></i></button>
                    <div class="listening-options" id="listening-options"></div>
                    <div id="listening-feedback" class="feedback-msg" style="font-weight:bold; margin-top:15px;"></div>
                </div>
            </div>

            <!-- Game 4: Picture Match -->
            <div id="picture-game" class="game-panel">
                <p style="text-align:center; margin-bottom:20px;">Drag words to pictures.</p>
                <div class="match-container" id="match-container"></div>
                <div style="text-align:center; margin-top:30px;">
                    <div id="match-feedback" style="font-weight:bold; margin-bottom:10px;"></div>
                    <button class="spin-btn" onclick="initPictureMatchGame()">New Round</button>
                </div>
            </div>

            <!-- Game 5: Gap Fill Challenge (NEW) -->
            <div id="gap-game" class="game-panel">
                <p style="text-align:center; color:#64748b; margin-bottom:20px;">Fill in the missing word! Drag or Click.</p>
                <div class="gap-container" style="max-width:800px; margin:0 auto; text-align:center;">
                    <div class="gap-sentence-box" style="background:#fff; padding:30px; border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.05); border:1px solid #e2e8f0;">
                        <div id="gap-sentence" style="font-size:1.8rem; font-weight:bold; color:#1e293b; line-height:1.6; margin-bottom:30px;">
                            <!-- Sentence with blank injected here -->
                        </div>
                    </div>
                    
                    <div class="gap-options" id="gap-options" style="display:flex; justify-content:center; gap:20px; flex-wrap:wrap; margin-top:30px;">
                        <!-- Options injected here -->
                    </div>
                    
                    <div style="margin-top:40px;">
                        <div id="gap-feedback" class="feedback-msg" style="height:30px; font-weight:bold; margin-bottom:15px; font-size:1.2rem;"></div>
                        <button class="spin-btn" onclick="initGapFillGame()">Next Round</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Wheel -->
        <div class="wheel-section">
            <h2 style="color:#7209b7; margin-bottom:20px;">Spin for a Genre!</h2>
            <button class="spin-btn" onclick="spinWheel()">Spin!</button>
            <div class="wheel-container">
                <div class="wheel-arrow"></div>
                <div id="spin-wheel"></div>
            </div>
            <div id="wheel-result" class="wheel-result"></div>
        </div>

        <!-- Vocab Cards -->
        <h2 style="text-align:center; color:#3a0ca3; margin-top:60px;">Vocabulary</h2>
        <div class="vocab-grid">
            {% for word in vocab %}
            <div class="vocab-card" data-word="{{ word.word }}">
                <span class="vocab-emoji">{{ word.emoji }}</span>
                <div class="vocab-word">{{ word.word }}</div>
                <div class="vocab-arabic">{{ word.arabic_meaning }}</div>
                <div class="vocab-actions">
                    <button class="action-btn" onclick="speakText('{{ word.word }}')"><i class="fas fa-volume-up"></i></button>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Sentences -->
        <div class="sentences-section">
            <h2 style="margin-bottom:20px;">üìö Reading & Listening</h2>
            <div class="sentences-list">
                {% for sent in sentences %}
                <div class="sentence-item">
                    <button class="play-sentence-btn" onclick="speakText('{{ sent.english_text|escapejs }}')"><i class="fas fa-play"></i></button>
                    <div class="sentence-content">
                        <div class="sentence-en">{{ sent.english_text }}</div>
                        <div class="sentence-ar">{{ sent.arabic_translation }}</div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Quiz -->
        <div class="quiz-section">
            <h2 style="margin-bottom:20px;">üìù Pop Quiz</h2>
            <div id="quiz-container"></div>
        </div>
        </div> <!-- End Lesson 1 -->

        <!-- LESSON 2 CONTENT: PAST PROGRESSIVE -->
        <div id="lesson-2" class="lesson-section" style="display:none;">
            
            <!-- Grammar Hero -->
            <div class="grammar-hero" style="background:white; border-radius:30px; padding:40px; margin-bottom:40px; text-align:center; box-shadow:0 10px 30px rgba(0,0,0,0.05);">
                <h2 style="color:#7209b7; font-size:2.5rem; margin-bottom:10px;">The Past Progressive</h2>
                <p style="font-size:1.2rem; color:#64748b;">ÿßŸÑŸÖÿßÿ∂Ÿä ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ±: ŸÑŸÑÿ™ÿ≠ÿØÿ´ ÿπŸÜ ÿ£ŸÅÿπÿßŸÑ ŸÉÿßŸÜÿ™ ŸÖÿ≥ÿ™ŸÖÿ±ÿ© ŸÅŸä ÿßŸÑŸÖÿßÿ∂Ÿä</p>
                
                <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:20px; margin-top:30px;">
                    <!-- Rule 1: He/She/It -->
                    <div class="rule-card" style="background:#f0f9ff; border:2px solid #3b82f6; padding:20px; border-radius:20px;">
                        <div style="font-size:1.5rem; font-weight:bold; color:#1e40af;">I / He / She / It</div>
                        <div style="font-size:2rem; font-weight:900; color:#3b82f6; margin:10px 0;">WAS</div>
                        <div style="font-size:1.2rem; color:#64748b;">+ Verb-ing</div>
                        <div style="margin-top:15px; font-style:italic;">"She <b>was watching</b> a movie."</div>
                    </div>
                    
                    <!-- Rule 2: You/We/They -->
                    <div class="rule-card" style="background:#fff7ed; border:2px solid #f97316; padding:20px; border-radius:20px;">
                        <div style="font-size:1.5rem; font-weight:bold; color:#ea580c;">You / We / They</div>
                        <div style="font-size:2rem; font-weight:900; color:#f97316; margin:10px 0;">WERE</div>
                        <div style="font-size:1.2rem; color:#64748b;">+ Verb-ing</div>
                        <div style="margin-top:15px; font-style:italic;">"They <b>were playing</b> games."</div>
                    </div>
                </div>

                <!-- Examples & Audio -->
                <div class="grammar-examples" style="margin-top:40px; text-align:left;">
                    <h3 style="color:#333;">üì¢ Examples (ÿ£ŸÖÿ´ŸÑÿ©)</h3>
                    <div class="example-row" onclick="speakText('I was watching a movie')" style="cursor:pointer; padding:15px; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center;">
                        <span style="font-size:1.1rem;">‚úÖ I <b>was watching</b> a movie.</span>
                        <span style="color:#64748b;">ŸÉŸÜÿ™ ÿ£ÿ¥ÿßŸáÿØ ŸÅŸäŸÑŸÖÿßŸã</span>
                    </div>
                    <div class="example-row" onclick="speakText('They were screaming')" style="cursor:pointer; padding:15px; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center;">
                        <span style="font-size:1.1rem;">‚úÖ They <b>were screaming</b>.</span>
                        <span style="color:#64748b;">ŸÉÿßŸÜŸàÿß Ÿäÿµÿ±ÿÆŸàŸÜ</span>
                    </div>
                    <div class="example-row" onclick="speakText('We were not singing')" style="cursor:pointer; padding:15px; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center;">
                        <span style="font-size:1.1rem;">‚ùå We <b>were not</b> singing.</span>
                        <span style="color:#64748b;">ŸÑŸÖ ŸÜŸÉŸÜ ŸÜÿ∫ŸÜŸä</span>
                    </div>
                </div>
            </div>

            <!-- Grammar Game 1: Was or Were? -->
            <div class="game-panel active" style="margin-bottom:40px;">
                <h2 style="text-align:center; color:#3a0ca3; margin-bottom:20px;">üöÄ Challenge 1: Was or Were?</h2>
                <div id="was-were-game" style="text-align:center; background:white; padding:40px; border-radius:30px; box-shadow:0 10px 30px rgba(0,0,0,0.05);">
                    <div id="ww-question" style="font-size:2rem; font-weight:bold; margin-bottom:30px;">She ______ reading.</div>
                    <div style="display:flex; justify-content:center; gap:20px;">
                        <button class="spin-btn" style="width:150px; font-size:1.5rem;" onclick="checkWasWere('was')">WAS</button>
                        <button class="spin-btn" style="width:150px; font-size:1.5rem; background:#4cc9f0;" onclick="checkWasWere('were')">WERE</button>
                    </div>
                    <div id="ww-feedback" style="margin-top:20px; font-weight:bold; height:30px; font-size:1.2rem;"></div>
                </div>
            </div>

            <!-- Grammar Game 2: Reorder -->
            <div class="game-panel active">
                <h2 style="text-align:center; color:#3a0ca3; margin-bottom:20px;">üß© Challenge 2: Build the Sentence</h2>
                <div class="gap-container" style="max-width:800px; margin:0 auto; text-align:center;">
                    <div id="grammar-scramble-area" style="background:white; padding:30px; border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.05);">
                         <p style="color:#64748b; margin-bottom:20px;">Make a Past Progressive sentence.</p>
                         <div id="grammar-drop-zone" class="sentence-drop-zone" style="min-height:80px;"></div>
                         <div id="grammar-bank" class="word-bank"></div>
                         <div style="margin-top:20px;">
                            <button class="spin-btn" onclick="checkGrammarOrder()">Check</button>
                            <button class="spin-btn" style="background:#64748b" onclick="initGrammarScramble()">Next</button>
                         </div>
                         <div id="grammar-feedback" class="feedback-msg" style="margin-top:15px; font-weight:bold;"></div>
                    </div>
                </div>
            </div>

            <!-- New Activity 3: Concept Check (Reading) -->
            <div class="game-panel active" style="margin-top:40px;">
                <h2 style="text-align:center; color:#3a0ca3; margin-bottom:20px;">üìñ Activity 3: Read & Circle</h2>
                <div style="max-width:800px; margin:0 auto;">
                    <div class="concept-card">
                        <div>
                            <span>1. The "Past Progressive" talks about actions in the:</span>
                        </div>
                        <div class="toggle-group" id="concept-1">
                            <button class="toggle-opt" onclick="checkConcept(this, 'correct')">Past</button>
                            <button class="toggle-opt" onclick="checkConcept(this, 'wrong')">Future</button>
                        </div>
                    </div>
                    <div class="concept-card">
                        <div>
                            <span>2. These actions are usually:</span>
                        </div>
                        <div class="toggle-group" id="concept-2">
                            <button class="toggle-opt" onclick="checkConcept(this, 'wrong')">Short</button>
                            <button class="toggle-opt" onclick="checkConcept(this, 'correct')">Long / Continuous</button>
                        </div>
                    </div>
                    <div class="concept-card">
                        <div>
                            <span>3. We form it using:</span>
                        </div>
                        <div class="toggle-group" id="concept-3">
                            <button class="toggle-opt" onclick="checkConcept(this, 'wrong')">Verb + s</button>
                            <button class="toggle-opt" onclick="checkConcept(this, 'correct')">Was/Were + Verbing</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- New Activity 4: Grammar Master Quiz (MCQ) -->
            <div class="game-panel active" style="margin-top:40px;">
                <h2 style="text-align:center; color:#3a0ca3; margin-bottom:20px;">‚úÖ Activity 4: Grammar Master</h2>
                <div class="mcq-container">
                    <div class="mcq-card">
                        <div class="mcq-q">1. They ______ watching TV.</div>
                        <div class="mcq-opts">
                            <button class="mcq-btn" onclick="checkMCQ(this, false)">was</button>
                            <button class="mcq-btn" onclick="checkMCQ(this, true)">were</button>
                            <button class="mcq-btn" onclick="checkMCQ(this, false)">are</button>
                        </div>
                    </div>
                    <div class="mcq-card">
                        <div class="mcq-q">2. I was ______ to music.</div>
                        <div class="mcq-opts">
                            <button class="mcq-btn" onclick="checkMCQ(this, false)">listen</button>
                            <button class="mcq-btn" onclick="checkMCQ(this, false)">listened</button>
                            <button class="mcq-btn" onclick="checkMCQ(this, true)">listening</button>
                        </div>
                    </div>
                    <div class="mcq-card">
                        <div class="mcq-q">3. ______ she sleeping?</div>
                        <div class="mcq-opts">
                            <button class="mcq-btn" onclick="checkMCQ(this, true)">Was</button>
                            <button class="mcq-btn" onclick="checkMCQ(this, false)">Were</button>
                            <button class="mcq-btn" onclick="checkMCQ(this, false)">Did</button>
                        </div>
                    </div>
                    <div class="mcq-card">
                        <div class="mcq-q">4. We ______ not playing.</div>
                        <div class="mcq-opts">
                            <button class="mcq-btn" onclick="checkMCQ(this, false)">was</button>
                            <button class="mcq-btn" onclick="checkMCQ(this, true)">were</button>
                            <button class="mcq-btn" onclick="checkMCQ(this, false)">did</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- New Activity 5: Rule Match -->
            <div class="game-panel active" style="margin-top:40px; text-align:center;">
                <h2 style="color:#3a0ca3; margin-bottom:20px;">üîó Activity 5: Match the Rules</h2>
                <p style="color:#64748b; margin-bottom:20px;">Drag the blue items to the correct orange box.</p>
                <div class="match-container" id="rule-match-container"></div>
                <div style="margin-top:20px; font-weight:bold; height:30px;" id="rule-feedback"></div>
                <button class="spin-btn" style="margin-top:10px;" onclick="initRuleMatch()">Restart Match</button>
            </div>

        </div> <!-- End Lesson 2 -->

        <!-- LESSON 3: GRAMMAR EXERCISES -->
        <div id="lesson-3" class="lesson-section" style="display:none;">
            <div style="background:white; border-radius:30px; padding:40px; box-shadow:0 10px 30px rgba(0,0,0,0.05); margin-bottom:40px;">
                <h2 style="color:#7209b7; font-size:2.2rem; margin-bottom:20px; text-align:center;">üìù Grammar Exercises</h2>
                <p style="text-align:center; color:#64748b; margin-bottom:40px;">Practice the Past Progressive tense with interactive exercises.</p>

                <!-- Exercise 1: Read and Complete -->
                <div class="exercise-section" style="margin-bottom:50px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">4</span>
                        Read and complete.
                    </h3>
                    
                    <div id="fill-blanks-container" style="background:#f8fafc; padding:30px; border-radius:20px; border:2px solid #e2e8f0;">
                        <!-- Question 1 -->
                        <div class="fill-question" style="margin-bottom:25px; padding:20px; background:white; border-radius:15px;">
                            <p style="font-size:1.1rem; line-height:1.8; color:#1e293b;">
                                Hi! Why didn't you answer when I 
                                <select class="fill-select" data-answer="called" style="padding:8px 15px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem; margin:0 5px;">
                                    <option value="">_____</option>
                                    <option value="call">call</option>
                                    <option value="called">called</option>
                                    <option value="calling">calling</option>
                                </select>
                                (call) yesterday?
                                <br>I'm sorry! I 
                                <select class="fill-select" data-answer="was watching" style="padding:8px 15px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem; margin:0 5px;">
                                    <option value="">_____</option>
                                    <option value="watch">watch</option>
                                    <option value="was watching">was watching</option>
                                    <option value="watched">watched</option>
                                </select>
                                (watch) a movie!
                            </p>
                            <div class="translation" style="color:#64748b; font-style:italic; margin-top:10px;">ŸÖÿ±ÿ≠ÿ®ÿßŸã! ŸÑŸÖÿßÿ∞ÿß ŸÑŸÖ ÿ™ÿ±ÿØ ÿπŸÜÿØŸÖÿß ÿßÿ™ÿµŸÑÿ™ ÿ®ŸÉ ÿ£ŸÖÿ≥ÿü ÿ£ŸÜÿß ÿ¢ÿ≥ŸÅ! ŸÉŸÜÿ™ ÿ£ÿ¥ÿßŸáÿØ ŸÅŸäŸÑŸÖÿßŸã!</div>
                        </div>

                        <!-- Question 2 -->
                        <div class="fill-question" style="margin-bottom:25px; padding:20px; background:white; border-radius:15px;">
                            <p style="font-size:1.1rem; line-height:1.8; color:#1e293b;">
                                Oh great! What 
                                <select class="fill-select" data-answer="were" style="padding:8px 15px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem; margin:0 5px;">
                                    <option value="">_____</option>
                                    <option value="was">was</option>
                                    <option value="were">were</option>
                                    <option value="is">is</option>
                                </select>
                                you 
                                <select class="fill-select" data-answer="watching" style="padding:8px 15px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem; margin:0 5px;">
                                    <option value="">_____</option>
                                    <option value="watch">watch</option>
                                    <option value="watching">watching</option>
                                    <option value="watched">watched</option>
                                </select>
                               (watch)?
                            </p>
                            <div class="translation" style="color:#64748b; font-style:italic; margin-top:10px;">ÿ±ÿßÿ¶ÿπ! ŸÖÿßÿ∞ÿß ŸÉŸÜÿ™ ÿ™ÿ¥ÿßŸáÿØÿü</div>
                        </div>

                        <!-- More questions... -->
                        <div class="fill-question" style="margin-bottom:25px; padding:20px; background:white; border-radius:15px;">
                            <p style="font-size:1.1rem; line-height:1.8; color:#1e293b;">
                                Why 
                                <select class="fill-select" data-answer="were" style="padding:8px 15px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem; margin:0 5px;">
                                    <option value="">_____</option>
                                    <option value="was">was</option>
                                    <option value="were">were</option>
                                    <option value="did">did</option>
                                </select>
                                you 
                                <select class="fill-select" data-answer="working" style="padding:8px 15px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem; margin:0 5px;">
                                    <option value="">_____</option>
                                    <option value="work">work</option>
                                    <option value="working">working</option>
                                    <option value="worked">worked</option>
                                </select>
                                (work) on my project and needed some help.
                            </p>
                            <div class="translation" style="color:#64748b; font-style:italic; margin-top:10px;">ŸÑŸÖÿßÿ∞ÿßÿü ŸÉŸÜÿ™ ÿ£ÿπŸÖŸÑ ÿπŸÑŸâ ŸÖÿ¥ÿ±ŸàÿπŸä Ÿàÿßÿ≠ÿ™ÿ¨ÿ™ ÿ®ÿπÿ∂ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©.</div>
                        </div>

                        <div style="text-align:center; margin-top:30px;">
                            <button class="spin-btn" onclick="checkFillBlanks()" style="padding:15px 40px; font-size:1.1rem;">Check Answers</button>
                        </div>
                        <div id="fill-feedback" style="margin-top:20px; font-weight:bold; text-align:center; min-height:30px;"></div>
                    </div>
                </div>

                <!-- Exercise 2: Look, Find, and Write -->
                <div class="exercise-section" style="margin-bottom:50px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">5</span>
                        Look, find, and write.
                    </h3>

                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:30px; align-items:center;">
                        <!-- Picture side -->
                        <div>
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 300'%3E%3Crect fill='%2393c5fd' width='400' height='300'/%3E%3Ctext x='200' y='150' font-size='18' text-anchor='middle' fill='%231e293b'%3Eüé™ Park Scene: People doing activities%3C/text%3E%3C/svg%3E" alt="Park scene" style="width:100%; border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.1);"/>
                            <p style="text-align:center; color:#64748b; margin-top:15px; font-size:0.95rem;">Look at the picture. Find people doing these activities.</p>
                        </div>

                        <!-- Questions side -->
                        <div>
                            <div id="look-find-container">
                                <!-- Q1 -->
                                <div class="look-question" style="margin-bottom:20px; padding:15px; background:#f8fafc; border-radius:12px;">
                                    <p style="margin-bottom:10px; font-weight:600; color:#334155;">1. You / cover / ears</p>
                                    <input type="text" class="look-input" data-answer="you were covering your ears" placeholder="Write the sentence..." style="width:100%; padding:12px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem;"/>
                                    <div class="hint" style="font-size:0.85rem; color:#64748b; margin-top:5px;">üí° Hint: Use Past Progressive (were + verb-ing)</div>
                                </div>

                                <!-- Q2 -->
                                <div class="look-question" style="margin-bottom:20px; padding:15px; background:#f8fafc; border-radius:12px;">
                                    <p style="margin-bottom:10px; font-weight:600; color:#334155;">2. They / buy / tickets / musical</p>
                                    <input type="text" class="look-input" data-answer="they were buying tickets for a musical" placeholder="Write the sentence..." style="width:100%; padding:12px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem;"/>
                                </div>

                                <!-- Q3 -->
                                <div class="look-question" style="margin-bottom:20px; padding:15px; background:#f8fafc; border-radius:12px;">
                                    <p style="margin-bottom:10px; font-weight:600; color:#334155;">3. She / walk / path</p>
                                    <input type="text" class="look-input" data-answer="she was walking on a path" placeholder="Write the sentence..." style="width:100%; padding:12px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem;"/>
                                </div>

                                <div style="text-align:center; margin-top:25px;">
                                    <button class="spin-btn" onclick="checkLookFind()" style="padding:12px 35px;">Check Answers</button>
                                </div>
                                <div id="look-feedback" style="margin-top:15px; font-weight:bold; text-align:center;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exercise 3: Play a Game with Partner -->
                <div class="exercise-section">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">6</span>
                        Play a game with your partner.
                    </h3>

                    <div style="background:linear-gradient(135deg, #ddd6fe, #e9d5ff); padding:35px; border-radius:20px; text-align:center;">
                        <p style="font-size:1.2rem; margin-bottom:20px; color:#4c1d95; font-weight:600;">üé≤ Guessing Game</p>
                        <p style="color:#6b21a8; margin-bottom:25px; line-height:1.6;">
                            ‚Ä¢ Ask your partner: "What were you doing at ... o'clock?"<br>
                            ‚Ä¢ Your partner acts out what they were doing.<br>
                            ‚Ä¢ You guess!
                        </p>

                        <div style="display:flex; gap:20px; justify-content:center; flex-wrap:wrap; margin-top:30px;">
                            <div class="example-bubble" style="background:white; padding:20px; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.1); flex:1; min-width:250px;">
                                <p style="color:#7c3aed; font-weight:bold; margin-bottom:10px;">üí¨ Example Question:</p>
                                <p style="font-style:italic; color:#334155;">"Show me: What were you doing at 5 o'clock?"</p>
                            </div>
                            <div class="example-bubble" style="background:white; padding:20px; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.1); flex:1; min-width:250px;">
                                <p style="color:#7c3aed; font-weight:bold; margin-bottom:10px;">‚úÖ Example Answer:</p>
                                <p style="font-style:italic; color:#334155;">"Oh! I know! You were sleeping!"</p>
                            </div>
                        </div>

                        <button class="spin-btn" onclick="speakText('What were you doing at 5 o\'clock? Yes! I was watching a movie!')" style="margin-top:25px; background:linear-gradient(135deg, #8b5cf6, #7c3aed);">
                            üîä Hear Example
                        </button>
                    </div>
                </div>
            </div>
        </div> <!--End Lesson 3 -->

        <!-- LESSON 4: READING - STORY -->
        <div id="lesson-4" class="lesson-section" style="display:none;">
            <div style="background:white; border-radius:30px; padding:40px; box-shadow:0 10px 30px rgba(0,0,0,0.05); margin-bottom:40px;">
                <h2 style="color:#7209b7; font-size:2.2rem; margin-bottom:20px; text-align:center;">üìñ Reading Story</h2>
                <p style="text-align:center; color:#64748b; margin-bottom:40px;">Read "The Book Presentation" and answer the questions.</p>

                <!-- Vocabulary Section -->
                <div style="background:linear-gradient(135deg, #e0f2fe, #dbeafe); padding:35px; border-radius:20px; margin-bottom:40px;">
                    <h3 style="color:#0369a1; margin-bottom:25px; text-align:center;">üìö Vocabulary - Key Words</h3>
                    <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:20px;">
                        <div class="vocab-item" style="background:white; padding:20px; border-radius:15px; text-align:center; cursor:pointer;" onclick="speakText('presentation')">
                            <div style="font-size:2.5rem; margin-bottom:10px;">üìä</div>
                            <div style="font-size:1.3rem; font-weight:bold; color:#0369a1; margin-bottom:5px;">presentation</div>
                            <div style="color:#64748b; font-size:0.95rem;">ÿπÿ±ÿ∂ ÿ™ŸÇÿØŸäŸÖŸä</div>
                            <button class="icon-btn" onclick="speakText('presentation'); event.stopPropagation();" style="margin-top:10px;">üîä</button>
                        </div>
                        <div class="vocab-item" style="background:white; padding:20px; border-radius:15px; text-align:center; cursor:pointer;" onclick="speakText('bookcase')">
                            <div style="font-size:2.5rem; margin-bottom:10px;">üìö</div>
                            <div style="font-size:1.3rem; font-weight:bold; color:#0369a1; margin-bottom:5px;">bookcase</div>
                            <div style="color:#64748b; font-size:0.95rem;">ÿÆÿ≤ÿßŸÜÿ© ŸÉÿ™ÿ®</div>
                            <button class="icon-btn" onclick="speakText('bookcase'); event.stopPropagation();" style="margin-top:10px;">üîä</button>
                        </div>
                        <div class="vocab-item" style="background:white; padding:20px; border-radius:15px; text-align:center; cursor:pointer;" onclick="speakText('mystery')">
                            <div style="font-size:2.5rem; margin-bottom:10px;">üïµÔ∏è</div>
                            <div style="font-size:1.3rem; font-weight:bold; color:#0369a1; margin-bottom:5px;">mystery</div>
                            <div style="color:#64748b; font-size:0.95rem;">ŸÑÿ∫ÿ≤ / ÿ∫ŸÖŸàÿ∂</div>
                            <button class="icon-btn" onclick="speakText('mystery'); event.stopPropagation();" style="margin-top:10px;">üîä</button>  
                        </div>
                        <div class="vocab-item" style="background:white; padding:20px; border-radius:15px; text-align:center; cursor:pointer;" onclick="speakText('documentary')">
                            <div style="font-size:2.5rem; margin-bottom:10px;">üé¨</div>
                            <div style="font-size:1.3rem; font-weight:bold; color:#0369a1; margin-bottom:5px;">documentary</div>
                            <div style="color:#64748b; font-size:0.95rem;">ŸÅŸäŸÑŸÖ Ÿàÿ´ÿßÿ¶ŸÇŸä</div>
                            <button class="icon-btn" onclick="speakText('documentary'); event.stopPropagation();" style="margin-top:10px;">üîä</button>
                        </div>
                        <div class="vocab-item" style="background:white; padding:20px; border-radius:15px; text-align:center; cursor:pointer;" onclick="speakText('fairy tale')">
                            <div style="font-size:2.5rem; margin-bottom:10px;">üßö</div>
                            <div style="font-size:1.3rem; font-weight:bold; color:#0369a1; margin-bottom:5px;">fairy tale</div>
                            <div style="color:#64748b; font-size:0.95rem;">ŸÇÿµÿ© ÿÆŸäÿßŸÑŸäÿ©</div>
                            <button class="icon-btn" onclick="speakText('fairy tale'); event.stopPropagation();" style="margin-top:10px;">üîä</button>
                        </div>
                        <div class="vocab-item" style="background:white; padding:20px; border-radius:15px; text-align:center; cursor:pointer;" onclick="speakText('excited')">
                            <div style="font-size:2.5rem; margin-bottom:10px;">üéâ</div>
                            <div style="font-size:1.3rem; font-weight:bold; color:#0369a1; margin-bottom:5px;">excited</div>
                            <div style="color:#64748b; font-size:0.95rem;">ŸÖÿ™ÿ≠ŸÖÿ≥ / ŸÖÿ™ÿ¥ŸàŸÇ</div>
                            <button class="icon-btn" onclick="speakText('excited'); event.stopPropagation();" style="margin-top:10px;">üîä</button>
                        </div>
                    </div>
                </div>

                <!-- Story Section -->
                <div style="background:linear-gradient(135deg, #ede9fe, #fae8ff); padding:40px; border-radius:20px; margin-bottom:40px;">
                    <h3 style="color:#6b21a8; text-align:center; margin-bottom:30px; font-size:1.8rem;">üìï The Book Presentation</h3>
                    
                    <div style="background:white; padding:30px; border-radius:15px; line-height:1.9; font-size:1.05rem; color:#334155;">
                        <p style="margin-bottom:18px;">
                            Connor and Kai were arguing. They only had two days until their <strong>presentation</strong>, and they were not prepared.
                        </p>
                        <p style="margin-bottom:18px;">
                            "I have an idea. Kai, we should present a book," said Connor.
                        </p>
                        <p style="margin-bottom:18px;">
                            "I was reading this one last summer ‚Äì it's a <strong>fairy tale</strong>." But Connor didn't like books. He preferred watching movies.
                        </p>
                        <p style="margin-bottom:18px;">
                            "I have an idea too, Kai." He took out a book from the <strong>bookcase</strong> and showed it to Connor. Kai looked at the cover. He liked <strong>mystery</strong> movies, and the book looked like one.
                        </p>
                        <p style="margin-bottom:18px;">
                            "I have read it. There is a drama about the same story, and there is a <strong>documentary</strong> about it. You should watch the documentary and see what you think," Connor said.
                        </p>
                        <p style="margin-bottom:0;">
                            When Connor came to school the next day, he was smiling. "I loved the documentary! I decided to read the book!" Kai was happy they found a book that Connor was interested in. The book presentation was getting <strong>excited</strong> about the project, he said.
                        </p>
                    </div>

                    <div style="text-align:center; margin-top:25px;">
                        <button class="spin-btn" onclick="speakText('The Book Presentation. Connor and Kai were arguing. They only had two days until their presentation, and they were not prepared.')" style="background:linear-gradient(135deg, #8b5cf6, #7c3aed);">
                            üîä Listen to Story
                        </button>
                    </div>
                </div>

                <!-- Comprehension Questions -->
                <div style="margin-bottom:40px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; font-size:1.5rem;">‚ùì Comprehension Questions</h3>
                    
                    <div id="story-questions">
                        <!-- Q1 -->
                        <div class="story-q" style="margin-bottom:25px; padding:25px; background:#f8fafc; border-radius:15px; border-left:4px solid #3a0ca3;">
                            <p style="font-weight:600; margin-bottom:15px; color:#1e293b; font-size:1.1rem;">1. What were Kai and Connor doing for homework?</p>
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                                <button class="story-option" data-answer="false" onclick="checkStoryAnswer(this)" style="padding:15px; background:white; border:2px solid #e2e8f0; border-radius:10px; cursor:pointer; transition:all 0.2s;">
                                    üìù Preparing for a test
                                </button>
                                <button class="story-option" data-answer="true" onclick="checkStoryAnswer(this)" style="padding:15px; background:white; border:2px solid #e2e8f0; border-radius:10px; cursor:pointer; transition:all 0.2s;">
                                    ‚úÖ Preparing a presentation
                                </button>
                                <button class="story-option" data-answer="false" onclick="checkStoryAnswer(this)" style="padding:15px; background:white; border:2px solid #e2e8f0; border-radius:10px; cursor:pointer; transition:all 0.2s;">
                                    ‚úçÔ∏è Writing a story
                                </button>
                                <button class="story-option" data-answer="false" onclick="checkStoryAnswer(this)" style="padding:15px; background:white; border:2px solid #e2e8f0; border-radius:10px; cursor:pointer; transition:all 0.2s;">
                                    üìñ Reading a book
                                </button>
                            </div>
                            <div class="explanation" style="margin-top:15px; padding:15px; background:#dcfce7; border-radius:10px; display:none; border-left:4px solid #22c55e;">
                                <strong style="color:#059669;">‚úì Correct!</strong> They were preparing a presentation (they only had two days left).
                                <br><span style="color:#64748b; font-style:italic; margin-top:5px; display:block;">ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿßŸÑÿµÿ≠Ÿäÿ≠ÿ©: ŸÉÿßŸÜŸàÿß Ÿäÿ≠ÿ∂ÿ±ŸàŸÜ ÿπÿ±ÿ∂ÿßŸã ÿ™ŸÇÿØŸäŸÖŸäÿßŸã</span>
                            </div>
                        </div>

                        <!-- Q2 -->
                        <div class="story-q" style="margin-bottom:25px; padding:25px; background:#f8fafc; border-radius:15px; border-left:4px solid #3a0ca3;">
                            <p style="font-weight:600; margin-bottom:15px; color:#1e293b; font-size:1.1rem;">2. Why weren't Kai and Connor happy at the start of the story?</p>
                            <div style="display:grid; grid-template-columns:1fr; gap:12px;">
                                <button class="story-option" data-answer="false" onclick="checkStoryAnswer(this)" style="padding:15px; background:white; border:2px solid #e2e8f0; border-radius:10px; cursor:pointer;">
                                    They lost their books
                                </button>
                                <button class="story-option" data-answer="true" onclick="checkStoryAnswer(this)" style="padding:15px; background:white; border:2px solid #e2e8f0; border-radius:10px; cursor:pointer;">
                                    ‚úÖ They were arguing and not prepared
                                </button>
                                <button class="story-option" data-answer="false" onclick="checkStoryAnswer(this)" style="padding:15px; background:white; border:2px solid #e2e8f0; border-radius:10px; cursor:pointer;">
                                    They didn't like each other
                                </button>
                            </div>
                            <div class="explanation" style="margin-top:15px; padding:15px; background:#dcfce7; border-radius:10px; display:none; border-left:4px solid #22c55e;">
                                <strong style="color:#059669;">‚úì Perfect!</strong> They were arguing because they only had two days left and weren't prepared.
                                <br><span style="color:#64748b; font-style:italic; margin-top:5px; display:block;">ÿßŸÑÿ≥ÿ®ÿ®: ŸÉÿßŸÜŸàÿß Ÿäÿ™ÿ¨ÿßÿØŸÑÿßŸÜ ŸàŸÑŸÖ ŸäŸÉŸàŸÜŸàÿß ŸÖÿ≥ÿ™ÿπÿØŸäŸÜ</span>
                            </div>
                        </div>

                        <!-- Q3 -->
                        <div class="story-q" style="margin-bottom:25px padding:25px; background:#f8fafc; border-radius:15px; border-left:4px solid #3a0ca3;">
                            <p style="font-weight:600; margin-bottom:15px; color:#1e293b; font-size:1.1rem;">3. What was Connor doing the night before?</p>
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                                <button class="story-option" data-answer="true" onclick="checkStoryAnswer(this)" style="padding:15px; background:white; border:2px solid #e2e8f0; border-radius:10px; cursor:pointer;">
                                    ‚úÖ Watching a documentary
                                </button>
                                <button class="story-option" data-answer="false" onclick="checkStoryAnswer(this)" style="padding:15px; background:white; border:2px solid #e2e8f0; border-radius:10px; cursor:pointer;">
                                    Playing video games
                                </button>
                            </div>
                            <div class="explanation" style="margin-top:15px; padding:15px; background:#dcfce7; border-radius:10px; display:none; border-left:4px solid #22c55e;">
                                <strong style="color:#059669;">‚úì Excellent!</strong> Connor was watching the documentary that Kai recommended.
                            </div>
                        </div>

                        <div style="text-align:center; margin-top:35px;">
                            <div id="story-score" style="font-size:1.5rem; font-weight:bold; margin-bottom:20px; color:#7c3aed;"></div>
                        </div>
                    </div>
                </div>

                <!-- Social and Emotional Learning -->
                <div style="background:linear-gradient(135deg, #fef3c7, #fde68a); padding:35px; border-radius:20px;">
                    <h3 style="color:#92400e; margin-bottom:20px; font-size:1.5rem;">üíö Social and Emotional Learning</h3>
                    <p style="margin-bottom:20px; color:#78350f; font-size:1.05rem;">Discuss these questions with your partner:</p>
                    
                    <div style="display:grid; gap:15px;">
                        <div style="background:white; padding:20px; border-radius:12px; border-left:4px solid #f59e0b;">
                            <strong style="color:#d97706;">1.</strong> How well do you work with others?
                            <p style="color:#64748b; font-size:0.9rem; margin-top:5px;">ŸÖÿß ŸÖÿØŸâ ÿ¨ŸàÿØÿ© ÿπŸÖŸÑŸÉ ŸÖÿπ ÿßŸÑÿ¢ÿÆÿ±ŸäŸÜÿü</p>
                        </div>
                        <div style="background:white; padding:20px; border-radius:12px; border-left:4px solid #f59e0b;">
                            <strong style="color:#d97706;">2.</strong> What can go wrong in group work?
                            <p style="color:#64748b; font-size:0.9rem; margin-top:5px;">ŸÖÿß ÿßŸÑÿ∞Ÿä ŸäŸÖŸÉŸÜ ÿ£ŸÜ Ÿäÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿπŸÖŸÑ ÿßŸÑÿ¨ŸÖÿßÿπŸäÿü</p>
                        </div>
                        <div style="background:white; padding:20px; border-radius:12px; border-left:4px solid #f59e0b;">
                            <strong style="color:#d97706;">3.</strong> What do you still need to learn?
                            <p style="color:#64748b; font-size:0.9rem; margin-top:5px;">ŸÖÿßÿ∞ÿß ŸÑÿß ÿ™ÿ≤ÿßŸÑ ÿ®ÿ≠ÿßÿ¨ÿ© ŸÑÿ™ÿπŸÑŸÖŸáÿü</p>
                        </div>
                        <div style="background:white; padding:20px; border-radius:12px; border-left:4px solid #f59e0b;">
                            <strong style="color:#d97706;">4.</strong> How can you help others succeed?
                            <p style="color:#64748b; font-size:0.9rem; margin-top:5px;">ŸÉŸäŸÅ ŸäŸÖŸÉŸÜŸÉ ŸÖÿ≥ÿßÿπÿØÿ© ÿßŸÑÿ¢ÿÆÿ±ŸäŸÜ ÿπŸÑŸâ ÿßŸÑŸÜÿ¨ÿßÿ≠ÿü</p>
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- End Lesson 4 -->

        <!-- LESSON 5: LISTENING AND SPEAKING -->
        <div id="lesson-5" class="lesson-section" style="display:none;">
            <div style="background:white; border-radius:30px; padding:40px; box-shadow:0 10px 30px rgba(0,0,0,0.05); margin-bottom:40px;">
                <h2 style="color:#7209b7; font-size:2.2rem; margin-bottom:20px; text-align:center;">üéß Listening and Speaking</h2>
                <p style="text-align:center; color:#64748b; margin-bottom:40px;">Listen to the story and complete the exercises.</p>

                <!-- Exercise 1: Look and Predict -->
                <div style="margin-bottom:50px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">1</span>
                        Look and predict the story. Then listen and check.
                    </h3>

                    <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:20px; margin-bottom:25px;">
                        <div style="background:#f8fafc; padding:20px; border-radius:15px; text-align:center; border:2px solid #e2e8f0;">
                            <div style="font-size:4rem; margin-bottom:10px;">üì±</div>
                            <p style="font-weight:600; color:#334155;">Picture 1: Phone Call</p>
                        </div>
                        <div style="background:#f8fafc; padding:20px; border-radius:15px; text-align:center; border:2px solid #e2e8f0;">
                            <div style="font-size:4rem; margin-bottom:10px;">üè†</div>
                            <p style="font-weight:600; color:#334155;">Picture 2: At Home</p>
                        </div>
                        <div style="background:#f8fafc; padding:20px; border-radius:15px; text-align:center; border:2px solid #e2e8f0;">
                            <div style="font-size:4rem; margin-bottom:10px;">üìû</div>
                            <p style="font-weight:600; color:#334155;">Picture 3: Making a Call</p>
                        </div>
                        <div style="background:#f8fafc; padding:20px; border-radius:15px; text-align:center; border:2px solid #e2e8f0;">
                            <div style="font-size:4rem; margin-bottom:10px;">üå≥</div>
                            <p style="font-weight:600; color:#334155;">Picture 4: In the Forest</p>
                        </div>
                    </div>

                    <div style="text-align:center;">
                        <button class="spin-btn" onclick="speakText('Liliana was telling a comedy story. The story started in Jayden\\'s house. Jayden was going to visit his dad, who was sick.')">
                            üîä Listen to the Story
                        </button>
                    </div>
                </div>

                <!-- Exercise 2: True or False -->
                <div style="margin-bottom:50px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">2</span>
                        Listen again and write T (true) or F (false). Correct the false sentences.
                    </h3>

                    <div id="true-false-container" style="background:#f8fafc; padding:30px; border-radius:20px;">
                        <!-- Statement 1 -->
                        <div class="tf-question" style="margin-bottom:20px; padding:20px; background:white; border-radius:12px; border-left:4px solid #3b82f6;">
                            <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:15px;">
                                <p style="flex:1; min-width:250px; margin:0; font-size:1.05rem; color:#1e293b;">
                                    <strong>1.</strong> Liliana was telling a comedy story. <span style="text-decoration:underline;">Liliana was telling a fairy tale.</span>
                                </p>
                                <div style="display:flex; gap:10px;">
                                    <button class="tf-btn" data-answer="false" onclick="checkTF(this, 'Liliana was telling a fairy tale, NOT a comedy story')" style="padding:10px 25px; border-radius:8px; border:2px solid #cbd5e1; background:white; cursor:pointer; font-weight:600;">
                                        T
                                    </button>
                                    <button class="tf-btn" data-answer="true" onclick="checkTF(this, 'Liliana was telling a fairy tale, NOT a comedy story')" style="padding:10px 25px; border-radius:8px; border:2px solid #cbd5e1; background:white; cursor:pointer; font-weight:600;">
                                        F
                                    </button>
                                </div>
                            </div>
                            <div class="tf-explanation" style="margin-top:12px; padding:12px; background:#f0f9ff; border-radius:8px; display:none; font-size:0.95rem;"></div>
                        </div>

                        <!-- Statement 2 -->
                        <div class="tf-question" style="margin-bottom:20px; padding:20px; background:white; border-radius:12px; border-left:4px solid #3b82f6;">
                            <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:15px;">
                                <p style="flex:1; min-width:250px; margin:0; font-size:1.05rem;">
                                    <strong>2.</strong> The story started in Jayden's house.
                                </p>
                                <div style="display:flex; gap:10px;">
                                    <button class="tf-btn" data-answer="true" onclick="checkTF(this, 'Correct! The story started in Jayden\\'s house.')" style="padding:10px 25px; border-radius:8px; border:2px solid #cbd5e1; background:white; cursor:pointer; font-weight:600;">
                                        T
                                    </button>
                                    <button class="tf-btn" data-answer="false" onclick="checkTF(this, 'Correct! The story started in Jayden\\'s house.')" style="padding:10px 25px; border-radius:8px; border:2px solid #cbd5e1; background:white; cursor:pointer; font-weight:600;">
                                        F
                                    </button>
                                </div>
                            </div>
                            <div class="tf-explanation" style="margin-top:12px; padding:12px; background:#f0f9ff; border-radius:8px; display:none; font-size:0.95rem;"></div>
                        </div>

                        <!-- Statement 3 -->
                        <div class="tf-question" style="margin-bottom:20px; padding:20px; background:white; border-radius:12px; border-left:4px solid #3b82f6;">
                            <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:15px;">
                                <p style="flex:1; min-width:250px; margin:0; font-size:1.05rem;">
                                    <strong>3.</strong> Jayden was going to visit his dad, who was sick.
                                </p>
                                <div style="display:flex; gap:10px;">
                                    <button class="tf-btn" data-answer="true" onclick="checkTF(this, 'True! Jayden\\'s dad was sick.')" style="padding:10px 25px; border-radius:8px; border:2px solid #cbd5e1; background:white; cursor:pointer; font-weight:600;">
                                        T
                                    </button>
                                    <button class="tf-btn" data-answer="false" onclick="checkTF(this, 'True! Jayden\\'s dad was sick.')" style="padding:10px 25px; border-radius:8px; border:2px solid #cbd5e1; background:white; cursor:pointer; font-weight:600;">
                                        F
                                    </button>
                                </div>
                            </div>
                            <div class="tf-explanation" style="margin-top:12px; padding:12px; background:#f0f9ff; border-radius:8px; display:none; font-size:0.95rem;"></div>
                        </div>

                        <div style="text-align:center; margin-top:30px;">
                            <div id="tf-score" style="font-size:1.3rem; font-weight:bold; color:#7c3aed; margin-bottom:15px;"></div>
                            <button class="spin-btn" onclick="resetTF()" style="background:#64748b;">üîÑ Reset Answers</button>
                        </div>
                    </div>
                </div>

                <!-- Exercise 3: Discussion Questions -->
                <div>
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">3</span>
                        Discuss the questions with your partner.
                    </h3>

                    <div style="background:linear-gradient(135deg, #ddd6fe, #e9d5ff); padding:35px; border-radius:20px;">
                        <div style="display:grid; gap:20px;">
                            <div style="background:white; padding:25px; border-radius:15px; border-left:4px solid #8b5cf6;">
                                <strong style="color:#6b21a8; font-size:1.1rem;">1.</strong> Do you recognize the story?
                                <p style="color:#64748b; margin-top:8px; font-style:italic;">ŸáŸÑ ÿ™ÿπÿ±ŸÅ ÿßŸÑŸÇÿµÿ©ÿü</p>
                            </div>
                            <div style="background:white; padding:25px; border-radius:15px; border-left:4px solid #8b5cf6;">
                                <strong style="color:#6b21a8; font-size:1.1rem;">2.</strong> Which fairy tale is it similar to?
                                <p style="color:#64748b; margin-top:8px; font-style:italic;">ŸÖÿß ÿßŸÑŸÇÿµÿ© ÿßŸÑÿÆŸäÿßŸÑŸäÿ© ÿßŸÑŸÖÿ¥ÿßÿ®Ÿáÿ© ŸÑŸáÿßÿü</p>
                            </div>
                            <div style="background:white; padding:25px; border-radius:15px; border-left:4px solid #8b5cf6;">
                                <strong style="color:#6b21a8; font-size:1.1rem;">3.</strong> What is similar? What is different?
                                <p style="color:#64748b; margin-top:8px; font-style:italic;">ŸÖÿß ŸáŸà ÿßŸÑŸÖÿ™ÿ¥ÿßÿ®Ÿáÿü ŸÖÿß ŸáŸà ÿßŸÑŸÖÿÆÿ™ŸÑŸÅÿü</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- End Lesson 5 -->

        <!-- LESSON 6: VOCABULARY - MAKING YOUR STORYBOARD -->
        <div id="lesson-6" class="lesson-section" style="display:none;">
            <div style="background:white; border-radius:30px; padding:40px; box-shadow:0 10px 30px rgba(0,0,0,0.05); margin-bottom:40px;">
                <h2 style="color:#7209b7; font-size:2.2rem; margin-bottom:20px; text-align:center;">üé≠ Vocabulary - Making Your Storyboard</h2>
                <p style="text-align:center; color:#64748b; margin-bottom:40px;">Create characters, emotions, and actions for your story!</p>

                <!-- Exercise 1: Listen, look, and number -->
                <div style="margin-bottom:50px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">1</span>
                        Listen, look, and number the tips.
                        <button class="icon-btn" onclick="speakText('Making your storyboard. Who are your characters? How do they feel? What do they do?')" style="margin-left:auto;">üîä</button>
                    </h3>

                    <div style="background:linear-gradient(135deg, #fef08a, #fde047); padding:35px; border-radius:20px; position:relative;">
                        <h4 style="text-align:center; color:#854d0e; margin-bottom:30px; font-size:1.6rem; font-weight:800;">üìñ Making Your Storyboard</h4>
                        
                        <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:25px; margin-bottom:30px;">
                            <!-- Section 1: Who are your characters? -->
                            <div style="background:linear-gradient(135deg, #f9a8d4, #fbcfe8); padding:25px; border-radius:15px; border:3px solid #ec4899;">
                                <div style="display:flex; align-items:center; gap:10px; margin-bottom:15px;">
                                    <div style="background:#ec4899; color:white; width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold;">1</div>
                                    <h5 style="margin:0; color:#831843; font-size:1.2rem;">Who are your <strong>characters</strong>?</h5>
                                </div>
                                <div style="display:flex; flex-direction:column; gap:15px;">
                                    <div class="character-card" style="background:white; padding:15px; border-radius:12px; text-align:center; cursor:pointer; transition:all 0.2s; border:2px solid transparent;" onclick="selectCharacter(this, 'Vicky')">
                                        <div style="font-size:3rem;">üëß</div>
                                        <div style="color:#ec4899; font-weight:bold; margin-top:8px;">Vicky</div>
                                    </div>
                                    <div class="character-card" style="background:white; padding:15px; border-radius:12px; text-align:center; cursor:pointer; transition:all 0.2s; border:2px solid transparent;" onclick="selectCharacter(this, 'Elena')">
                                        <div style="font-size:3rem;">üë©</div>
                                        <div style="color:#ec4899; font-weight:bold; margin-top:8px;">Elena</div>
                                    </div>
                                </div>
                                <p style="margin-top:15px; font-size:0.9rem; color:#831843; font-style:italic;">When do they appear in the story?</p>
                            </div>

                            <!-- Section 2: How do they feel? -->
                            <div style="background:linear-gradient(135deg, #a5f3fc, #67e8f9); padding:25px; border-radius:15px; border:3px solid #06b6d4;">
                                <div style="display:flex; align-items:center; gap:10px; margin-bottom:15px;">
                                    <div style="background:#06b6d4; color:white; width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold;">2</div>
                                    <h5 style="margin:0; color:#155e75; font-size:1.2rem;">How do they <strong>feel</strong>?</h5>
                                </div>
                                <div style="display:flex; flex-direction:column; gap:12px;">
                                    <div class="emotion-card" style="background:white; padding:12px; border-radius:10px; cursor:pointer; border:2px solid transparent;" onclick="selectEmotion(this, 'alone')">
                                        <div style="display:flex; align-items:center; gap:10px;">
                                            <div style="font-size:2rem;">üò¢</div>
                                            <span style="font-weight:600; color:#0e7490;">Are they <strong>alone</strong>?</span>
                                        </div>
                                    </div>
                                    <div class="emotion-card" style="background:white; padding:12px; border-radius:10px; cursor:pointer; border:2px solid transparent;" onclick="selectEmotion(this, 'with others')">
                                        <div style="display:flex; align-items:center; gap:10px;">
                                            <div style="font-size:2rem;">üòÉ</div>
                                            <span style="font-weight:600; color:#0e7490;">or with other people?</span>
                                        </div>
                                    </div>
                                </div>
                                <p style="margin-top:12px; font-size:0.85rem; color:#155e75;">There are 3 acts</p>
                            </div>

                            <!-- Section 3: What do they do? -->
                            <div style="background:linear-gradient(135deg, #d9f99d, #bef264); padding:25px; border-radius:15px; border:3px solid #84cc16;">
                                <div style="display:flex; align-items:center; gap:10px; margin-bottom:15px;">
                                    <div style="background:#84cc16; color:white; width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold;">3</div>
                                    <h5 style="margin:0; color:#3f6212; font-size:1.2rem;">What do they <strong>do</strong>?</h5>
                                </div>
                                <div style="display:grid; gap:10px;">
                                    <div class="action-card" style="background:white; padding:10px 15px; border-radius:10px; cursor:pointer; border:2px solid transparent; font-weight:600; color:#4d7c0f;" onclick="selectAction(this, 'whisper')">
                                        ü§´ whisper
                                    </div>
                                    <div class="action-card" style="background:white; padding:10px 15px; border-radius:10px; cursor:pointer; border:2px solid transparent; font-weight:600; color:#4d7c0f;" onclick="selectAction(this, 'wish')">
                                        ‚≠ê wish
                                    </div>
                                    <div class="action-card" style="background:white; padding:10px 15px; border-radius:10px; cursor:pointer; border:2px solid transparent; font-weight:600; color:#4d7c0f;" onclick="selectAction(this, 'decide')">
                                        üí≠ decide
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Story Structure Diagram -->
                        <div style="background:white; padding:25px; border-radius:15px; margin-top:25px;">
                            <div style="text-align:center; margin-bottom:20px; color:#92400e; font-weight:bold; font-size:1.1rem;">How does the story go?</div>
                            <div style="display:flex; justify-content:space-around; align-items:center; gap:10px; flex-wrap:wrap;">
                                <div style="text-align:center; flex:1; min-width:120px;">
                                    <div style="background:#dcfce7; padding:20px; border-radius:15px; border:3px solid #22c55e;">
                                        <div style="font-size:1.8rem; margin-bottom:8px;">üìñ</div>
                                        <div style="font-weight:bold; color:#166534;">Act I</div>
                                        <div style="font-size:0.85rem; color:#15803d;">BEGINNING</div>
                                    </div>
                                </div>
                                <div style="font-size:2rem; color:#92400e;">‚Üí</div>
                                <div style="text-align:center; flex:1; min-width:120px;">
                                    <div style="background:#fed7aa; padding:20px; border-radius:15px; border:3px solid #f97316;">
                                        <div style="font-size:1.8rem; margin-bottom:8px;">‚ö°</div>
                                        <div style="font-weight:bold; color:#9a3412;">Act II</div>
                                        <div style="font-size:0.85rem; color:#c2410c;">BAD THINGS</div>
                                    </div>
                                </div>
                                <div style="font-size:2rem; color:#92400e;">‚Üí</div>
                                <div style="text-align:center; flex:1; min-width:120px;">
                                    <div style="background:#ddd6fe; padding:20px; border-radius:15px; border:3px solid #8b5cf6;">
                                        <div style="font-size:1.8rem; margin-bottom:8px;">üéâ</div>
                                        <div style="font-weight:bold; color:#5b21b6;">Act III</div>
                                        <div style="font-size:0.85rem; color:#6b21a8;">ENDING</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Selection Summary -->
                        <div id="story-selections" style="margin-top:25px; padding:20px; background:rgba(255,255,255,0.9); border-radius:12px; display:none;">
                            <h6 style="color:#92400e; margin-bottom:12px; font-weight:bold;">üìù Your Selections:</h6>
                            <div id="selections-list" style="color:#78350f;"></div>
                        </div>
                    </div>
                </div>

                <!-- Exercise 2: Listen, point and say -->
                <div style="margin-bottom:50px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">2</span>
                        Listen, point, and say.
                    </h3>
                    <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(150px, 1fr)); gap:15px;">
                        <button class="vocab-btn" onclick="speakText('whisper')" style="padding:20px; background:linear-gradient(135deg, #fae8ff, #f5d0fe); border:2px solid #d946ef; border-radius:12px; cursor:pointer; font-size:1.1rem; font-weight:600; color:#701a75; transition:all 0.2s;">
                            ü§´ Whisper
                        </button>
                        <button class="vocab-btn" onclick="speakText('wish')" style="padding:20px; background:linear-gradient(135deg, #fef08a, #fde047); border:2px solid #eab308; border-radius:12px; cursor:pointer; font-size:1.1rem; font-weight:600; color:#713f12; transition:all 0.2s;">
                            ‚≠ê Wish
                        </button>
                        <button class="vocab-btn" onclick="speakText('decide')" style="padding:20px; background:linear-gradient(135deg, #bfdbfe, #93c5fd); border:2px solid #3b82f6; border-radius:12px; cursor:pointer; font-size:1.1rem; font-weight:600; color:#1e40af; transition:all 0.2s;">
                            üí≠ Decide
                        </button>
                        <button class="vocab-btn" onclick="speakText('scared')" style="padding:20px; background:linear-gradient(135deg, #fecaca, #fca5a5); border:2px solid #ef4444; border-radius:12px; cursor:pointer; font-size:1.1rem; font-weight:600; color:#991b1b; transition:all 0.2s;">
                            üò® Scared
                        </button>
                        <button class="vocab-btn" onclick="speakText('animals')" style="padding:20px; background:linear-gradient(135deg, #d9f99d, #bef264); border:2px solid #84cc16; border-radius:12px; cursor:pointer; font-size:1.1rem; font-weight:600; color:#3f6212; transition:all 0.2s;">
                            üêæ Animals
                        </button>
                        <button class="vocab-btn" onclick="speakText('homes')" style="padding:20px; background:linear-gradient(135deg, #fed7aa, #fdba74); border:2px solid #f97316; border-radius:12px; cursor:pointer; font-size:1.1rem; font-weight:600; color:#9a3412; transition:all 0.2s;">
                            üè† Homes
                        </button>
                    </div>
                </div>

                <!-- Exercise 3: Read and complete -->
                <div style="margin-bottom:50px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">3</span>
                        Read and complete with words from Exercise 1.
                    </h3>

                    <div style="background:#f8fafc; padding:30px; border-radius:20px; border:2px solid #e2e8f0;">
                        <p style="font-size:1.1rem; line-height:2; color:#1e293b; margin-bottom:20px;">
                            1. "________ well now, but the story isn't!" <br>
                            They are 
                            <select class="story-select" data-answer="scared" style="padding:8px 12px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem; margin:0 5px;">
                                <option value="">Select...</option>
                                <option value="scared">scared</option>
                                <option value="happy">happy</option>
                                <option value="angry">angry</option>
                            </select>.
                        </p>
                        <p style="font-size:1.1rem; line-height:2; color:#1e293b; margin-bottom:20px;">
                            2. The 
                            <select class="story-select" data-answer="worst" style="padding:8px 12px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem; margin:0 5px;">
                                <option value="">Select...</option>
                                <option value="worst">worst</option>
                                <option value="best">best</option>
                                <option value="first">first</option>
                            </select>
                            thing is they are with kids there, but when the 
                            <select class="story-select" data-answer="animals" style="padding:8px 12px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem; margin:0 5px;">
                                <option value="">Select...</option>
                                <option value="animals">animals</option>
                                <option value="people">people</option>
                                <option value="monsters">monsters</option>
                            </select>
                            come to sleep, they
                            <select class="story-select" data-answer="wake" style="padding:8px 12px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem; margin:0 5px;">
                                <option value="">Select...</option>
                                <option value="wake">wake</option>
                                <option value="sleep">sleep</option>
                                <option value="run">run</option>
                            </select>
                            up.
                        </p>
                        <p style="font-size:1.1rem; line-height:2; color:#1e293b; margin-bottom:20px;">
                            3. They were at home in their beds.
                        </p>

                        <div style="text-align:center; margin-top:25px;">
                            <button class="spin-btn" onclick="checkStoryComplete()" style="padding:15px 40px;">‚úÖ Check Answers</button>
                        </div>
                        <div id="story-complete-feedback" style="margin-top:20px; text-align:center; font-weight:bold; min-height:30px;"></div>
                    </div>
                </div>

                <!-- Exercise 4: Read, act and check -->
                <div>
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">4</span>
                        Read, act and check.
                    </h3>

                    <div style="background:linear-gradient(135deg, #e0e7ff, #c7d2fe); padding:35px; border-radius:20px; text-align:center;">
                        <div style="font-size:1.5rem; color:#3730a3; font-weight:bold; margin-bottom:20px;">üé¨ Storytelling Challenge</div>
                        <p style="color:#4338ca; margin-bottom:25px; line-height:1.6;">
                            ‚Ä¢ Tell a short story using the vocabulary<br>
                            ‚Ä¢ Use as many words as possible<br>
                            ‚Ä¢ Compete against your classmates!
                        </p>
                        <div style="background:white; padding:25px; border-radius:15px; margin:20px 0;">
                            <div style="font-weight:600; color:#3730a3; margin-bottom:15px;">üí° Useful Expressions:</div>
                            <div style="display:flex; flex-wrap:wrap; gap:10px; justify-content:center;">
                                <span style="background:#ddd6fe; padding:8px 15px; border-radius:20px; color:#5b21b6; font-size:0.95rem;">Once upon a time...</span>
                                <span style="background:#ddd6fe; padding:8px 15px; border-radius:20px; color:#5b21b6; font-size:0.95rem;">Suddenly...</span>
                                <span style="background:#ddd6fe; padding:8px 15px; border-radius:20px; color:#5b21b6; font-size:0.95rem;">In the end...</span>
                                <span style="background:#ddd6fe; padding:8px 15px; border-radius:20px; color:#5b21b6; font-size:0.95rem;">They lived happily ever after</span>
                            </div>
                        </div>
                        <button class="spin-btn" onclick="speakText('Once upon a time, Vicky and Elena were scared. The animals came to their homes. They whispered and decided to wish for help. In the end, they were safe.')" style="background:linear-gradient(135deg, #818cf8, #6366f1);">
                            üîä Hear Example Story
                        </button>
                    </div>
                </div>
            </div>
        </div> <!-- End Lesson 6 -->

        <!-- LESSON 7: READING - MY FAVORITE MOVIE SCENES -->
        <div id="lesson-7" class="lesson-section" style="display:none;">
            <div style="background:white; border-radius:30px; padding:40px; box-shadow:0 10px 30px rgba(0,0,0,0.05); margin-bottom:40px;">
                <h2 style="color:#7209b7; font-size:2.2rem; margin-bottom:20px; text-align:center;">üëì Reading - My Favorite Movie Scenes</h2>
                <p style="text-align:center; color:#64748b; margin-bottom:40px;">Read the blog post and answer the questions.</p>

                <!-- Exercise 1: Pre-reading questions -->
                <div style="margin-bottom:40px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">1</span>
                        Look and discuss the questions with your partner.
                    </h3>
                    <div style="background:linear-gradient(135deg, #dbeafe, #bfdbfe); padding:30px; border-radius:20px;">
                        <div style="display:grid; gap:15px;">
                            <div style="background:white; padding:20px; border-radius:12px; border-left:4px solid #3b82f6;">
                                <strong style="color:#1e40af;">1.</strong> Where might you find this text?
                                <p style="color:#64748b; margin-top:5px; font-style:italic;">ÿ£ŸäŸÜ ŸäŸÖŸÉŸÜ ÿ£ŸÜ ÿ™ÿ¨ÿØ Ÿáÿ∞ÿß ÿßŸÑŸÜÿµÿü</p>
                            </div>
                            <div style="background:white; padding:20px; border-radius:12px; border-left:4px solid #3b82f6;">
                                <strong style="color:#1e40af;">2.</strong> What do you think it is about?
                                <p style="color:#64748b; margin-top:5px; font-style:italic;">ÿπŸÜ ŸÖÿßÿ∞ÿß ÿ™ÿπÿ™ŸÇÿØ ÿ£ŸÜŸáÿü</p>
                            </div>
                            <div style="background:white; padding:20px; border-radius:12px; border-left:4px solid #3b82f6;">
                                <strong style="color:#1e40af;">3.</strong> Who do you think it is for?
                                <p style="color:#64748b; margin-top:5px; font-style:italic;">ŸÑŸÖŸÜ ÿ™ÿπÿ™ŸÇÿØ ÿ£ŸÜŸá ŸÖŸàÿ¨Ÿáÿü</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- The Blog Post -->
                <div style="margin-bottom:40px;">
                    <div style="background:linear-gradient(135deg, #fef3c7, #fde68a); padding:40px; border-radius:20px; position:relative;">
                        <div style="text-align:center; margin-bottom:30px;">
                            <h3 style="color:#92400e; font-size:1.8rem; margin-bottom:10px;">üé¨ My Favorite Movie Scenes</h3>
                            <button class="icon-btn" onclick="speakText('My Favorite Movie Scenes blog post')" style="margin-top:10px;">üîä Listen to the text</button>
                        </div>

                        <div style="background:white; padding:35px; border-radius:15px; line-height:1.9; font-size:1.05rem; color:#334155;">
                            <p style="margin-bottom:18px;">
                                Welcome again to my movie blog, where I share everything I love (and hate!) about movies. Why don't we get started? Today, I'm talking about my favorite movie scenes.
                            </p>
                            <p style="margin-bottom:18px;">
                                Yesterday, the author watched a new <strong style="background:#fef08a; padding:2px 6px; border-radius:4px;">comedy</strong>. My favorite <strong style="background:#fef08a; padding:2px 6px; border-radius:4px;">comedian</strong> was playing one of the characters - he was hilarious! In truth, I wasn't sure much if I liked my favorite scene was when the character was whispering a big secret, but a microphone was switched on and everybody was listening! The great thing about the scene was that we were watching the disaster happen, but the character didn't know. Everyone in the movie theater was laughing and shouting at the character - they couldn't hear us. I didn't want the movie to end! One thing I didn't like was the other <strong style="background:#fef08a; padding:2px 6px; border-radius:4px;">actors</strong> - they were not as great.
                            </p>
                            <p style="margin-bottom:18px;">
                                But it was still a great film. What about discussing the new <strong style="background:#bfdbfe; padding:2px 6px; border-radius:4px;">documentary</strong> about a real-life <strong style="background:#bfdbfe; padding:2px 6px; border-radius:4px;">mystery</strong>? Well, I didn't enjoy it as much as I thought I would. It's great they were trying to <strong style="background:#bfdbfe; padding:2px 6px; border-radius:4px;">document</strong> an important event, but I didn't feel excited by it. Sure, the plot was <strong style="background:#fecaca; padding:2px 6px; border-radius:4px;">mysterious</strong>, but I didn't understand what was happening anymore. So these were my thoughts ‚Äì why don't you write a comment to tell me what you think?
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Exercise 2: Read and complete -->
                <div style="margin-bottom:40px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">2</span>
                        Read and complete.
                    </h3>

                    <div id="reading-quiz" style="background:#f8fafc; padding:30px; border-radius:20px; border:2px solid #e2e8f0;">
                        <!-- Q1 -->
                        <div class="reading-q" style="margin-bottom:20px; padding:20px; background:white; border-radius:12px; border-left:4px solid #3b82f6;">
                            <p style="font-weight:600; margin-bottom:12px; color:#1e293b;">1. The text is part of a ___________</p>
                            <select class="reading-select" data-answer="blog about movies" style="width:100%; padding:12px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem;">
                                <option value="">Select your answer...</option>
                                <option value="blog about movies">blog about movies</option>
                                <option value="newspaper article">newspaper article</option>
                                <option value="book review">book review</option>
                            </select>
                        </div>

                        <!-- Q2 -->
                        <div class="reading-q" style="margin-bottom:20px; padding:20px; background:white; border-radius:12px; border-left:4px solid #3b82f6;">
                            <p style="font-weight:600; margin-bottom:12px; color:#1e293b;">2. This entry discusses ___________</p>
                            <input type="text" class="reading-input" data-answer="favorite movie scenes|movie scenes" placeholder="Type your answer..." style="width:100%; padding:12px; border:2px solid #cbd5e1; border-radius:8px; font-size:1rem;"/>
                        </div>

                        <!-- Q3 -->
                        <div class="reading-q" style="margin-bottom:20px; padding:20px; background:white; border-radius:12px; border-left:4px solid #3b82f6;">
                            <p style="font-weight:600; margin-bottom:12px; color:#1e293b;">3. Yesterday, the author watched ___________</p>
                            <select class="reading-select" data-answer="a comedy" style="width:100%; padding:12px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem;">
                                <option value="">Select your answer...</option>
                                <option value="a comedy">a comedy</option>
                                <option value="a documentary">a documentary</option>
                                <option value="a mystery">a mystery</option>
                            </select>
                        </div>

                        <!-- Q4-9 continue... -->
                        <div class="reading-q" style="margin-bottom:20px; padding:20px; background:white; border-radius:12px; border-left:4px solid #3b82f6;">
                            <p style="font-weight:600; margin-bottom:12px; color:#1e293b;">4. To show she liked it, the author used words and phrases like ___________</p>
                            <input type="text" class="reading-input" data-answer="great|hilarious|didn't want it to end" placeholder="Give examples from the text..." style="width:100%; padding:12px; border:2px solid #cbd5e1; border-radius:8px; font-size:1rem;"/>
                        </div>

                        <div class="reading-q" style="margin-bottom:20px; padding:20px; background:white; border-radius:12px; border-left:4px solid #3b82f6;">
                            <p style="font-weight:600; margin-bottom:12px; color:#1e293b;">8. She didn't like the documentary because ___________</p>
                            <select class="reading-select" data-answer="she didn't understand" style="width:100%; padding:12px; border-radius:8px; border:2px solid #cbd5e1; font-size:1rem;">
                                <option value="">Select your answer...</option>
                                <option value="it was too long">it was too long</option>
                                <option value="she didn't understand">she didn't understand what was happening</option>
                                <option value="it was boring">it was boring</option>
                            </select>
                        </div>

                        <div style="text-align:center; margin-top:30px;">
                            <button class="spin-btn" onclick="checkReadingQuiz()" style="padding:15px 40px;">‚úÖ Check Answers</button>
                        </div>
                        <div id="reading-feedback" style="margin-top:20px; text-align:center; font-weight:bold; min-height:30px;"></div>
                    </div>
                </div>

                <!-- Exercise 3: Discussion -->
                <div>
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">3</span>
                        Discuss the questions with your partner.
                    </h3>
                    <div style="background:linear-gradient(135deg, #e9d5ff, #ddd6fe); padding:35px; border-radius:20px;">
                        <div style="display:grid; gap:20px;">
                            <div style="background:white; padding:25px; border-radius:15px; border-left:4px solid #a855f7;">
                                <strong style="color:#7e22ce; font-size:1.1rem;">1.</strong> Do you have a favorite movie scene?
                                <p style="color:#64748b; margin-top:8px; font-style:italic;">ŸáŸÑ ŸÑÿØŸäŸÉ ŸÖÿ¥ŸáÿØ ŸÖŸÅÿ∂ŸÑ ŸÖŸÜ ŸÅŸäŸÑŸÖÿü</p>
                            </div>
                            <div style="background:white; padding:25px; border-radius:15px; border-left:4px solid #a855f7;">
                                <strong style="color:#7e22ce; font-size:1.1rem;">2.</strong> What happens in it, and why is it your favorite?
                                <p style="color:#64748b; margin-top:8px; font-style:italic;">ŸÖÿßÿ∞ÿß Ÿäÿ≠ÿØÿ´ ŸÅŸäŸáÿå ŸàŸÑŸÖÿßÿ∞ÿß ŸáŸà ÿßŸÑŸÖŸÅÿ∂ŸÑ ŸÑÿØŸäŸÉÿü</p>
                            </div>
                            <div style="background:white; padding:25px; border-radius:15px; border-left:4px solid #a855f7;">
                                <strong style="color:#7e22ce; font-size:1.1rem;">3.</strong> How did you feel when you were watching it?
                                <p style="color:#64748b; margin-top:8px; font-style:italic;">ŸÉŸäŸÅ ŸÉÿßŸÜ ÿ¥ÿπŸàÿ±ŸÉ ÿπŸÜÿØŸÖÿß ŸÉŸÜÿ™ ÿ™ÿ¥ÿßŸáÿØŸáÿü</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- End Lesson 7 -->

        <!-- LESSON 8: WORD WORK AND WRITING -->
        <div id="lesson-8" class="lesson-section" style="display:none;">
            <div style="background:white; border-radius:30px; padding:40px; box-shadow:0 10px 30px rgba(0,0,0,0.05); margin-bottom:40px;">
                <h2 style="color:#7209b7; font-size:2.2rem; margin-bottom:20px; text-align:center;">‚úçÔ∏è Word Work and Writing</h2>
                <p style="text-align:center; color:#64748b; margin-bottom:40px;">Learn vocabulary and write your own blog post!</p>

                <!-- Exercise 1: Dictionary Work -->
                <div style="margin-bottom:50px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">1</span>
                        Find the words in the text on page 66. Complete the chart using a dictionary.
                        <p style="font-size:0.9rem; color:#64748b; margin-left:10px;">(ÿßÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑŸÉŸÑŸÖÿßÿ™ ŸÅŸä ÿßŸÑŸÜÿµ Ÿàÿ£ŸÉŸÖŸÑ ÿßŸÑÿ¨ÿØŸàŸÑ)</p>
                    </h3>

                    <div style="overflow-x:auto;">
                        <table style="width:100%; border-collapse:collapse; background:white; box-shadow:0 4px 15px rgba(0,0,0,0.1); border-radius:12px; overflow:hidden;">
                            <thead>
                                <tr style="background:linear-gradient(135deg, #7c3aed, #6366f1);">
                                    <th style="padding:20px; text-align:left; color:white; font-size:1.1rem; border-right:1px solid rgba(255,255,255,0.1);">Word</th>
                                    <th style="padding:20px; text-align:left; color:white; font-size:1.1rem; border-right:1px solid rgba(255,255,255,0.1);">Word Class</th>
                                    <th style="padding:20px; text-align:left; color:white; font-size:1.1rem;">Meaning</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background:#f8fafc; border-bottom:1px solid #e2e8f0;">
                                    <td style="padding:15px; font-weight:600; color:#1e293b;">1. comedy</td>
                                    <td style="padding:15px; color:#3b82f6; font-style:italic;">noun</td>
                                    <td style="padding:15px; color:#64748b;">a type of story that makes you laugh (ŸÜŸàÿπ ŸÖŸÜ ÿßŸÑŸÇÿµÿµ Ÿäÿ¨ÿπŸÑŸÉ ÿ™ÿ∂ÿ≠ŸÉ)</td>
                                </tr>
                                <tr style="background:white; border-bottom:1px solid #e2e8f0;">
                                    <td style="padding:15px; font-weight:600; color:#1e293b;">2. comedian</td>
                                    <td style="padding:15px;">
                                        <input type="text" placeholder="Word class..." style="width:100%; padding:8px; border:1px solid #cbd5e1; border-radius:6px;"/>
                                    </td>
                                    <td style="padding:15px;">
                                        <input type="text" placeholder="Meaning..." style="width:100%; padding:8px; border:1px solid #cbd5e1; border-radius:6px;"/>
                                    </td>
                                </tr>
                                <tr style="background:#f8fafc; border-bottom:1px solid #e2e8f0;">
                                    <td style="padding:15px; font-weight:600; color:#1e293b;">3. documentary</td>
                                    <td style="padding:15px;">
                                        <input type="text" placeholder="Word class..." style="width:100%; padding:8px; border:1px solid #cbd5e1; border-radius:6px;"/>
                                    </td>
                                    <td style="padding:15px;">
                                        <input type="text" placeholder="Meaning..." style="width:100%; padding:8px; border:1px solid #cbd5e1; border-radius:6px;"/>
                                    </td>
                                </tr>
                                <tr style="background:white; border-bottom:1px solid #e2e8f0;">
                                    <td style="padding:15px; font-weight:600; color:#1e293b;">4. mystery</td>
                                    <td style="padding:15px; color:#3b82f6; font-style:italic;">noun</td>
                                    <td style="padding:15px; color:#64748b;">something unknown or secret (ÿ¥Ÿäÿ° ÿ∫ÿßŸÖÿ∂ ÿ£Ÿà ÿ≥ÿ±Ÿä)</td>
                                </tr>
                                <tr style="background:#f8fafc; border-bottom:1px solid #e2e8f0;">
                                    <td style="padding:15px; font-weight:600; color:#1e293b;">5. mysterious</td>
                                    <td style="padding:15px;">
                                        <input type="text" placeholder="Word class..." style="width:100%; padding:8px; border:1px solid #cbd5e1; border-radius:6px;"/>
                                    </td>
                                    <td style="padding:15px;">
                                        <input type="text" placeholder="Meaning..." style="width:100%; padding:8px; border:1px solid #cbd5e1; border-radius:6px;"/>
                                    </td>
                                </tr>
                                <tr style="background:white;">
                                    <td style="padding:15px; font-weight:600; color:#1e293b;">6. actor</td>
                                    <td style="padding:15px;">
                                        <input type="text" placeholder="Word class..." style="width:100%; padding:8px; border:1px solid #cbd5e1; border-radius:6px;"/>
                                    </td>
                                    <td style="padding:15px;">
                                        <input type="text" placeholder="Meaning..." style="width:100%; padding:8px; border:1px solid #cbd5e1; border-radius:6px;"/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Exercise 2: Write and Draw (Mind Map) -->
                <div style="margin-bottom:50px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">2</span>
                        Write and draw.
                        <p style="font-size:0.9rem; color:#64748b; margin-left:10px;">(ÿßŸÉÿ™ÿ® Ÿàÿßÿ±ÿ≥ŸÖ)</p>
                    </h3>

                    <div style="background:linear-gradient(135deg, #fef3c7, #fde68a); padding:35px; border-radius:20px;">
                        <div style="text-align:center; margin-bottom:30px;">
                            <div style="background:white; display:inline-block; padding:15px 30px; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.1);">
                                <strong style="color:#92400e; font-size:1.2rem;">My favorite movie scene is from:</strong>
                                <input type="text" placeholder="Write movie name..." style="margin-top:10px; width:300px; padding:12px; border:2px solid #eab308; border-radius:8px; font-size:1rem; text-align:center;"/>
                            </div>
                        </div>

                        <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:20px; margin-top:25px;">
                            <div style="background:white; padding:25px; border-radius:15px; border:3px solid #f97316;">
                                <div style="color:#ea580c; font-weight:bold; margin-bottom:15px; font-size:1.1rem;">üé¨ What happens in the scene?</div>
                                <textarea placeholder="Describe what happens..." style="width:100%; min-height:100px; padding:12px; border:2px solid #fed7aa; border-radius:8px; font-size:0.95rem; resize:vertical;"></textarea>
                                <p style="color:#9a3412; font-size:0.85rem; margin-top:8px; font-style:italic;">ŸÖÿßÿ∞ÿß Ÿäÿ≠ÿØÿ´ ŸÅŸä ÿßŸÑŸÖÿ¥ŸáÿØÿü</p>
                            </div>

                            <div style="background:white; padding:25px; border-radius:15px; border:3px solid #8b5cf6;">
                                <div style="color:#7c3aed; font-weight:bold; margin-bottom:15px; font-size:1.1rem;">üé≠ What kind of story is it?</div>
                                <textarea placeholder="Comedy? Drama? Action?" style="width:100%; min-height:100px; padding:12px; border:2px solid #ddd6fe; border-radius:8px; font-size:0.95rem; resize:vertical;"></textarea>
                                <p style="color:#6b21a8; font-size:0.85rem; margin-top:8px; font-style:italic;">ŸÖÿß ŸÜŸàÿπ ÿßŸÑŸÇÿµÿ©ÿü</p>
                            </div>

                            <div style="background:white; padding:25px; border-radius:15px; border:3px solid #10b981;">
                                <div style="color:#059669; font-weight:bold; margin-bottom:15px; font-size:1.1rem;">üíö What do you like about it?</div>
                                <textarea placeholder="Why is it your favorite?" style="width:100%; min-height:100px; padding:12px; border:2px solid #d1fae5; border-radius:8px; font-size:0.95rem; resize:vertical;"></textarea>
                                <p style="color:#047857; font-size:0.85rem; margin-top:8px; font-style:italic;">ŸÖÿßÿ∞ÿß ÿ™ÿ≠ÿ® ŸÅŸäŸáÿü</p>
                            </div>

                            <div style="background:white; padding:25px; border-radius:15px; border:3px solid #ef4444;">
                                <div style="color:#dc2626; font-weight:bold; margin-bottom:15px; font-size:1.1rem;">‚ùå Is there anything you don't like?</div>
                                <textarea placeholder="Any negatives?" style="width:100%; min-height:100px; padding:12px; border:2px solid #fecaca; border-radius:8px; font-size:0.95rem; resize:vertical;"></textarea>
                                <p style="color:#991b1b; font-size:0.85rem; margin-top:8px; font-style:italic;">ŸáŸÑ ŸáŸÜÿßŸÉ ÿ¥Ÿäÿ° ŸÑÿß ÿ™ÿ≠ÿ®Ÿáÿü</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exercise 3: Write Your Blog Post -->
                <div>
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">3</span>
                        Write your blog post.
                        <p style="font-size:0.9rem; color:#64748b; margin-left:10px;">(ÿßŸÉÿ™ÿ® ŸÖŸÜÿ¥Ÿàÿ± ŸÖÿØŸàŸÜÿ™ŸÉ)</p>
                    </h3>

                    <div style="background:linear-gradient(135deg, #bfdbfe, #93c5fd); padding:35px; border-radius:20px;">
                        <div style="background:white; padding:30px; border-radius:15px; box-shadow:0 10px 30px rgba(0,0,0,0.1);">
                            <div style="text-align:center; color:#1e40af; font-size:1.5rem; font-weight:bold; margin-bottom:25px;">
                                üìù My Favorite Movie Scene
                            </div>

                            <textarea id="blog-editor" placeholder="Start writing your blog post here...

Use the useful expressions below to help you!

ÿßÿ®ÿØÿ£ ÿ®ŸÉÿ™ÿßÿ®ÿ© ŸÖŸÜÿ¥Ÿàÿ±ŸÉ ŸáŸÜÿß..." style="width:100%; min-height:300px; padding:20px; border:2px solid #cbd5e1; border-radius:12px; font-size:1.05rem; line-height:1.8; resize:vertical; font-family:inherit;"></textarea>

                            <div style="background:#fef3c7; padding:20px; border-radius:12px; margin-top:20px; border-left:4px solid #eab308;">
                                <div style="font-weight:bold; color:#92400e; margin-bottom:12px; font-size:1.1rem;">üí° Useful Expressions:</div>
                                <div style="display:flex; flex-wrap:wrap; gap:10px;">
                                    <span style="background:white; padding:8px 15px; border-radius:20px; color:#78350f; font-size:0.95rem; cursor:pointer;" onclick="insertText('Why don\'t we...')">Why don't we...</span>
                                    <span style="background:white; padding:8px 15px; border-radius:20px; color:#78350f; font-size:0.95rem; cursor:pointer;" onclick="insertText('What I loved was...')">What I loved was...</span>
                                    <span style="background:white; padding:8px 15px; border-radius:20px; color:#78350f; font-size:0.95rem; cursor:pointer;" onclick="insertText('The great thing about...')">The great thing about...</span>
                                    <span style="background:white; padding:8px 15px; border-radius:20px; color:#78350f; font-size:0.95rem; cursor:pointer;" onclick="insertText('One thing I didn\'t like was...')">One thing I didn't like was...</span>
                                </div>
                            </div>

                            <div style="text-align:center; margin-top:25px;">
                                <button class="spin-btn" onclick="speakText(document.getElementById('blog-editor').value)" style="margin-right:10px;">üîä Read My Blog</button>
                                <button class="spin-btn" style="background:linear-gradient(135deg, #10b981, #059669);">‚úÖ Save Blog Post</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- End Lesson 8 -->

        <!-- LESSON 9: INTEGRATED LEARNING - STORY STRUCTURE -->
        <div id="lesson-9" class="lesson-section" style="display:none;">
            <div style="background:white; border-radius:30px; padding:40px; box-shadow:0 10px 30px rgba(0,0,0,0.05); margin-bottom:40px;">
                <h2 style="color:#7209b7; font-size:2.2rem; margin-bottom:20px; text-align:center;">üìà Integrated Learning: Language Arts</h2>
                <p style="text-align:center; color:#64748b; margin-bottom:40px;">Learn about story structure and plan your own story!</p>

                <!-- Exercise 1: The Writing Roller Coaster -->
                <div style="margin-bottom:50px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">1</span>
                        Look, read, and complete the graphic organizer.
                        <p style="font-size:0.9rem; color:#64748b; margin-left:10px;">(ÿßŸÜÿ∏ÿ± ŸàÿßŸÇÿ±ÿ£ Ÿàÿ£ŸÉŸÖŸÑ ÿßŸÑÿ±ÿ≥ŸÖ ÿßŸÑÿ™ŸÜÿ∏ŸäŸÖŸä)</p>
                    </h3>

                    <div style="background:linear-gradient(135deg, #059669, #047857); padding:40px; border-radius:20px; position:relative;">
                        <div style="text-align:center; margin-bottom:30px;">
                            <h3 style="color:white; font-size:2rem; margin-bottom:10px; font-weight:800;">üé¢ The Writing Roller Coaster</h3>
                            <p style="color:#d1fae5; font-size:1.1rem;">Storytellers are always finding new ways to tell a story. No matter the genre, writers in the past used the same three-act structure that writers use today.</p>
                        </div>

                        <!-- The Roller Coaster Diagram -->
                        <div style="background:white; padding:35px; border-radius:20px; margin-bottom:30px;">
                            <svg viewBox="0 0 800 400" style="width:100%; height:auto;">
                                <!-- Background -->
                                <rect width="800" height="400" fill="#f0fdf4"/>
                                
                                <!-- Roller coaster track -->
                                <path d="M 50 350 L 150 350 Q 200 100 250 200 L 300 200 Q 400 50 500 150 L 600 150 Q 650 250 700 300 L 750 300" 
                                      stroke="#7c3aed" stroke-width="8" fill="none" stroke-linecap="round"/>
                                
                                <!-- Act I -->
                                <rect x="50" y="280" width="150" height="100" fill="#dcfce7" stroke="#22c55e" stroke-width="3" rx="10"/>
                                <text x="125" y="320" text-anchor="middle" font-size="24" font-weight="bold" fill="#166534">Act I</text>
                                <text x="125" y="345" text-anchor="middle" font-size="16" fill="#15803d">Beginning</text>
                                
                                <!-- Act II -->
                                <rect x="320" y="180" width="150" height="100" fill="#fed7aa" stroke="#f97316" stroke-width="3" rx="10"/>
                                <text x="395" y="220" text-anchor="middle" font-size="24" font-weight="bold" fill="#9a3412">Act II</text>
                                <text x="395" y="245" text-anchor="middle" font-size="16" fill="#c2410c">Climax</text>
                                
                                <!-- Act III -->
                                <rect x="600" y="250" width="150" height="100" fill="#ddd6fe" stroke="#8b5cf6" stroke-width="3" rx="10"/>
                                <text x="675" y="290" text-anchor="middle" font-size="24" font-weight="bold" fill="#5b21b6">Act III</text>
                                <text x="675" y="315" text-anchor="middle" font-size="16" fill="#6b21a8">Resolution</text>
                                
                                <!-- Labels -->
                                <text x="125" y="50" text-anchor="middle" font-size="14" fill="#059669" font-weight="600">Context and the</text>
                                <text x="125" y="70" text-anchor="middle" font-size="14" fill="#059669" font-weight="600">start of the journey</text>
                                <text x="125" y="150" text-anchor="middle" font-size="14" fill="#047857">Rising tension</text>
                                
                                <text x="395" y="100" text-anchor="middle" font-size="14" fill="#ea580c" font-weight="600">Main action</text>
                                <text x="395" y="120" text-anchor="middle" font-size="14" fill="#ea580c">The tension rising</text>
                                
                                <text x="675" y="200" text-anchor="middle" font-size="14" fill="#7c3aed" font-weight="600">Final resolution</text>
                            </svg>
                        </div>

                        <!-- Story Structure Details -->
                        <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:20px; margin-top:30px;">
                            <div style="background:white; padding:25px; border-radius:15px; border-left:5px solid #22c55e;">
                                <div style="color:#166534; font-weight:bold; margin-bottom:12px; font-size:1.2rem;">üé¨ Act I - The Beginning</div>
                                <p style="color:#334155; line-height:1.7; margin-bottom:10px;">In the first act, we met the main character and their world. How was the character living before their journey began? What were their dreams and wishes? This act sets us up and we're getting ready for an adventure.</p>
                                <div style="background:#dcfce7; padding:12px; border-radius:8px; margin-top:15px;">
                                    <div style="font-weight:600; color:#15803d; font-size:0.9rem;">üìå Key Points:</div>
                                    <div style="color:#166534; font-size:0.85rem; margin-top:5px;">
                                        1. Number of acts: <strong>Three</strong><br>
                                        2. The shape is like: <strong>a roller coaster</strong><br>
                                        3. In the first act: <strong>meet the main character</strong>
                                    </div>
                                </div>
                            </div>

                            <div style="background:white; padding:25px; border-radius:15px; border-left:5px solid #f97316;">
                                <div style="color:#9a3412; font-weight:bold; margin-bottom:12px; font-size:1.2rem;">‚ö° Act II - The Middle</div>
                                <p style="color:#334155; line-height:1.7; margin-bottom:10px;">In the middle, act 2, there was more action. The main character was facing more obstacles and enemies appearing. Maybe they were lying on a beach before but now horrible events are happening! The tension was rising more scared. The tension was rising.</p>
                                <div style="background:#fed7aa; padding:12px; border-radius:8px; margin-top:15px;">
                                    <div style="font-weight:600; color:#c2410c; font-size:0.9rem;">üìå Key Points:</div>
                                    <div style="color:#9a3412; font-size:0.85rem; margin-top:5px;">
                                        4. In the second act: <strong>facing obstacles</strong><br>
                                        5. The climax: <strong>most exciting point</strong>
                                    </div>
                                </div>
                            </div>

                            <div style="background:white; padding:25px; border-radius:15px; border-left:5px solid #8b5cf6;">
                                <div style="color:#5b21b6; font-weight:bold; margin-bottom:12px; font-size:1.2rem;">üéâ Act III - The End</div>
                                <p style="color:#334155; line-height:1.7; margin-bottom:10px;">In all the stories, the third act had the most important event. This is called the climax. Singers were singing the most exciting songs in musicals, and cowboys were fighting big battles in westerns. Then, after the climax, came the resolution. That's when we learned how the characters were living after their adventure.</p>
                                <div style="background:#ddd6fe; padding:12px; border-radius:8px; margin-top:15px;">
                                    <div style="font-weight:600; color:#6b21a8; font-size:0.9rem;">üìå Key Point:</div>
                                    <div style="color:#5b21b6; font-size:0.85rem; margin-top:5px;">
                                        6. The resolution: <strong>how it all ends</strong>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exercise 2: Remember, plan, and present -->
                <div>
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">2</span>
                        Remember, plan, and present.
                        <p style="font-size:0.9rem; color:#64748b; margin-left:10px;">(ÿ™ÿ∞ŸÉÿ± ŸàÿÆÿ∑ÿ∑ Ÿàÿßÿπÿ±ÿ∂)</p>
                    </h3>

                    <div style="background:linear-gradient(135deg, #fef3c7, #fde68a); padding:35px; border-radius:20px;">
                        <div style="text-align:center; margin-bottom:30px;">
                            <h4 style="color:#92400e; font-size:1.5rem; margin-bottom:10px;">üìù Plan Your Story</h4>
                            <p style="color:#78350f;">Use the table below to plan your own three-act story!</p>
                        </div>

                        <div style="background:white; padding:30px; border-radius:15px; overflow-x:auto;">
                            <table id="story-planner" style="width:100%; border-collapse:collapse;">
                                <tr style="background:#7c3aed;">
                                    <td style="padding:15px; color:white; font-weight:bold; border:2px solid #6366f1;">Story Element</td>
                                    <td style="padding:15px; color:white; font-weight:bold; border:2px solid #6366f1;">Your Plan</td>
                                </tr>
                                <tr style="background:#f8fafc;">
                                    <td style="padding:15px; border:2px solid #e2e8f0; font-weight:600; color:#1e293b;">Story Name:</td>
                                    <td style="padding:15px; border:2px solid #e2e8f0;">
                                        <input type="text" placeholder="Give your story a title..." style="width:100%; padding:10px; border:2px solid #cbd5e1; border-radius:8px; font-size:1rem;"/>
                                    </td>
                                </tr>
                                <tr style="background:white;">
                                    <td style="padding:15px; border:2px solid #e2e8f0; font-weight:600; color:#1e293b;">Type of story:</td>
                                    <td style="padding:15px; border:2px solid #e2e8f0;">
                                        <input type="text" placeholder="Comedy? Drama? Mystery?" style="width:100%; padding:10px; border:2px solid #cbd5e1; border-radius:8px; font-size:1rem;"/>
                                    </td>
                                </tr>
                                <tr style="background:#f8fafc;">
                                    <td style="padding:15px; border:2px solid #e2e8f0; font-weight:600; color:#1e293b;">Characters:</td>
                                    <td style="padding:15px; border:2px solid #e2e8f0;">
                                        <input type="text" placeholder="Who are the main characters?" style="width:100%; padding:10px; border:2px solid #cbd5e1; border-radius:8px; font-size:1rem;"/>
                                    </td>
                                </tr>
                                <tr style="background:#dcfce7;">
                                    <td style="padding:15px; border:2px solid #22c55e; font-weight:600; color:#166534;">üé¨ Act I:</td>
                                    <td style="padding:15px; border:2px solid #22c55e;">
                                        <textarea placeholder="What happens in the beginning?" style="width:100%; min-height:80px; padding:10px; border:2px solid #86efac; border-radius:8px; font-size:0.95rem; resize:vertical;"></textarea>
                                    </td>
                                </tr>
                                <tr style="background:#fed7aa;">
                                    <td style="padding:15px; border:2px solid #f97316; font-weight:600; color:#9a3412;">‚ö° Act II:</td>
                                    <td style="padding:15px; border:2px solid #f97316;">
                                        <textarea placeholder="What happens in the middle? What's the climax?" style="width:100%; min-height:80px; padding:10px; border:2px solid #fdba74; border-radius:8px; font-size:0.95rem; resize:vertical;"></textarea>
                                    </td>
                                </tr>
                                <tr style="background:#ddd6fe;">
                                    <td style="padding:15px; border:2px solid #8b5cf6; font-weight:600; color:#5b21b6;">üéâ Act III:</td>
                                    <td style="padding:15px; border:2px solid #8b5cf6;">
                                        <textarea placeholder="What happens in the end? How is it resolved?" style="width:100%; min-height:80px; padding:10px; border:2px solid #c4b5fd; border-radius:8px; font-size:0.95rem; resize:vertical;"></textarea>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <div style="text-align:center; margin-top:30px;">
                            <button class="spin-btn" onclick="saveStoryPlan()" style="margin-right:10px; background:linear-gradient(135deg, #10b981, #059669);">‚úÖ Save My Story Plan</button>
                            <button class="spin-btn" onclick="presentStory()" style="background:linear-gradient(135deg, #8b5cf6, #7c3aed);">üé¨ Present My Story</button>
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- End Lesson 9 -->

        <!-- UNIT REVIEW -->
        <div id="lesson-10" class="lesson-section" style="display:none;">
            <div style="background:white; border-radius:30px; padding:40px; box-shadow:0 10px 30px rgba(0,0,0,0.05); margin-bottom:40px;">
                <h2 style="color:#7209b7; font-size:2.2rem; margin-bottom:20px; text-align:center;">üéÆ Unit Review</h2>
                <p style="text-align:center; color:#64748b; margin-bottom:40px;">Play the board game and complete the project!</p>

                <!-- Board Game -->
                <div style="margin-bottom:50px;">
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">1</span>
                        Play and answer.
                        <p style="font-size:0.9rem; color:#64748b; margin-left:10px;">(ÿßŸÑÿπÿ® Ÿàÿ£ÿ¨ÿ®)</p>
                    </h3>

                    <div style="background:linear-gradient(135deg, #0ea5e9, #06b6d4); padding:40px; border-radius:20px; position:relative;">
                        <div id="board-game" style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:15px; position:relative;">
                            <!-- Start -->
                            <div class="game-square" data-question="start" style="background:linear-gradient(135deg, #10b981, #059669); padding:25px; border-radius:15px; text-align:center; cursor:pointer; transition:all 0.3s; border:4px solid white; min-height:120px; display:flex; align-items:center; justify-content:center;" onclick="selectSquare(this)">
                                <div style="color:white; font-size:1.5rem; font-weight:800;">üèÅ START / FINISH</div>
                            </div>

                            <!-- Question 1 -->
                            <div class="game-square" data-question="1" style="background:#fef08a; padding:20px; border-radius:15px; cursor:pointer; transition:all 0.3s; border:3px solid #eab308;" onclick="showQuestion(1, 'Name four kinds of stories.')">
                                <div style="background:#eab308; color:white; width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold; margin-bottom:10px;">1</div>
                                <div style="color:#713f12; font-weight:600; font-size:0.95rem;">Name four kinds of stories.</div>
                            </div>

                            <!-- Question 2 -->
                            <div class="game-square" data-question="2" style="background:#bef264; padding:20px; border-radius:15px; cursor:pointer; transition:all 0.3s; border:3px solid #84cc16;" onclick="showQuestion(2, 'Tell your partner what you were doing at 5p.m. yesterday.')">
                                <div style="background:#84cc16; color:white; width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold; margin-bottom:10px;">2</div>
                                <div style="color:#3f6212; font-weight:600; font-size:0.95rem;">Tell your partner what you were doing at 5p.m. yesterday.</div>
                            </div>

                            <!-- Question 3 -->
                            <div class="game-square" data-question="3" style="background:#fca5a5; padding:20px; border-radius:15px; cursor:pointer; transition:all 0.3s; border:3px solid #ef4444;" onclick="showQuestion(3, 'Give your partner a suggestion on how to study for an exam.')">
                                <div style="background:#ef4444; color:white; width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold; margin-bottom:10px;">3</div>
                                <div style="color:#7f1d1d; font-weight:600; font-size:0.95rem;">Give your partner a suggestion on how to study for an exam.</div>
                            </div>

                            <!-- Continue with more questions -->
                            <div class="game-square" data-question="4" style="background:#fbcfe8; padding:20px; border-radius:15px; cursor:pointer; transition:all 0.3s; border:3px solid #ec4899;" onclick="showQuestion(4, 'Write three sentences about someone you love.')">
                                <div style="background:#ec4899; color:white; width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold; margin-bottom:10px;">4</div>
                                <div style="color:#831843; font-weight:600; font-size:0.95rem;">Write three sentences about someone you love.</div>
                            </div>

                            <div class="game-square" data-question="5" style="background:#a5f3fc; padding:20px; border-radius:15px; cursor:pointer; transition:all 0.3s; border:3px solid #06b6d4;" onclick="showQuestion(5, 'Ask your partner what they were doing last night afternoon.')">
                                <div style="background:#06b6d4; color:white; width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold; margin-bottom:10px;">5</div>
                                <div style="color:#164e63; font-weight:600; font-size:0.95rem;">Ask your partner what they were doing last night afternoon.</div>
                            </div>

                            <div class="game-square" data-question="6" style="background:#fde68a; padding:20px; border-radius:15px; cursor:pointer; transition:all 0.3s; border:3px solid #f59e0b;" onclick="showQuestion(6, 'Complete the actions characters can do: W____, w____, d____')">
                                <div style="background:#f59e0b; color:white; width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold; margin-bottom:10px;">6</div>
                                <div style="color:#78350f; font-weight:600; font-size:0.95rem;">Complete the actions characters can do: W____, w____, d____</div>
                            </div>

                            <!-- Return Square -->
                            <div class="game-square" data-question="return" style="background:linear-gradient(135deg, #6366f1, #4f46e5); padding:25px; border-radius:15px; text-align:center; cursor:pointer; transition:all 0.3s; border:4px solid white; min-height:120px; display:flex; align-items:center; justify-content:center;" onclick="selectSquare(this)">
                                <div style="color:white; font-size:1.5rem; font-weight:800;">‚Ü©Ô∏è RETURN</div>
                            </div>
                        </div>

                        <!-- Question Display Modal -->
                        <div id="question-modal" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:white; padding:40px; border-radius:20px; box-shadow:0 20px 50px rgba(0,0,0,0.3); z-index:1000; max-width:500px; width:90%;">
                            <h3 id="modal-question" style="color:#3a0ca3; margin-bottom:20px; font-size:1.3rem;"></h3>
                            <button class="spin-btn" onclick="closeQuestion()">‚úÖ Got it!</button>
                        </div>
                    </div>
                </div>

                <!-- Project Section -->
                <div>
                    <h3 style="color:#3a0ca3; margin-bottom:25px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#3a0ca3; color:white; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.1rem;">2</span>
                        Project: Create a Movie Poster
                        <p style="font-size:0.9rem; color:#64748b; margin-left:10px;">(ŸÖÿ¥ÿ±Ÿàÿπ: ÿ£ŸÜÿ¥ÿ¶ ŸÖŸÑÿµŸÇ ŸÅŸäŸÑŸÖ)</p>
                    </h3>

                    <div style="background:linear-gradient(135deg, #c7d2fe, #a5b4fc); padding:40px; border-radius:20px;">
                        <div style="display:grid; grid-template-columns:1fr 2fr; gap:30px; align-items:start;">
                            <div style="background:white; padding:25px; border-radius:15px; text-align:center;">
                                <div style="font-size:5rem; margin-bottom:15px;">üé¨</div>
                                <div style="color:#4338ca; font-weight:bold; font-size:1.3rem; margin-bottom:10px;">Movie Poster</div>
                                <div style="color:#64748b; font-size:0.9rem;">Design your own!</div>
                            </div>

                            <div style="background:white; padding:30px; border-radius:15px;">
                                <h4 style="color:#4338ca; margin-bottom:20px; font-size:1.4rem;">üí° Instructions:</h4>
                                <ul style="color:#334155; line-height:2; margin-left:20px;">
                                    <li>Create a story and design the characters.</li>
                                    <li>Write about the characters, including details like their special abilities, skills, and personality.</li>
                                    <li>Find movie posters that you like from stories you like them.</li>
                                    <li>Design a poster about your story and characters.</li>
                                    <li>Draw, color, and write on your poster.</li>
                                    <li>Show your poster to your class.</li>
                                </ul>

                                <div style="background:#ede9fe; padding:20px; border-radius:12px; margin-top:25px; border-left:4px solid #8b5cf6;">
                                    <div style="color:#5b21b6; font-weight:bold; margin-bottom:10px;">‚ú® Tips for Success:</div>
                                    <div style="color:#6b21a8; font-size:0.95rem; line-height:1.7;">
                                        ‚Ä¢ Make your title BIG and eye-catching!<br>
                                        ‚Ä¢ Include colorful character illustrations<br>
                                        ‚Ä¢ Add a tagline that makes people curious<br>
                                        ‚Ä¢ Show the most exciting scene from your story
                                    </div>
                                </div>

                                <div style="text-align:center; margin-top:25px;">
                                    <button class="spin-btn" style="background:linear-gradient(135deg, #f59e0b, #d97706);">üé® Start Creating!</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- End Unit Review -->

        {% endif %}
    </div>

    <!-- Score -->
    <div class="floating-score">
        <div class="score-stars">‚≠ê</div>
        <div class="score-text" id="total-score">0</div>
        <div style="font-size:0.8rem; color:#888;">Points</div>
    </div>

    <!-- Modal -->
    <div id="result-modal" class="result-modal">
        <div class="result-content">
            <div style="font-size:4rem;">üèÜ</div>
            <h2 style="color:#3a0ca3;">Awesome!</h2>
            <p>Score: <span id="final-score" style="color:#f72585; font-weight:bold;">0</span></p>
            <button class="spin-btn" onclick="document.getElementById('result-modal').style.display='none'">Keep Playing</button>
        </div>
    </div>

    <script>
        /* --- Data and Utils --- */
        const vocabData = [
            {% for word in vocab %} { word: "{{ word.word }}", emoji: "{{ word.emoji }}" }, {% endfor %}
        ];
        
        const sentenceData = [
            {% for s in sentences %} { en: "{{ s.english_text|escapejs }}", ar: "{{ s.arabic_translation|escapejs }}" }, {% endfor %}
        ];
        
        {% if quizzes_json %}
        const quizzes = JSON.parse('{{ quizzes_json|escapejs }}');
        {% else %}
        const quizzes = [];
        {% endif %}

        function speakText(text) {
            if ('speechSynthesis' in window) {
                const u = new SpeechSynthesisUtterance(text);
                u.lang = 'en-US';
                window.speechSynthesis.speak(u);
            }
        }

        let score = 0;
        function addPoints(pts) {
            score += pts;
            document.getElementById('total-score').innerText = score;
            document.getElementById('final-score').innerText = score;
        }

        function showWinModal() {
            document.getElementById('result-modal').style.display = 'flex';
        }

        /* --- Tabs --- */
        function switchGame(gameId) {
            document.querySelectorAll('.game-panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.game-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(gameId + '-game').classList.add('active');
            
            const tabs = document.querySelectorAll('.game-tab');
            const map = { 'memory': 0, 'scramble': 1, 'listening': 2, 'picture': 3, 'gap': 4 };
            if (tabs[map[gameId]]) tabs[map[gameId]].classList.add('active');
            
            if (gameId === 'picture') initPictureMatchGame();
            if (gameId === 'memory') initMemoryGame();
            if (gameId === 'scramble') initScrambleGame();
            if (gameId === 'listening') initListeningGame();
            if (gameId === 'gap') initGapFillGame();
        }

        /* --- Memory Game --- */
        function initMemoryGame() {
            const grid = document.getElementById('memory-grid');
            if(!grid) return;
            grid.innerHTML = '';
            
            const cards = vocabData.slice(0, 8).flatMap(i => [
                { type: 'text', val: i.word, id: i.word },
                { type: 'emoji', val: i.emoji, id: i.word }
            ]).sort(() => 0.5 - Math.random());

            let hasFlipped = false, lock = false, first, second;

            cards.forEach(c => {
                const el = document.createElement('div');
                el.className = 'memory-card';
                el.dataset.id = c.id;
                el.innerHTML = `
                    <div class="front"><i class="fas fa-question"></i></div>
                    <div class="back ${c.type==='emoji'?'emoji-large':''}">${c.val}</div>
                `;
                el.onclick = function() {
                    if (lock || this === first) return;
                    this.classList.add('flip');
                    if (!hasFlipped) { hasFlipped = true; first = this; return; }
                    second = this;
                    lock = true;
                    if (first.dataset.id === second.dataset.id) {
                        first.classList.add('matched'); second.classList.add('matched');
                        addPoints(10);
                        reset();
                    } else {
                        setTimeout(() => { first.classList.remove('flip'); second.classList.remove('flip'); reset(); }, 1000);
                    }
                };
                grid.appendChild(el);
            });
            function reset() { [hasFlipped, lock] = [false, false]; [first, second] = [null, null]; }
        }

        /* --- Scramble Game (Redesigned) --- */
        let currentSentenceIdx = 0;
        let draggedItem = null;

        function initScrambleGame() {
            if (sentenceData.length === 0) return;
            loadSentence(currentSentenceIdx);
        }

        function loadSentence(idx) {
            currentSentenceIdx = idx;
            const data = sentenceData[idx];
            document.getElementById('target-translation').innerText = data.ar;
            
            const words = data.en.replace(/[.,]/g, '').trim().split(' ');
            const dropZone = document.getElementById('sentence-drop-zone');
            const bank = document.getElementById('word-bank');
            dropZone.innerHTML = ''; bank.innerHTML = '';
            document.getElementById('sentence-feedback').innerText = '';

            [...words].sort(() => 0.5 - Math.random()).forEach(w => {
                const el = document.createElement('div');
                el.className = 'draggable-word';
                el.innerText = w;
                el.draggable = true;
                el.addEventListener('dragstart', function() { draggedItem = this; });
                el.addEventListener('click', function() {
                    (this.parentElement === bank ? dropZone : bank).appendChild(this);
                });
                bank.appendChild(el);
            });

            [dropZone, bank].forEach(area => {
                area.addEventListener('dragover', e => { e.preventDefault(); area.classList.add('drag-over'); });
                area.addEventListener('dragleave', () => area.classList.remove('drag-over'));
                area.addEventListener('drop', function(e) {
                    e.preventDefault(); 
                    this.classList.remove('drag-over');
                    if (draggedItem) this.appendChild(draggedItem);
                });
            });
        }

        function checkSentence() {
            const dropZone = document.getElementById('sentence-drop-zone');
            const userText = Array.from(dropZone.children).map(c => c.innerText).join(' ');
            const target = sentenceData[currentSentenceIdx].en.replace(/[.,]/g, '').trim();
            
            if (userText === target) {
                document.getElementById('sentence-feedback').innerText = "‚úÖ Perfect!";
                addPoints(20); showWinModal();
                dropZone.style.borderColor = "#22c55e"; dropZone.style.background = "#dcfce7";
            } else {
                document.getElementById('sentence-feedback').innerText = "‚ùå Try Again";
                dropZone.style.borderColor = "#ef4444";
                setTimeout(() => dropZone.style.borderColor = "#cbd5e1", 1000);
            }
        }
        
        function nextSentence() {
            let next = currentSentenceIdx + 1;
            if (next >= sentenceData.length) next = 0;
            document.getElementById('sentence-drop-zone').style = ''; // Reset style
            loadSentence(next);
        }

        /* --- Listening Game --- */
        let currentListeningWord = null;
        function initListeningGame() {
            if (vocabData.length < 4) return;
            const target = vocabData[Math.floor(Math.random() * vocabData.length)];
            currentListeningWord = target;
            let opts = [target];
            while (opts.length < 4) {
                const r = vocabData[Math.floor(Math.random() * vocabData.length)];
                if (!opts.includes(r)) opts.push(r);
            }
            opts.sort(() => 0.5 - Math.random());
            
            const cont = document.getElementById('listening-options');
            cont.innerHTML = '';
            document.getElementById('listening-feedback').innerText = '';
            
            opts.forEach(o => {
                const btn = document.createElement('div');
                btn.className = 'listening-option';
                btn.innerHTML = `<span style="font-size:3rem;">${o.emoji}</span><span>${o.word}</span>`;
                btn.onclick = () => {
                    if (o.word === currentListeningWord.word) {
                        btn.classList.add('correct'); addPoints(10); 
                        document.getElementById('listening-feedback').innerText = "Correct!";
                        setTimeout(initListeningGame, 1500);
                    } else {
                        btn.classList.add('wrong');
                    }
                };
                cont.appendChild(btn);
            });
        }
        function playCurrentListeningWord() { if(currentListeningWord) speakText(currentListeningWord.word); }

        /* --- Picture Match --- */
        function initPictureMatchGame() {
            const cont = document.getElementById('match-container');
            cont.innerHTML = '';
            document.getElementById('match-feedback').innerText = '';
            
            const items = [...vocabData].sort(() => 0.5 - Math.random()).slice(0, 4);
            const colL = document.createElement('div'); colL.className = 'match-col';
            const colR = document.createElement('div'); colR.className = 'match-col';
            
            items.forEach(i => {
                const t = document.createElement('div');
                t.className = 'match-target';
                t.dataset.match = i.word;
                t.innerHTML = `<span class="target-emoji">${i.emoji}</span><div class="target-drop-area">Drop here</div>`;
                t.addEventListener('dragover', e => { e.preventDefault(); t.classList.add('drag-over'); });
                t.addEventListener('dragleave', () => t.classList.remove('drag-over'));
                t.addEventListener('drop', function(e) {
                    e.preventDefault(); this.classList.remove('drag-over');
                    const word = e.dataTransfer.getData('text');
                    if (word === i.word) {
                        this.style.borderColor = "#22c55e"; this.style.background = "#dcfce7";
                        this.querySelector('.target-drop-area').innerText = word;
                        document.querySelectorAll('.match-source').forEach(s => { if(s.innerText===word) s.style.visibility='hidden'; });
                        addPoints(10);
                        if (document.querySelectorAll('.match-source[style*="hidden"]').length === 4) {
                            showWinModal();
                            document.getElementById('match-feedback').innerText = "All Matched!";
                        }
                    } else {
                        this.style.borderColor = "#ef4444";
                        setTimeout(() => this.style.borderColor = "#cbd5e1", 500);
                    }
                });
                colL.appendChild(t);
            });
            
            [...items].sort(() => 0.5 - Math.random()).forEach(i => {
                const s = document.createElement('div');
                s.className = 'match-source';
                s.innerText = i.word;
                s.draggable = true;
                s.addEventListener('dragstart', e => e.dataTransfer.setData('text', i.word));
                colR.appendChild(s);
            });
            
            cont.append(colL, colR);
        }

        /* --- Gap Fill Game (NEW) --- */
        let currentGapTarget = null;
        
        function initGapFillGame() {
            if (sentenceData.length === 0) return;
            
            const sentenceObj = sentenceData[Math.floor(Math.random() * sentenceData.length)];
            const rawSentence = sentenceObj.en.replace(/[.,!]/g, '');
            const words = rawSentence.split(' ');
            
            // Pick a word > 2 chars to be the blank
            const candidates = words.filter(w => w.length > 2);
            if(candidates.length === 0) { initGapFillGame(); return; } // Retry if short words
            const targetWord = candidates[Math.floor(Math.random() * candidates.length)];
            currentGapTarget = targetWord;
            
            // Generate visual sentence with blank
            const displaySentence = words.map(w => {
                 if(w === targetWord) return `<span class="gap-slot" id="gap-slot" style="display:inline-block; min-width:100px; border-bottom:3px dashed #cbd5e1; color:transparent; transition:all 0.3s; padding:0 10px;">_______</span>`;
                 return w;
            }).join(' ');
            
            document.getElementById('gap-sentence').innerHTML = displaySentence;
            document.getElementById('gap-feedback').innerText = '';
            
            // Setup Slot
            const slot = document.getElementById('gap-slot');
            slot.addEventListener('dragover', e => { e.preventDefault(); slot.style.borderColor = '#d946ef'; });
            slot.addEventListener('dragleave', () => slot.style.borderColor = '#cbd5e1');
            slot.addEventListener('drop', function(e) {
                e.preventDefault();
                const word = e.dataTransfer.getData('text');
                checkGapAnswer(word, slot);
            });
            
            // Generate Options
            const options = [targetWord];
            // Get distractors
            const allWords = sentenceData.flatMap(s => s.en.replace(/[.,]/g,'').split(' ')).filter(w => w.length > 3 && w !== targetWord);
            while(options.length < 3 && allWords.length > 0) {
                 const r = allWords[Math.floor(Math.random() * allWords.length)];
                 if(!options.includes(r)) options.push(r);
            }
            options.sort(() => 0.5 - Math.random());
            
            const optContainer = document.getElementById('gap-options');
            optContainer.innerHTML = '';
            options.forEach(w => {
                const btn = document.createElement('div');
                btn.className = 'draggable-word'; // Reuse styling
                btn.innerText = w;
                btn.draggable = true;
                btn.addEventListener('dragstart', e => e.dataTransfer.setData('text', w));
                btn.onclick = () => checkGapAnswer(w, slot); // Click to fill
                optContainer.appendChild(btn);
            });
        }
        
        function checkGapAnswer(word, slot) {
            if (word === currentGapTarget) {
                slot.innerText = word;
                slot.style.color = '#22c55e';
                slot.style.borderBottom = '3px solid #22c55e';
                document.getElementById('gap-feedback').innerText = "‚úÖ Correct! Well done.";
                addPoints(15);
                showWinModal();
                // Disable options
                document.getElementById('gap-options').innerHTML = ''; 
            } else {
                document.getElementById('gap-feedback').innerText = "‚ùå Oops! Try again.";
                slot.style.borderBottomColor = '#ef4444';
                setTimeout(() => slot.style.borderBottomColor = '#cbd5e1', 1000);
            }
        }

        /* --- Wheel --- */
        function spinWheel() {
            const wheel = document.getElementById('spin-wheel');
            wheel.style.transform = `rotate(${Math.floor(720 + Math.random() * 720)}deg)`;
            setTimeout(() => {
                const g = vocabData[Math.floor(Math.random()*vocabData.length)].word;
                document.getElementById('wheel-result').innerText = `You got: ${g}`;
                speakText(g);
            }, 3000);
        }

        /* --- Quiz --- */
        function renderQuizzes() {
            const c = document.getElementById('quiz-container');
            if (!c || quizzes.length === 0) return;
            c.innerHTML = quizzes.map((q, i) => `
                <div class="quiz-question-card">
                    <div class="question-text">${k=i+1}. ${q.question}</div>
                    <div class="options-grid">
                        ${q.options.map(opt => `<button class="option-btn" onclick="checkQuiz(this, '${opt}', '${q.correct}')">${opt}</button>`).join('')}
                    </div>
                </div>
            `).join('');
        }
        function checkQuiz(btn, sel, cor) {
            if (sel === cor) {
                btn.classList.add('correct'); addPoints(5);
            } else {
                btn.classList.add('wrong');
                Array.from(btn.parentElement.children).forEach(b => {
                    if (b.innerText === cor) b.classList.add('correct');
                });
            }
            Array.from(btn.parentElement.children).forEach(b => b.disabled = true);
        }

        document.addEventListener('DOMContentLoaded', () => {
            initMemoryGame();
            if(quizzes) renderQuizzes();
        });
        /* --- Lesson Logic --- */
        function switchLesson(num) {
            // Updating Tabs
            document.querySelectorAll('.lesson-btn').forEach((b, i) => {
                if(i === num-1) b.classList.add('active');
                else b.classList.remove('active');
            });
            // Updating Content
            document.querySelectorAll('.lesson-section').forEach(s => s.style.display = 'none');
            document.getElementById('lesson-' + num).style.display = 'block';
            
            if(num === 2) {
                initWasWereGame();
                initGrammarScramble();
                initRuleMatch();
            }
        }

        /* --- Grammar Game 1: Was/Were --- */
        const wwQuestions = [
            { q: "She ______ reading a book.", a: "was" },
            { q: "They ______ playing football.", a: "were" },
            { q: "I ______ sleeping.", a: "was" },
            { q: "We ______ not eating.", a: "were" },
            { q: "The cat ______ jumping.", a: "was" },
            { q: "You ______ watching TV.", a: "were" }
        ];
        let currentWW = null;

        function initWasWereGame() {
            currentWW = wwQuestions[Math.floor(Math.random() * wwQuestions.length)];
            document.getElementById('ww-question').innerText = currentWW.q;
            document.getElementById('ww-feedback').innerText = '';
        }

        function checkWasWere(ans) {
            const fb = document.getElementById('ww-feedback');
            if(ans === currentWW.a) {
                fb.innerText = "‚úÖ Correct!";
                fb.style.color = "#22c55e";
                addPoints(10);
                setTimeout(initWasWereGame, 1000);
            } else {
                fb.innerText = "‚ùå Try again!";
                fb.style.color = "#ef4444";
            }
        }

        /* --- Grammar Game 2: Scramble --- */
        const grammarSentences = [
            { text: "I was reading", words: ["I", "was", "reading"] },
            { text: "They were playing", words: ["They", "were", "playing"] },
            { text: "She was not sleeping", words: ["She", "was", "not", "sleeping"] },
            { text: "Were you eating?", words: ["Were", "you", "eating?"] }
        ];
        let currentGrammarSent = null;

        function initGrammarScramble() {
            currentGrammarSent = grammarSentences[Math.floor(Math.random() * grammarSentences.length)];
            const bank = document.getElementById('grammar-bank');
            const drop = document.getElementById('grammar-drop-zone');
            bank.innerHTML = ''; drop.innerHTML = '';
            document.getElementById('grammar-feedback').innerText = '';

            [...currentGrammarSent.words].sort(()=>0.5-Math.random()).forEach(w => {
                 const btn = document.createElement('div');
                 btn.className = 'draggable-word';
                 btn.innerText = w;
                 btn.onclick = () => {
                     (btn.parentElement === bank ? drop : bank).appendChild(btn);
                 };
                 bank.appendChild(btn);
            });
        }
        
        function checkGrammarOrder() {
            const drop = document.getElementById('grammar-drop-zone');
            const user = Array.from(drop.children).map(c=>c.innerText).join(' ');
            const fb = document.getElementById('grammar-feedback');
            
            // Allow minor punctuation diffs
            if(user.replace(/[?.]/g,'') === currentGrammarSent.text.replace(/[?.]/g,'')) {
                fb.innerText = "‚úÖ Correct Structure!";
                fb.style.color = "#22c55e";
                addPoints(20);
                showWinModal();
            } else {
                fb.innerText = "‚ùå Incorrect Order.";
                fb.style.color = "#ef4444";
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
             // ... existing inits
             // Default to lesson 1
        });
        /* --- Activity 3: Concept Check --- */
        function checkConcept(btn, status) {
            // Reset siblings
            const siblings = btn.parentElement.querySelectorAll('.toggle-opt');
            siblings.forEach(b => { 
                b.classList.remove('selected', 'correct', 'wrong');
            });
            
            btn.classList.add('selected');
            if(status === 'correct') {
                btn.classList.add('correct');
                addPoints(5);
            } else {
                btn.classList.add('wrong');
            }
        }

        /* --- Activity 4: MCQ --- */
        function checkMCQ(btn, isCorrect) {
            const siblings = btn.parentElement.querySelectorAll('.mcq-btn');
            siblings.forEach(b => b.disabled = true);
            
            if(isCorrect) {
                btn.classList.add('correct');
                addPoints(5);
            } else {
                btn.classList.add('wrong');
            }
        }

        /* --- Activity 5: Rule Match --- */
        function initRuleMatch() {
            const cont = document.getElementById('rule-match-container');
            if(!cont) return;
            cont.innerHTML = '';
            document.getElementById('rule-feedback').innerText = '';
            
            const pairs = [
                { src: "I, He, She, It", tgt: "WAS" },
                { src: "You, We, They", tgt: "WERE" },
                { src: "Action Ending", tgt: "-ING" },
                { src: "For Questions", tgt: "Swap Order" }
            ];
            
            const colL = document.createElement('div'); colL.className = 'match-col';
            const colR = document.createElement('div'); colR.className = 'match-col';
            
            pairs.forEach(p => {
                // Target (Orange Box)
                const t = document.createElement('div');
                t.className = 'match-target';
                t.innerHTML = `<span style="font-size:1.2rem; font-weight:bold; color:#d946ef;">${p.tgt}</span><div class="target-drop-area">Drop here</div>`;
                t.dataset.match = p.src;
                
                t.addEventListener('dragover', e => { e.preventDefault(); t.classList.add('drag-over'); });
                t.addEventListener('dragleave', () => t.classList.remove('drag-over'));
                t.addEventListener('drop', function(e) {
                    e.preventDefault();
                    const val = e.dataTransfer.getData('text');
                    this.classList.remove('drag-over');
                    
                    if(val === p.src) {
                        this.style.background = "#dcfce7"; this.style.borderColor = "#22c55e";
                        this.querySelector('.target-drop-area').innerText = val;
                        // Hide source
                        const sources = document.querySelectorAll('.match-source');
                        sources.forEach(s => { if(s.innerText === val) s.style.visibility = 'hidden'; });
                        addPoints(10);
                        
                        if(document.querySelectorAll('.match-source[style*="hidden"]').length === 4) {
                            showWinModal();
                            document.getElementById('rule-feedback').innerText = "Correct! You mastered the rules!";
                        }
                    } else {
                         this.style.background = "#fee2e2";
                         setTimeout(()=>this.style.background="#f8fafc", 500);
                    }
                });
                colL.appendChild(t);
            });
            
            // Sources
            [...pairs].sort(()=>0.5-Math.random()).forEach(p => {
                const s = document.createElement('div');
                s.className = 'match-source';
                s.innerText = p.src;
                s.draggable = true;
                s.style.background = "#3b82f6"; s.style.color = "white"; s.style.border = "none";
                s.addEventListener('dragstart', e => e.dataTransfer.setData('text', p.src));
                colR.appendChild(s);
            });
            
            cont.append(colL, colR);
        }

        /* --- Lesson 7: Reading Quiz Functions --- */
        function checkReadingQuiz() {
            const selects = document.querySelectorAll('.reading-select');
            const inputs = document.querySelectorAll('.reading-input');
            let correct = 0;
            let total = selects.length + inputs.length;

            // Check selects
            selects.forEach(select => {
                const answer = select.getAttribute('data-answer');
                if (select.value === answer) {
                    select.style.borderColor = '#22c55e';
                    select.style.background = '#dcfce7';
                    correct++;
                } else {
                    select.style.borderColor = '#ef4444';
                    select.style.background = '#fee2e2';
                }
            });

            // Check inputs
            inputs.forEach(input => {
                const answers = input.getAttribute('data-answer').split('|');
                const value = input.value.trim().toLowerCase();
                let isCorrect = false;
                
                for (let ans of answers) {
                    if (value.includes(ans.toLowerCase())) {
                        isCorrect = true;
                        break;
                    }
                }
                
                if (isCorrect) {
                    input.style.borderColor = '#22c55e';
                    input.style.background = '#dcfce7';
                    correct++;
                } else {
                    input.style.borderColor = '#ef4444';
                    input.style.background = '#fee2e2';
                }
            });

            const feedback = document.getElementById('reading-feedback');
            const percentage = Math.round((correct / total) * 100);
            
            if (percentage === 100) {
                feedback.innerHTML = 'üéâ ŸÖŸÖÿ™ÿßÿ≤! ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿßÿ™ ÿµÿ≠Ÿäÿ≠ÿ©! Excellent! All answers correct!';
                feedback.style.color = '#059669';
                updateScore(20);
            } else if (percentage >= 70) {
                feedback.innerHTML = `‚úÖ ÿ¨ŸäÿØ ÿ¨ÿØÿßŸã! ${correct}/${total} correct (${percentage}%)`;
                feedback.style.color = '#0891b2';
                updateScore(15);
            } else {
                feedback.innerHTML = `‚ö†Ô∏è ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ! Try again! ${correct}/${total} correct (${percentage}%)`;
                feedback.style.color = '#dc2626';
            }
        }

        /* --- Lesson 8: Blog Editor Function --- */
        function insertText(text) {
            const editor = document.getElementById('blog-editor');
            const cursorPos = editor.selectionStart;
            const textBefore = editor.value.substring(0, cursorPos);
            const textAfter = editor.value.substring(cursorPos);
            
            editor.value = textBefore + text + ' ' + textAfter;
            editor.focus();
            editor.selectionStart = editor.selectionEnd = cursorPos + text.length + 1;
        }

        /* --- Lesson 9: Story Planning Functions --- */
        function saveStoryPlan() {
            const inputs = document.querySelectorAll('#story-planner input, #story-planner textarea');
            let filled = 0;
            
            inputs.forEach(input => {
                if (input.value.trim() !== '') {
                    filled++;
                }
            });

            if (filled === 0) {
                alert('‚ö†Ô∏è ŸÖŸÜ ŸÅÿ∂ŸÑŸÉ ÿßŸÖŸÑÿ£ ÿÆÿ∑ÿ© ŸÇÿµÿ™ŸÉ ÿ£ŸàŸÑÿßŸã!\nPlease fill in your story plan first!');
                return;
            }

            alert('‚úÖ ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿÆÿ∑ÿ© ŸÇÿµÿ™ŸÉ ÿ®ŸÜÿ¨ÿßÿ≠!\nYour story plan has been saved successfully!\n\n' + 
                  `ÿ™ŸÖ ŸÖŸÑÿ° ${filled} ÿ≠ŸÇŸÑ ŸÖŸÜ ${inputs.length}.\nFilled ${filled} fields out of ${inputs.length}.`);
            updateScore(10);
        }

        function presentStory() {
            const storyName = document.querySelector('#story-planner input[placeholder*="title"]');
            
            if (!storyName || storyName.value.trim() === '') {
                alert('‚ö†Ô∏è ŸÖŸÜ ŸÅÿ∂ŸÑŸÉ ÿ£ÿπÿ∑Ÿê ŸÇÿµÿ™ŸÉ ÿπŸÜŸàÿßŸÜÿßŸã ÿ£ŸàŸÑÿßŸã!\nPlease give your story a title first!');
                return;
            }

            const acts = document.querySelectorAll('#story-planner textarea');
            let storyText = `üìñ ŸÇÿµÿ©: ${storyName.value}\n\n`;
            
            acts.forEach((act, index) => {
                if (act.value.trim() !== '') {
                    const actNames = ['üé¨ Act I (Beginning)', '‚ö° Act II (Climax)', 'üéâ Act III (Resolution)'];
                    storyText += `${actNames[index]}:\n${act.value}\n\n`;
                }
            });

            speakText(storyText);
            alert('üé¨ ÿ™ŸÖ ÿπÿ±ÿ∂ ŸÇÿµÿ™ŸÉ! Your story is being presented!\n\nÿßÿ≥ÿ™ŸÖÿπ ŸÑŸÑŸÇÿµÿ©...\nListening to your story...');
            updateScore(15);
        }

        /* --- Unit Review: Board Game Functions --- */
        function showQuestion(num, question) {
            const modal = document.getElementById('question-modal');
            const modalQuestion = document.getElementById('modal-question');
            
            modalQuestion.innerHTML = `<div style="text-align:center; margin-bottom:15px; font-size:2rem;">‚ùì</div>` +
                                     `<strong>Question ${num}:</strong><br>${question}` +
                                     `<div style="margin-top:15px; padding:15px; background:#f0f9ff; border-radius:10px; color:#0369a1; font-size:0.95rem;">` +
                                     `üí° ÿßÿ¨ÿ® ÿπŸÑŸâ ÿßŸÑÿ≥ÿ§ÿßŸÑ ÿ¥ŸÅŸáŸäÿßŸã<br>Answer the question orally</div>`;
            
            modal.style.display = 'block';
            updateScore(5);
        }

        function closeQuestion() {
            document.getElementById('question-modal').style.display = 'none';
        }

        function selectSquare(square) {
            const question = square.getAttribute('data-question');
            
            if (question === 'start') {
                alert('üèÅ ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ®ŸÉ ŸÅŸä ŸÑÿπÿ®ÿ© ÿßŸÑŸÖÿ±ÿßÿ¨ÿπÿ©!\nWelcome to the Review Game!\n\nÿßŸÜŸÇÿ± ÿπŸÑŸâ ÿ£Ÿä ŸÖÿ±ÿ®ÿπ ŸÑŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿπŸÑŸâ ÿßŸÑÿ≥ÿ§ÿßŸÑ.\nClick any square to answer the question.');
            } else if (question === 'return') {
                alert('‚Ü©Ô∏è ÿπŸàÿØÿ© ÿ•ŸÑŸâ ÿßŸÑÿ®ÿØÿßŸäÿ©!\nReturn to Start!\n\nÿ£ÿ≠ÿ≥ŸÜÿ™! ŸÑŸÇÿØ ÿ£ŸÉŸÖŸÑÿ™ ÿßŸÑŸÑÿπÿ®ÿ©.\nWell done! You completed the game.');
                updateScore(10);
            }
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('question-modal');
            if (event.target === modal) {
                closeQuestion();
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
             initMemoryGame();
             if(quizzes) renderQuizzes();
             // Pre-load specific lesson if needed or allow default
             initRuleMatch(); 
        });
    </script>
</body>
</html>
